USE [NEOE]
GO
/****** Object:  StoredProcedure [NEOE].[UP_HR_PMPRPT_SELECT3]    Script Date: 2025-12-02 오전 11:24:00 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =========================================== 
-- SYSTEM            : 인사관리 
-- SUB SYSTEM        : 급여보고서 
-- PAGE                : 월별급여지급현황 
-- DESC                : 월별급여지급현황 조회(집계형태 : 조회조건에 해당하는 내용) 
-- 
-- RETURN VALUES 
-- 
-- 작    성    자     : 장은경 
-- 작    성    일    : 2004.09.04 
-- 
-- 수    정    자    : 장은경 
-- 수  정  내  용    : ANSI-SQL 변환 
-- =========================================== 
-- CHANGE HISTORY 
-- =========================================== 
-- 2012-04-03 : 집계형태 항목에 사용자정의1,2,3 추가(D20120319006)
-- 2012-05-29 : 체크펜기능추가(D20120523080)
-- 2012-07-02 : 지급공제총액이 0인 사원제외 추가 (D20120629013)
-- 2012.11.28 : D20121025064 : 주소추가
-- 2013.07.23 : D20130612074 : 지방세신고지 추가
-- 2014.07.07 : D20140704065 : 집계형태가 '직무(사원) 일때 부서명 컬럼 추가
-- 2014.12.11 : D20141128078 : 급여양식의 지급, 공제항목을 40개에서 80개까지 가능하도록 수정.
-- 2015.01.20 : D20150106016 : 집계형태에 '직책(사원)' 추가.
-- 2015.06.02 : 파라메터 @P_MULTI_EMP 형식변경  NVARCHAR(4000) -> NTEXT
-- 2016.09.20 : D20160908066 : 사원별 집계인 경우 직군 추가.
-- =========================================== 
ALTER PROCEDURE [NEOE].[UP_HR_PMPRPT_SELECT3] 
( 
    @P_CD_COMPANY       NVARCHAR(4000),      
    @P_MULTI_BIZAREA    NVARCHAR(4000), 
    @P_MULTI_DEPT       NTEXT, 
    @P_CD_EMP           NVARCHAR(3),     
    @P_MULTI_TP_EMP     NVARCHAR(4000),     
    @P_YM               NVARCHAR(6),     
    @P_TP_SUM           NVARCHAR(3),     
    @P_TP_PAY           NVARCHAR(3),     
    @P_CD_INCOM         NVARCHAR(3), 
    @P_TP_REPORT        NVARCHAR(3), 
    @P_DT_PAY           NVARCHAR(8), 
    @P_MULTI_EMP        NTEXT,
	@P_CD_COMPANY_L		NVARCHAR(7),
    @P_NO_SEQ			INT  = 0,
    @P_LB_DEPT			INT  = 0, 				--부서레벨
	@P_AM_TOTPAY		NVARCHAR(1) = 'N',		--지급총액 0인 사원제외
	@P_MULTI_LTAX_AREA	NVARCHAR(4000) = NULL,
	@P_FG_LANG			NVARCHAR(4) = NULL
) 

AS 
-- MultiLang Call
EXEC UP_MA_LOCAL_LANGUAGE @P_FG_LANG
 
SET NOCOUNT ON 
 
IF(@P_DT_PAY = '00000000') 
BEGIN 
    SET @P_DT_PAY = '' 
END 

DECLARE @V_YN_CHK		CHAR(1),
		@V_HDEPT_CUR	CURSOR,
		@V_DEPT_CUR		CURSOR,
		@V_UPDATE_CUR	CURSOR,
		@V_HDEPT_CODE	NVARCHAR(12),
		@V_DEPT_CODE	NVARCHAR(12),
		@V_DEPT_CHG		NVARCHAR(4000),
		
		@V_CD_COMPANY_U	NVARCHAR(7),
		@V_CD_BZIAREA_U	NVARCHAR(7),
		@V_CD_DEPT_U	NVARCHAR(12),
		@V_H_DEPT_U		NVARCHAR(4000),
		
		@V_COUNT		INT

SET		@V_YN_CHK = 'N'

--부서레벨별 집계를 위한 임시테이블 생성
DECLARE @P_DEPT_TEMP TABLE 
( 
	회사코드    NVARCHAR(7), 
	사업장코드  NVARCHAR(7), 
	부서코드    NVARCHAR(12), 
	하위부서    NVARCHAR(4000),
	PRIMARY KEY(부서코드)
)	

DECLARE @P_DTEMP TABLE 
( 
    회사코드		NVARCHAR(7),
    사업장코드		NVARCHAR(7), 
    부서코드		NVARCHAR(12), 
    CC              NVARCHAR(12), 
    직위코드    	NVARCHAR(3), 
    직군코드    	NVARCHAR(3), 
    직급코드    	NVARCHAR(3), 
    직책코드    	NVARCHAR(3), 
    호봉코드    	NVARCHAR(6), 
    프로젝트코드    NVARCHAR(20),		--집계형태 추가
    사번        	NVARCHAR(10), 
    고용형태    	NVARCHAR(3), 
    사원구분    	NVARCHAR(3), 
    급여구분    	NVARCHAR(3),     
    퇴사일자    	NVARCHAR(8), 
    급여시작일		NVARCHAR(8), 
    급여종료일		NVARCHAR(8), 
    사용자정의1		NVARCHAR(3),	
    사용자정의2		NVARCHAR(3),
    사용자정의3		NVARCHAR(3),
    AM_PAY01    NUMERIC(17,4),  
    AM_PAY02    NUMERIC(17,4), 
    AM_PAY03    NUMERIC(17,4), 
    AM_PAY04    NUMERIC(17,4), 
    AM_PAY05    NUMERIC(17,4), 
    AM_PAY06    NUMERIC(17,4), 
    AM_PAY07    NUMERIC(17,4), 
    AM_PAY08    NUMERIC(17,4), 
    AM_PAY09    NUMERIC(17,4), 
    AM_PAY10    NUMERIC(17,4), 
    AM_PAY11    NUMERIC(17,4), 
    AM_PAY12    NUMERIC(17,4), 
    AM_PAY13    NUMERIC(17,4), 
    AM_PAY14    NUMERIC(17,4), 
    AM_PAY15    NUMERIC(17,4), 
    AM_PAY16    NUMERIC(17,4), 
    AM_PAY17    NUMERIC(17,4), 
    AM_PAY18    NUMERIC(17,4), 
    AM_PAY19    NUMERIC(17,4), 
    AM_PAY20    NUMERIC(17,4), 
    AM_PAY21    NUMERIC(17,4), 
    AM_PAY22    NUMERIC(17,4), 
    AM_PAY23    NUMERIC(17,4), 
    AM_PAY24    NUMERIC(17,4), 
    AM_PAY25    NUMERIC(17,4), 
    AM_PAY26    NUMERIC(17,4), 
    AM_PAY27    NUMERIC(17,4), 
    AM_PAY28    NUMERIC(17,4), 
    AM_PAY29    NUMERIC(17,4), 
    AM_PAY30    NUMERIC(17,4), 
    AM_PAY31    NUMERIC(17,4), 
    AM_PAY32    NUMERIC(17,4), 
    AM_PAY33    NUMERIC(17,4), 
    AM_PAY34    NUMERIC(17,4), 
    AM_PAY35    NUMERIC(17,4), 
    AM_PAY36    NUMERIC(17,4), 
    AM_PAY37    NUMERIC(17,4), 
    AM_PAY38    NUMERIC(17,4), 
    AM_PAY39    NUMERIC(17,4), 
    AM_PAY40    NUMERIC(17,4), 
    AM_DEDUCT01    NUMERIC(17,4), 
    AM_DEDUCT02    NUMERIC(17,4), 
    AM_DEDUCT03    NUMERIC(17,4), 
    AM_DEDUCT04    NUMERIC(17,4), 
    AM_DEDUCT05    NUMERIC(17,4), 
    AM_DEDUCT06    NUMERIC(17,4), 
    AM_DEDUCT07    NUMERIC(17,4), 
    AM_DEDUCT08    NUMERIC(17,4), 
    AM_DEDUCT09    NUMERIC(17,4), 
    AM_DEDUCT10    NUMERIC(17,4), 
    AM_DEDUCT11    NUMERIC(17,4), 
    AM_DEDUCT12    NUMERIC(17,4), 
    AM_DEDUCT13    NUMERIC(17,4), 
    AM_DEDUCT14    NUMERIC(17,4), 
    AM_DEDUCT15    NUMERIC(17,4), 
    AM_DEDUCT16    NUMERIC(17,4), 
    AM_DEDUCT17    NUMERIC(17,4), 
    AM_DEDUCT18    NUMERIC(17,4), 
    AM_DEDUCT19    NUMERIC(17,4), 
    AM_DEDUCT20    NUMERIC(17,4), 
    AM_DEDUCT21    NUMERIC(17,4), 
    AM_DEDUCT22    NUMERIC(17,4), 
    AM_DEDUCT23    NUMERIC(17,4), 
    AM_DEDUCT24    NUMERIC(17,4), 
    AM_DEDUCT25    NUMERIC(17,4), 
    AM_DEDUCT26    NUMERIC(17,4), 
    AM_DEDUCT27    NUMERIC(17,4), 
    AM_DEDUCT28    NUMERIC(17,4), 
    AM_DEDUCT29    NUMERIC(17,4), 
    AM_DEDUCT30    NUMERIC(17,4), 
    AM_DEDUCT31    NUMERIC(17,4), 
    AM_DEDUCT32    NUMERIC(17,4), 
    AM_DEDUCT33    NUMERIC(17,4), 
    AM_DEDUCT34    NUMERIC(17,4), 
    AM_DEDUCT35    NUMERIC(17,4), 
    AM_DEDUCT36    NUMERIC(17,4), 
    AM_DEDUCT37    NUMERIC(17,4), 
    AM_DEDUCT38    NUMERIC(17,4), 
    AM_DEDUCT39    NUMERIC(17,4), 
    AM_DEDUCT40    NUMERIC(17,4), 
    PAY_01        NUMERIC(17,4),  
    PAY_02        NUMERIC(17,4), 
    PAY_03        NUMERIC(17,4), 
    PAY_04        NUMERIC(17,4), 
    PAY_05        NUMERIC(17,4), 
    PAY_06        NUMERIC(17,4), 
    PAY_07        NUMERIC(17,4), 
    PAY_08        NUMERIC(17,4), 
    PAY_09        NUMERIC(17,4), 
    PAY_10        NUMERIC(17,4), 
    PAY_11        NUMERIC(17,4), 
    PAY_12        NUMERIC(17,4), 
    PAY_13        NUMERIC(17,4), 
    PAY_14        NUMERIC(17,4), 
    PAY_15        NUMERIC(17,4), 
    PAY_16        NUMERIC(17,4), 
    PAY_17        NUMERIC(17,4), 
    PAY_18        NUMERIC(17,4), 
    PAY_19        NUMERIC(17,4), 
    PAY_20        NUMERIC(17,4), 
    PAY_21        NUMERIC(17,4), 
    PAY_22        NUMERIC(17,4), 
    PAY_23        NUMERIC(17,4), 
    PAY_24        NUMERIC(17,4), 
    PAY_25        NUMERIC(17,4), 
    PAY_26        NUMERIC(17,4), 
    PAY_27        NUMERIC(17,4), 
    PAY_28        NUMERIC(17,4), 
    PAY_29        NUMERIC(17,4), 
    PAY_30        NUMERIC(17,4), 
    PAY_31        NUMERIC(17,4), 
    PAY_32        NUMERIC(17,4), 
    PAY_33        NUMERIC(17,4), 
    PAY_34        NUMERIC(17,4), 
    PAY_35        NUMERIC(17,4), 
    PAY_36        NUMERIC(17,4), 
    PAY_37        NUMERIC(17,4), 
    PAY_38        NUMERIC(17,4), 
    PAY_39        NUMERIC(17,4), 
    PAY_40        NUMERIC(17,4), 
    PAY_41        NUMERIC(17,4), 
    PAY_42        NUMERIC(17,4), 
    PAY_43        NUMERIC(17,4), 
    PAY_44        NUMERIC(17,4), 
    PAY_45        NUMERIC(17,4), 
    PAY_46        NUMERIC(17,4), 
    PAY_47        NUMERIC(17,4), 
    PAY_48        NUMERIC(17,4), 
    PAY_49        NUMERIC(17,4), 
    PAY_50        NUMERIC(17,4),
    PAY_51        NUMERIC(17,4), 
    PAY_52        NUMERIC(17,4), 
    PAY_53        NUMERIC(17,4), 
    PAY_54        NUMERIC(17,4), 
    PAY_55        NUMERIC(17,4), 
    PAY_56        NUMERIC(17,4), 
    PAY_57        NUMERIC(17,4), 
    PAY_58        NUMERIC(17,4), 
    PAY_59        NUMERIC(17,4), 
    PAY_60        NUMERIC(17,4),
    PAY_61        NUMERIC(17,4), 
    PAY_62        NUMERIC(17,4), 
    PAY_63        NUMERIC(17,4), 
    PAY_64        NUMERIC(17,4), 
    PAY_65        NUMERIC(17,4), 
    PAY_66        NUMERIC(17,4), 
    PAY_67        NUMERIC(17,4), 
    PAY_68        NUMERIC(17,4), 
    PAY_69        NUMERIC(17,4), 
    PAY_70        NUMERIC(17,4),
    PAY_71        NUMERIC(17,4), 
    PAY_72        NUMERIC(17,4), 
    PAY_73        NUMERIC(17,4), 
    PAY_74        NUMERIC(17,4), 
    PAY_75        NUMERIC(17,4), 
    PAY_76        NUMERIC(17,4), 
    PAY_77        NUMERIC(17,4), 
    PAY_78        NUMERIC(17,4), 
    PAY_79        NUMERIC(17,4), 
    PAY_80        NUMERIC(17,4),        
    DEDU_01        NUMERIC(17,4), 
    DEDU_02        NUMERIC(17,4), 
    DEDU_03        NUMERIC(17,4), 
    DEDU_04        NUMERIC(17,4), 
    DEDU_05        NUMERIC(17,4), 
    DEDU_06        NUMERIC(17,4), 
    DEDU_07        NUMERIC(17,4), 
    DEDU_08        NUMERIC(17,4), 
    DEDU_09        NUMERIC(17,4), 
    DEDU_10        NUMERIC(17,4), 
    DEDU_11        NUMERIC(17,4), 
    DEDU_12        NUMERIC(17,4), 
    DEDU_13        NUMERIC(17,4), 
    DEDU_14        NUMERIC(17,4), 
    DEDU_15        NUMERIC(17,4), 
    DEDU_16        NUMERIC(17,4), 
    DEDU_17        NUMERIC(17,4), 
    DEDU_18        NUMERIC(17,4), 
    DEDU_19        NUMERIC(17,4), 
    DEDU_20        NUMERIC(17,4), 
    DEDU_21        NUMERIC(17,4), 
    DEDU_22        NUMERIC(17,4), 
    DEDU_23        NUMERIC(17,4), 
    DEDU_24        NUMERIC(17,4), 
    DEDU_25        NUMERIC(17,4), 
    DEDU_26        NUMERIC(17,4), 
    DEDU_27        NUMERIC(17,4), 
    DEDU_28        NUMERIC(17,4), 
    DEDU_29        NUMERIC(17,4), 
    DEDU_30        NUMERIC(17,4), 
    DEDU_31        NUMERIC(17,4), 
    DEDU_32        NUMERIC(17,4), 
    DEDU_33        NUMERIC(17,4), 
    DEDU_34        NUMERIC(17,4), 
    DEDU_35        NUMERIC(17,4), 
    DEDU_36        NUMERIC(17,4), 
    DEDU_37        NUMERIC(17,4), 
    DEDU_38        NUMERIC(17,4), 
    DEDU_39        NUMERIC(17,4), 
    DEDU_40        NUMERIC(17,4), 
	DEDU_41        NUMERIC(17,4), 
    DEDU_42        NUMERIC(17,4), 
    DEDU_43        NUMERIC(17,4), 
    DEDU_44        NUMERIC(17,4), 
    DEDU_45        NUMERIC(17,4), 
    DEDU_46        NUMERIC(17,4), 
    DEDU_47        NUMERIC(17,4), 
    DEDU_48        NUMERIC(17,4), 
    DEDU_49        NUMERIC(17,4), 
    DEDU_50        NUMERIC(17,4),
    DEDU_51        NUMERIC(17,4), 
    DEDU_52        NUMERIC(17,4), 
    DEDU_53        NUMERIC(17,4), 
    DEDU_54        NUMERIC(17,4), 
    DEDU_55        NUMERIC(17,4), 
    DEDU_56        NUMERIC(17,4), 
    DEDU_57        NUMERIC(17,4), 
    DEDU_58        NUMERIC(17,4), 
    DEDU_59        NUMERIC(17,4), 
    DEDU_60        NUMERIC(17,4),
    DEDU_61        NUMERIC(17,4), 
    DEDU_62        NUMERIC(17,4), 
    DEDU_63        NUMERIC(17,4), 
    DEDU_64        NUMERIC(17,4), 
    DEDU_65        NUMERIC(17,4), 
    DEDU_66        NUMERIC(17,4), 
    DEDU_67        NUMERIC(17,4), 
    DEDU_68        NUMERIC(17,4), 
    DEDU_69        NUMERIC(17,4), 
    DEDU_70        NUMERIC(17,4),
    DEDU_71        NUMERIC(17,4), 
    DEDU_72        NUMERIC(17,4), 
    DEDU_73        NUMERIC(17,4), 
    DEDU_74        NUMERIC(17,4), 
    DEDU_75        NUMERIC(17,4), 
    DEDU_76        NUMERIC(17,4), 
    DEDU_77        NUMERIC(17,4), 
    DEDU_78        NUMERIC(17,4), 
    DEDU_79        NUMERIC(17,4), 
    DEDU_80        NUMERIC(17,4),        
    AM_TEMP			NUMERIC(17, 4), 
    AM_INCOMTAX		NUMERIC(17,4), 
    AM_RESIDTAX		NUMERIC(17,4), 
    AM_TOTTAX		NUMERIC(17,4), 
    AM_TOTNOTAX		NUMERIC(17,4), 
    AM_NOTAX0		NUMERIC(17,4), 
    AM_NOTAX1		NUMERIC(17,4), 
    AM_NOTAX2		NUMERIC(17,4), 
    AM_NOTAX3		NUMERIC(17,4),		-- 국민 + 건강 
    AM_NOTAX4		NUMERIC(17,4),		-- 고용 
    AM_NANNU		NUMERIC(17,4),		-- 국민연금(사용자)
    AM_NINS			NUMERIC(17,4),		-- 건강보험(사용자)
    AM_NEMPE		NUMERIC(17,4),		-- 고용보험(사용자)
    AM_NOINS		NUMERIC(17,4),		-- 요양보험(사용자),
    AM_SIN			NUMERIC(17,4),		-- 신세계 전용 양식 컬럼 총계에서 제하기 위해 추가
    IN_PAY			NVARCHAR(2), 
    DT_PAY			NVARCHAR(10),
    CD_JOB_SERIES	NVARCHAR(3),
    CD_LTAX_AREA	NVARCHAR(7),
    
    AM_ANNU			NUMERIC(17,4),		--TMFK 전용
    AM_INS			NUMERIC(17,4),		--TMFK 전용
    AM_INS1			NUMERIC(17,4),		--TMFK 전용
    AM_OINS			NUMERIC(17,4),		--TMFK 전용
    AM_OINS1		NUMERIC(17,4),		--TMFK 전용
    AM_EMPE			NUMERIC(17,4),		--TMFK 전용
    AM_EMPE1		NUMERIC(17,4),		--TMFK 전용
    AM_FIRE			NUMERIC(17,4),		--TMFK 전용
    AM_FIRE1		NUMERIC(17,4),		--TMFK 전용
    
    AM_PAY01_ER		NUMERIC(17,4),		--TMFK 전용
    AM_PAY02_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY03_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY04_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY05_ER		NUMERIC(17,4), 		--TMFK 전용
    AM_PAY06_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY07_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY08_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY09_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY10_ER		NUMERIC(17,4), 		--TMFK 전용
    AM_PAY11_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY12_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY13_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY14_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY15_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY16_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY17_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY18_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY19_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY20_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY21_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY22_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY23_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY24_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY25_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY26_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY27_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY28_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY29_ER		NUMERIC(17,4),		--TMFK 전용 
    AM_PAY30_ER		NUMERIC(17,4),		--TMFK 전용
    AM_NEMPA		NUMERIC(17,4),		--삼성웰스토리 전용
    PRIMARY KEY(회사코드, 사업장코드, 부서코드, CC, 직위코드, 직군코드, 직급코드, 직책코드, 호봉코드, 프로젝트코드, 사번, 고용형태, 사원구분, 급여구분, CD_JOB_SERIES)
)

-- 수정일자 : 2011.12.05			수정자 : 변영석
-- 수정내용 : 조선호텔베이커리 전용으로 부서레벨별 집계를 위해 생성
DECLARE @P_DTEMP_CHOSUNHOTEL TABLE 
( 
    회사코드		NVARCHAR(7),
    사업장코드    NVARCHAR(7), 
    부서코드    NVARCHAR(12), 
    하위부서    NVARCHAR(4000),
    NO_CNT		INT,
    PAY_01        NUMERIC(17,4),  
    PAY_02        NUMERIC(17,4), 
    PAY_03        NUMERIC(17,4), 
    PAY_04        NUMERIC(17,4), 
    PAY_05        NUMERIC(17,4), 
    PAY_06        NUMERIC(17,4), 
    PAY_07        NUMERIC(17,4), 
    PAY_08        NUMERIC(17,4), 
    PAY_09        NUMERIC(17,4), 
    PAY_10        NUMERIC(17,4), 
    PAY_11        NUMERIC(17,4), 
    PAY_12        NUMERIC(17,4), 
    PAY_13        NUMERIC(17,4), 
    PAY_14        NUMERIC(17,4), 
    PAY_15        NUMERIC(17,4), 
    PAY_16        NUMERIC(17,4), 
    PAY_17        NUMERIC(17,4), 
    PAY_18        NUMERIC(17,4), 
    PAY_19        NUMERIC(17,4), 
    PAY_20        NUMERIC(17,4), 
    PAY_21        NUMERIC(17,4), 
    PAY_22        NUMERIC(17,4), 
    PAY_23        NUMERIC(17,4), 
    PAY_24        NUMERIC(17,4), 
    PAY_25        NUMERIC(17,4), 
    PAY_26        NUMERIC(17,4), 
    PAY_27        NUMERIC(17,4), 
    PAY_28        NUMERIC(17,4), 
    PAY_29        NUMERIC(17,4), 
    PAY_30        NUMERIC(17,4), 
    PAY_31        NUMERIC(17,4), 
    PAY_32        NUMERIC(17,4), 
    PAY_33        NUMERIC(17,4), 
    PAY_34        NUMERIC(17,4), 
    PAY_35        NUMERIC(17,4), 
    PAY_36        NUMERIC(17,4), 
    PAY_37        NUMERIC(17,4), 
    PAY_38        NUMERIC(17,4), 
    PAY_39        NUMERIC(17,4), 
    PAY_40        NUMERIC(17,4), 
    DEDU_01        NUMERIC(17,4), 
    DEDU_02        NUMERIC(17,4), 
    DEDU_03        NUMERIC(17,4), 
    DEDU_04        NUMERIC(17,4), 
    DEDU_05        NUMERIC(17,4), 
    DEDU_06        NUMERIC(17,4), 
    DEDU_07        NUMERIC(17,4), 
    DEDU_08        NUMERIC(17,4), 
    DEDU_09        NUMERIC(17,4), 
    DEDU_10        NUMERIC(17,4), 
    DEDU_11        NUMERIC(17,4), 
    DEDU_12        NUMERIC(17,4), 
    DEDU_13        NUMERIC(17,4), 
    DEDU_14        NUMERIC(17,4), 
    DEDU_15        NUMERIC(17,4), 
    DEDU_16        NUMERIC(17,4), 
    DEDU_17        NUMERIC(17,4), 
    DEDU_18        NUMERIC(17,4), 
    DEDU_19        NUMERIC(17,4), 
    DEDU_20        NUMERIC(17,4), 
    DEDU_21        NUMERIC(17,4), 
    DEDU_22        NUMERIC(17,4), 
    DEDU_23        NUMERIC(17,4), 
    DEDU_24        NUMERIC(17,4), 
    DEDU_25        NUMERIC(17,4), 
    DEDU_26        NUMERIC(17,4), 
    DEDU_27        NUMERIC(17,4), 
    DEDU_28        NUMERIC(17,4), 
    DEDU_29        NUMERIC(17,4), 
    DEDU_30        NUMERIC(17,4), 
    DEDU_31        NUMERIC(17,4), 
    DEDU_32        NUMERIC(17,4), 
    DEDU_33        NUMERIC(17,4), 
    DEDU_34        NUMERIC(17,4), 
    DEDU_35        NUMERIC(17,4), 
    DEDU_36        NUMERIC(17,4), 
    DEDU_37        NUMERIC(17,4), 
    DEDU_38        NUMERIC(17,4), 
    DEDU_39        NUMERIC(17,4), 
    DEDU_40        NUMERIC(17,4), 
    AM_TEMP        NUMERIC(17, 4), 
    AM_INCOMTAX    NUMERIC(17,4), 
    AM_RESIDTAX    NUMERIC(17,4), 
    AM_TOTTAX    NUMERIC(17,4), 
    AM_TOTNOTAX    NUMERIC(17,4), 
    AM_NOTAX0    NUMERIC(17,4), 
    AM_NOTAX1    NUMERIC(17,4), 
    AM_NOTAX2    NUMERIC(17,4), 
    AM_NOTAX3    NUMERIC(17,4),    -- 국민 + 건강 
    AM_NOTAX4    NUMERIC(17,4),    -- 고용 
    PRIMARY KEY(회사코드, 사업장코드, 부서코드)
)  
 
 IF NEOE.FN_SERVERKEY('N', 'SSGFOOD|') = 'Y'
 BEGIN
    INSERT INTO @P_DTEMP 
    ( 
        회사코드,
        사업장코드, 
        부서코드, 
        CC, 
        직위코드, 
        직군코드, 
        직급코드, 
        직책코드, 
        호봉코드, 
        프로젝트코드,
        사번, 
        고용형태, 
        사원구분, 
        급여구분, 
        퇴사일자, 
        급여시작일, 
        급여종료일, 
        사용자정의1,
        사용자정의2,
        사용자정의3,
        AM_PAY01,AM_PAY02,AM_PAY03,AM_PAY04,AM_PAY05,AM_PAY06,AM_PAY07,AM_PAY08,AM_PAY09,AM_PAY10, 
        AM_PAY11,AM_PAY12,AM_PAY13,AM_PAY14,AM_PAY15,AM_PAY16,AM_PAY17,AM_PAY18,AM_PAY19,AM_PAY20, 
        AM_PAY21,AM_PAY22,AM_PAY23,AM_PAY24,AM_PAY25,AM_PAY26,AM_PAY27,AM_PAY28,AM_PAY29,AM_PAY30, 
        AM_PAY31,AM_PAY32,AM_PAY33,AM_PAY34,AM_PAY35,AM_PAY36,AM_PAY37,AM_PAY38,AM_PAY39,AM_PAY40, 
        AM_DEDUCT01,AM_DEDUCT02,AM_DEDUCT03,AM_DEDUCT04,AM_DEDUCT05,AM_DEDUCT06,AM_DEDUCT07,AM_DEDUCT08,AM_DEDUCT09,AM_DEDUCT10, 
        AM_DEDUCT11,AM_DEDUCT12,AM_DEDUCT13,AM_DEDUCT14,AM_DEDUCT15,AM_DEDUCT16,AM_DEDUCT17,AM_DEDUCT18,AM_DEDUCT19,AM_DEDUCT20, 
        AM_DEDUCT21,AM_DEDUCT22,AM_DEDUCT23,AM_DEDUCT24,AM_DEDUCT25,AM_DEDUCT26,AM_DEDUCT27,AM_DEDUCT28,AM_DEDUCT29,AM_DEDUCT30, 
        AM_DEDUCT31,AM_DEDUCT32,AM_DEDUCT33,AM_DEDUCT34,AM_DEDUCT35,AM_DEDUCT36,AM_DEDUCT37,AM_DEDUCT38,AM_DEDUCT39,AM_DEDUCT40, 
        AM_INCOMTAX, AM_RESIDTAX, AM_TOTTAX, AM_TOTNOTAX, AM_NOTAX0, AM_NOTAX1, AM_NOTAX2, AM_NOTAX3, AM_NOTAX4,
        AM_NANNU, AM_NINS, AM_NEMPE, AM_NOINS, IN_PAY, DT_PAY, AM_SIN, CD_JOB_SERIES
    ) 
    SELECT  T.CD_COMPANY,  T.CD_BIZAREA, T.CD_DEPT, T.CD_CC, T.CD_DUTY_RANK, T.CD_DUTY_TYPE, T.CD_DUTY_STEP, T.CD_DUTY_RESP, T.CD_PAY_STEP, T.CD_PJT,
            T.NO_EMP, T.CD_EMP, T.TP_EMP, T.TP_PAY, T.DT_RETIRE, T.DT_START, T.DT_END,
            T.CD_USER1, T.CD_USER2, T.CD_USER3,
            T.AM_PAY01,        T.AM_PAY02,     
            T.AM_PAY03,        T.AM_PAY04,        T.AM_PAY05,        T.AM_PAY06,        T.AM_PAY07,        T.AM_PAY08,     
            T.AM_PAY09,        T.AM_PAY10,        T.AM_PAY11,        T.AM_PAY12,        T.AM_PAY13,        T.AM_PAY14,     
            T.AM_PAY15,        T.AM_PAY16,        T.AM_PAY17,        T.AM_PAY18,        T.AM_PAY19,        T.AM_PAY20,     
            T.AM_PAY21,        T.AM_PAY22,        T.AM_PAY23,        T.AM_PAY24,        T.AM_PAY25,        T.AM_PAY26,     
            T.AM_PAY27,        T.AM_PAY28,        T.AM_PAY29,        T.AM_PAY30,        T.AM_PAY31,        T.AM_PAY32,     
            T.AM_PAY33,        T.AM_PAY34,        T.AM_PAY35,        T.AM_PAY36,        T.AM_PAY37,        T.AM_PAY38,     
            T.AM_PAY39,        T.AM_PAY40,        T.AM_DEDUCT01,        T.AM_DEDUCT02,        T.AM_DEDUCT03,        T.AM_DEDUCT04,     
            T.AM_DEDUCT05,        T.AM_DEDUCT06,        T.AM_DEDUCT07,        T.AM_DEDUCT08,        T.AM_DEDUCT09,        T.AM_DEDUCT10,     
            T.AM_DEDUCT11,        T.AM_DEDUCT12,        T.AM_DEDUCT13,        T.AM_DEDUCT14,        T.AM_DEDUCT15,        T.AM_DEDUCT16,     
            T.AM_DEDUCT17,        T.AM_DEDUCT18,        T.AM_DEDUCT19,        T.AM_DEDUCT20,        T.AM_DEDUCT21,        T.AM_DEDUCT22,     
            T.AM_DEDUCT23,        T.AM_DEDUCT24,        T.AM_DEDUCT25,        T.AM_DEDUCT26,        T.AM_DEDUCT27,        T.AM_DEDUCT28,     
            T.AM_DEDUCT29,        T.AM_DEDUCT30,        T.AM_DEDUCT31,        T.AM_DEDUCT32,        T.AM_DEDUCT33,        T.AM_DEDUCT34,     
            T.AM_DEDUCT35,        T.AM_DEDUCT36,        T.AM_DEDUCT37,        T.AM_DEDUCT38,        T.AM_DEDUCT39,        T.AM_DEDUCT40, 
            T.AM_INCOMTAX, T.AM_RESIDTAX, T.AM_TOTTAX, T.AM_TOTNOTAX, 
 
            CASE WHEN SUBSTRING(@P_YM, 1, 4) >= '2009' THEN T.AM_NOTAX0_2009  
            ELSE T.AM_NOTAX0 END AM_NOTAX0, --신고비과세 
 
            CASE WHEN SUBSTRING(@P_YM, 1, 4) >= '2009' THEN T.AM_NOTAX1_2009 - T.AM_NOTAX
            ELSE T.AM_NOTAX1 END AM_NOTAX1,--미신고비과세 
 
            CASE WHEN SUBSTRING(@P_YM, 1, 4) >= '2009' THEN T.AM_NOTAX
            ELSE T.AM_NOTAX2 END AM_NOTAX2,--사용자부담금 
            T.AM_NOTAX3, T.AM_NOTAX4,
            T.AM_NANNU, T.AM_NINS, T.AM_NEMPE, T.AM_NOINS, T.IN_PAY, T.DT_PAY, 0, T.CD_JOB_SERIES
    FROM    ( 
            SELECT  PAY.CD_COMPANY,  PAY.CD_BIZAREA,     
            ISNULL(PAY.CD_DEPT, '') CD_DEPT, 
            ISNULL(PAY.CD_CC, '') CD_CC, 
            ISNULL(PAY.CD_DUTY_RANK, '') CD_DUTY_RANK, 
            ISNULL(PAY.CD_DUTY_TYPE, '') CD_DUTY_TYPE, 
            ISNULL(PAY.CD_DUTY_STEP, '') CD_DUTY_STEP, 
            ISNULL(PAY.CD_DUTY_RESP, '') CD_DUTY_RESP,
            ISNULL(PAY.CD_PAY_STEP, '') CD_PAY_STEP, 
            ISNULL(PAY.CD_PJT, '') CD_PJT,
            ISNULL(E.CD_USER1, '') CD_USER1,
            ISNULL(E.CD_USER2, '') CD_USER2,
            ISNULL(E.CD_USER3, '') CD_USER3,
            PAY.NO_EMP, 
            PAY.CD_EMP, 
            PAY.TP_EMP, 
            PAY.TP_PAY, 
            CASE    WHEN E.DT_RETIRE IS NULL OR RTRIM(LTRIM(E.DT_RETIRE)) = '' OR E.DT_RETIRE = '00000000' THEN '99999999' ELSE E.DT_RETIRE END DT_RETIRE, 
            DT.DT_START, 
            DT.DT_END, 
            SUM(AM_PAY01) AM_PAY01, SUM(AM_PAY02) AM_PAY02, SUM(AM_PAY03) AM_PAY03, SUM(AM_PAY04) AM_PAY04, SUM(AM_PAY05) AM_PAY05, 
            SUM(AM_PAY06) AM_PAY06, SUM(AM_PAY07) AM_PAY07, SUM(AM_PAY08) AM_PAY08, SUM(AM_PAY09) AM_PAY09, SUM(AM_PAY10) AM_PAY10, 
            SUM(AM_PAY11) AM_PAY11, SUM(AM_PAY12) AM_PAY12, SUM(AM_PAY13) AM_PAY13, SUM(AM_PAY14) AM_PAY14, SUM(AM_PAY15) AM_PAY15, 
            SUM(AM_PAY16) AM_PAY16, SUM(AM_PAY17) AM_PAY17, SUM(AM_PAY18) AM_PAY18, SUM(AM_PAY19) AM_PAY19, SUM(AM_PAY20) AM_PAY20, 
            SUM(AM_PAY21) AM_PAY21, SUM(AM_PAY22) AM_PAY22, SUM(AM_PAY23) AM_PAY23, SUM(AM_PAY24) AM_PAY24, SUM(AM_PAY25) AM_PAY25, 
            SUM(AM_PAY26) AM_PAY26, SUM(AM_PAY27) AM_PAY27, SUM(AM_PAY28) AM_PAY28, SUM(AM_PAY29) AM_PAY29, SUM(AM_PAY30) AM_PAY30, 
            SUM(AM_PAY31) AM_PAY31, SUM(AM_PAY32) AM_PAY32, SUM(AM_PAY33) AM_PAY33, SUM(AM_PAY34) AM_PAY34, SUM(AM_PAY35) AM_PAY35, 
            SUM(AM_PAY36) AM_PAY36, SUM(AM_PAY37) AM_PAY37, SUM(AM_PAY38) AM_PAY38, SUM(AM_PAY39) AM_PAY39, SUM(AM_PAY40) AM_PAY40, 
            SUM(AM_DEDUCT01) AM_DEDUCT01, SUM(AM_DEDUCT02) AM_DEDUCT02, SUM(AM_DEDUCT03) AM_DEDUCT03, SUM(AM_DEDUCT04) AM_DEDUCT04, SUM(AM_DEDUCT05) AM_DEDUCT05, 
            SUM(AM_DEDUCT06) AM_DEDUCT06, SUM(AM_DEDUCT07) AM_DEDUCT07, SUM(AM_DEDUCT08) AM_DEDUCT08, SUM(AM_DEDUCT09) AM_DEDUCT09, SUM(AM_DEDUCT10) AM_DEDUCT10, 
            SUM(AM_DEDUCT11) AM_DEDUCT11, SUM(AM_DEDUCT12) AM_DEDUCT12, SUM(AM_DEDUCT13) AM_DEDUCT13, SUM(AM_DEDUCT14) AM_DEDUCT14, SUM(AM_DEDUCT15) AM_DEDUCT15, 
            SUM(AM_DEDUCT16) AM_DEDUCT16, SUM(AM_DEDUCT17) AM_DEDUCT17, SUM(AM_DEDUCT18) AM_DEDUCT18, SUM(AM_DEDUCT19) AM_DEDUCT19, SUM(AM_DEDUCT20) AM_DEDUCT20, 
            SUM(AM_DEDUCT21) AM_DEDUCT21, SUM(AM_DEDUCT22) AM_DEDUCT22, SUM(AM_DEDUCT23) AM_DEDUCT23, SUM(AM_DEDUCT24) AM_DEDUCT24, SUM(AM_DEDUCT25) AM_DEDUCT25, 
            SUM(AM_DEDUCT26) AM_DEDUCT26, SUM(AM_DEDUCT27) AM_DEDUCT27, SUM(AM_DEDUCT28) AM_DEDUCT28, SUM(AM_DEDUCT29) AM_DEDUCT29, SUM(AM_DEDUCT30) AM_DEDUCT30, 
            SUM(AM_DEDUCT31) AM_DEDUCT31, SUM(AM_DEDUCT32) AM_DEDUCT32, SUM(AM_DEDUCT33) AM_DEDUCT33, SUM(AM_DEDUCT34) AM_DEDUCT34, SUM(AM_DEDUCT35) AM_DEDUCT35, 
            SUM(AM_DEDUCT36) AM_DEDUCT36, SUM(AM_DEDUCT37) AM_DEDUCT37, SUM(AM_DEDUCT38) AM_DEDUCT38, SUM(AM_DEDUCT39) AM_DEDUCT39, SUM(AM_DEDUCT40) AM_DEDUCT40, 
            SUM(AM_INCOMTAX) AM_INCOMTAX, SUM(AM_RESIDTAX) AM_RESIDTAX,  
            SUM(AM_TOTTAX) + SUM(AM_STOCK) + SUM(AM_RBONUS) + SUM(AM_ETCPAY) AM_TOTTAX, 
            SUM(AM_TOTNOTAX) AM_TOTNOTAX, 
 
            ISNULL(SUM(AM_NOTAX_REP), 0) AM_NOTAX0_2009, 
            SUM(AM_NRND) + SUM(AM_NOFOREIGN) + SUM(AM_NOABROD) + SUM(AM_NOEXT) + SUM(AM_NOETC) - SUM(AM_NEAT) - SUM(AM_NTR) AM_NOTAX0, --신고비과세 
 
            ISNULL(SUM(AM_NOTAX_UNREP), 0) AM_NOTAX1_2009, 
            SUM(AM_NEAT) + SUM(AM_NTR) AM_NOTAX1,--미신고비과세 
            SUM(AM_NANNU) + SUM(AM_NINS) + SUM(AM_NEMPE) + SUM(AM_NEMPS) + SUM(AM_NEMPA) + SUM(AM_NEDU) + SUM(ISNULL(AM_NOINS, 0)) AM_NOTAX2,--사용자부담금 
 
 
            SUM(AM_NANNU) + SUM(AM_NINS) AM_NOTAX3,  
            SUM(AM_NEMPE) + SUM(AM_NEMPS) + SUM(AM_NEMPA) AM_NOTAX4,
			ISNULL(SUM(N.AM_NOTAX), 0) AM_NOTAX,
			ISNULL(SUM(AM_NANNU), 0) AM_NANNU, 
			ISNULL(SUM(AM_NINS), 0) AM_NINS, 
			ISNULL(SUM(AM_NEMPE), 0) AM_NEMPE, 
			ISNULL(SUM(AM_NOINS), 0) AM_NOINS,
			SUBSTRING(TI.DT_PAY, 7, 2) AS IN_PAY,
			SUBSTRING(TI.DT_PAY, 1, 6) AS DT_PAY,
			ISNULL(PAY.CD_JOB_SERIES, '') CD_JOB_SERIES
        FROM    HR_PCALCPAY AS PAY 
        INNER JOIN MA_EMP AS E 
        ON    PAY.CD_COMPANY     = E.CD_COMPANY 
        AND    PAY.NO_EMP         = E.NO_EMP 
        INNER JOIN HR_PTITLE AS TI  
        ON    PAY.CD_COMPANY    = TI.CD_COMPANY 
        AND    PAY.CD_BIZAREA        = TI.CD_BIZAREA 
        AND    PAY.TP_EMP        = TI.TP_EMP  
        AND    PAY.CD_EMP        = TI.CD_EMP 
        AND    PAY.TP_PAY        = TI.TP_PAY 
        AND    PAY.NO_SEQ        = TI.NO_SEQ 
        AND    PAY.YM            = TI.YM 
        AND    (TI.DT_PAY        = @P_DT_PAY OR @P_DT_PAY = '') 
        INNER JOIN 
            ( 
            SELECT     CD_COMPANY, CD_BIZAREA, CD_EMP, TP_EMP, CD_MONTH, DT_CLOSE,   
                CASE CD_MONTH WHEN '001' THEN                          
                    CONVERT(CHAR(8),DATEADD(MONTH, -1, CONVERT(DATETIME, @P_YM + RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2))),112)     
                ELSE                     
                    @P_YM+RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2) 
                END DT_START,  
                CASE CD_MONTH WHEN '001' THEN                      
                    CONVERT(CHAR(8),DATEADD(DAY, -1, CONVERT(DATETIME, @P_YM+RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2))),112)     
                ELSE                     
                    CONVERT(CHAR(8),DATEADD(DAY,-1,DATEADD(MONTH, 1, CONVERT(DATETIME, @P_YM+RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2)))),112) 
                END DT_END           
            FROM     HR_WCLOSE  
            WHERE    (ISNULL(@P_CD_COMPANY, '' ) = '' OR CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
            AND    TP_CLOSE    = '2' 
            ) AS DT 
        ON    PAY.CD_COMPANY     = DT.CD_COMPANY 
        AND    PAY.CD_BIZAREA     = DT.CD_BIZAREA 
        AND    PAY.CD_EMP         = DT.CD_EMP 
        AND    PAY.TP_EMP         = DT.TP_EMP 
		LEFT OUTER JOIN ( 
						SELECT   N.CD_COMPANY, N.NO_EMP, N.TP_PAY, N.NO_SEQ, SUM(N.AM_NOTAX) AM_NOTAX
						FROM    HR_PCALCPAY_N N
						INNER JOIN    (
									SELECT    DISTINCT CD_COMPANY, CD_BIZAREA, NO_EMP, NO_SEQ, CD_EMP, TP_EMP, TP_PAY
									FROM    HR_PCALCPAY 
									WHERE    (ISNULL(@P_CD_COMPANY, '') = '' OR CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
									AND YM = @P_YM AND (TP_PAY = @P_TP_PAY OR @P_TP_PAY = '') 
									AND        (CD_EMP        = @P_CD_EMP OR @P_CD_EMP = '')     
									AND        (TP_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_TP_EMP)) OR @P_MULTI_TP_EMP = '')
									AND        (NO_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT2(@P_MULTI_EMP)) OR CONVERT(VARCHAR, @P_MULTI_EMP) = '')  
									) P
						ON      N.CD_COMPANY = P.CD_COMPANY AND  N.NO_EMP = P.NO_EMP AND N.NO_SEQ = P.NO_SEQ AND N.TP_PAY = P.TP_PAY
						INNER JOIN HR_PTITLE TI  
						ON       P.CD_COMPANY = TI.CD_COMPANY AND P.CD_BIZAREA = TI.CD_BIZAREA 
						AND        P.TP_EMP = TI.TP_EMP AND P.CD_EMP = TI.CD_EMP AND N.TP_PAY = TI.TP_PAY AND N.NO_SEQ = TI.NO_SEQ 
						AND        N.YM = TI.YM AND (TI.DT_PAY = @P_DT_PAY OR @P_DT_PAY = '') 
						WHERE    (ISNULL(@P_CD_COMPANY, '') = '' OR N.CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
						AND N.YM = @P_YM 
						AND        (@P_TP_PAY IS NULL OR @P_TP_PAY = '' OR N.TP_PAY = @P_TP_PAY) AND N.CD_NOTAX = 'N01' 
						GROUP BY N.CD_COMPANY, N.NO_EMP, N.TP_PAY, N.NO_SEQ
						) N 
        ON   PAY.CD_COMPANY = N.CD_COMPANY AND    PAY.NO_EMP = N.NO_EMP AND PAY.TP_PAY = N.TP_PAY AND PAY.NO_SEQ = N.NO_SEQ
        WHERE	(ISNULL(@P_CD_COMPANY, '') = '' OR PAY.CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
        AND		(PAY.CD_BIZAREA IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_BIZAREA)) OR @P_MULTI_BIZAREA = '')  
        AND		(PAY.CD_DEPT IN (SELECT CD_STR FROM GETTABLEFROMSPLIT2(@P_MULTI_DEPT)) OR CONVERT(VARCHAR, @P_MULTI_DEPT) = '' OR @P_MULTI_DEPT IS NULL)  
        AND		(PAY.NO_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT2(@P_MULTI_EMP)) OR CONVERT(VARCHAR, @P_MULTI_EMP) = '')  
        AND		PAY.YM            = @P_YM      
        AND		(PAY.CD_EMP        = @P_CD_EMP OR @P_CD_EMP = '')     
        AND		(PAY.TP_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_TP_EMP)) OR @P_MULTI_TP_EMP = '')      
        AND		(PAY.TP_PAY        = @P_TP_PAY OR @P_TP_PAY = '') 
        --순번 추가
        AND		PAY.NO_SEQ = CASE WHEN @P_NO_SEQ > 0 THEN @P_NO_SEQ ELSE PAY.NO_SEQ END
        AND		(PAY.CD_LTAX_AREA IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_LTAX_AREA)) OR @P_MULTI_LTAX_AREA = '' OR @P_MULTI_LTAX_AREA IS NULL) 
        GROUP BY PAY.CD_COMPANY, PAY.CD_BIZAREA, ISNULL(PAY.CD_DEPT, ''), PAY.YM, ISNULL(PAY.CD_CC, ''), ISNULL(PAY.CD_DUTY_RANK, ''), ISNULL(PAY.CD_DUTY_TYPE, ''), ISNULL(PAY.CD_DUTY_STEP, ''), ISNULL(PAY.CD_DUTY_RESP, ''), ISNULL(PAY.CD_PAY_STEP, ''), ISNULL(PAY.CD_PJT, ''), E.CD_USER1, E.CD_USER2, E.CD_USER3, PAY.NO_EMP, PAY.CD_EMP, PAY.TP_EMP, PAY.TP_PAY, E.DT_RETIRE, DT.DT_START, DT.DT_END, SUBSTRING(TI.DT_PAY, 7, 2), SUBSTRING(TI.DT_PAY, 1, 6), ISNULL(PAY.CD_JOB_SERIES, '')
        --ORDER BY PAY.CD_BIZAREA ASC, PAY.CD_DEPT ASC, PAY.CD_DUTY_RANK ASC, PAY.NO_EMP ASC 
        ) T 
 END
 ELSE IF NEOE.FN_SERVERKEY('N', 'TMFK|TMFK2|TMFK3|') = 'Y'
 BEGIN
	DECLARE @V_MAXYM_DEDUCT		NVARCHAR(6),			
			@V_RT_DEDUCT		NUMERIC(8,5),
			@V_AM_VALUE_022		NUMERIC(17,4),
			@V_AM_VALUE_034		NUMERIC(17,4),
			
			@V_MAXYM			NVARCHAR(6),
			@V_CD_CPAYDEDUCT	NVARCHAR(3),
			
			@V_ID				INT,
			@V_ROWCOUNT			INT,
			@V_QUERY			NVARCHAR(4000),
			@V_CD_COMPANY		NVARCHAR(7),
			@V_NO_EMP			NVARCHAR(12),
			@V_CD_EMP			NVARCHAR(3),
			@V_TP_EMP			NVARCHAR(3),
			@V_TP_PAY			NVARCHAR(3)
			
	SET @V_CD_COMPANY = REPLACE(@P_CD_COMPANY, '|', '')			
	
	SELECT	@V_MAXYM_DEDUCT = MAX(YM)
	FROM	HR_DEDUCT
	WHERE	CD_COMPANY = @V_CD_COMPANY AND YM <= @P_YM
	
	SELECT	@V_RT_DEDUCT = ISNULL(RT_DEDUCT, 0) 
	FROM	HR_DEDUCT 
	WHERE	CD_COMPANY = @V_CD_COMPANY AND YM = @V_MAXYM_DEDUCT AND CD_DEDUCT = 'KA005'
	
	SELECT	@V_AM_VALUE_022 = ISNULL(AM_VALUE, 0) 
	FROM	HR_CONFIG
	WHERE	CD_COMPANY = @V_CD_COMPANY AND CD_SYS = 'PAY022'
	
	SELECT	@V_AM_VALUE_034 = ISNULL(AM_VALUE, 0) 
	FROM	HR_CONFIG
	WHERE	CD_COMPANY = @V_CD_COMPANY AND CD_SYS = 'PAY034'
	
	CREATE TABLE #PAY_TABLE_TMFK
	(
		회사코드		NVARCHAR(7),
		사업장코드		NVARCHAR(7), 
		부서코드		NVARCHAR(12), 
		CC              NVARCHAR(12), 
		직위코드    	NVARCHAR(3), 
		직군코드    	NVARCHAR(3), 
		직급코드    	NVARCHAR(3), 
		직책코드    	NVARCHAR(3), 
		호봉코드    	NVARCHAR(6), 
		프로젝트코드    NVARCHAR(20),		--집계형태 추가
		사번        	NVARCHAR(10), 
		고용형태    	NVARCHAR(3), 
		사원구분    	NVARCHAR(3), 
		급여구분    	NVARCHAR(3),     
		퇴사일자    	NVARCHAR(8), 
		급여시작일		NVARCHAR(8), 
		급여종료일		NVARCHAR(8), 
		사용자정의1		NVARCHAR(3),	
		사용자정의2		NVARCHAR(3),
		사용자정의3		NVARCHAR(3),
		AM_PAY01    NUMERIC(17,4),  
		AM_PAY02    NUMERIC(17,4), 
		AM_PAY03    NUMERIC(17,4), 
		AM_PAY04    NUMERIC(17,4), 
		AM_PAY05    NUMERIC(17,4), 
		AM_PAY06    NUMERIC(17,4), 
		AM_PAY07    NUMERIC(17,4), 
		AM_PAY08    NUMERIC(17,4), 
		AM_PAY09    NUMERIC(17,4), 
		AM_PAY10    NUMERIC(17,4), 
		AM_PAY11    NUMERIC(17,4), 
		AM_PAY12    NUMERIC(17,4), 
		AM_PAY13    NUMERIC(17,4), 
		AM_PAY14    NUMERIC(17,4), 
		AM_PAY15    NUMERIC(17,4), 
		AM_PAY16    NUMERIC(17,4), 
		AM_PAY17    NUMERIC(17,4), 
		AM_PAY18    NUMERIC(17,4), 
		AM_PAY19    NUMERIC(17,4), 
		AM_PAY20    NUMERIC(17,4), 
		AM_PAY21    NUMERIC(17,4), 
		AM_PAY22    NUMERIC(17,4), 
		AM_PAY23    NUMERIC(17,4), 
		AM_PAY24    NUMERIC(17,4), 
		AM_PAY25    NUMERIC(17,4), 
		AM_PAY26    NUMERIC(17,4), 
		AM_PAY27    NUMERIC(17,4), 
		AM_PAY28    NUMERIC(17,4), 
		AM_PAY29    NUMERIC(17,4), 
		AM_PAY30    NUMERIC(17,4), 
		AM_PAY31    NUMERIC(17,4), 
		AM_PAY32    NUMERIC(17,4), 
		AM_PAY33    NUMERIC(17,4), 
		AM_PAY34    NUMERIC(17,4), 
		AM_PAY35    NUMERIC(17,4), 
		AM_PAY36    NUMERIC(17,4), 
		AM_PAY37    NUMERIC(17,4), 
		AM_PAY38    NUMERIC(17,4), 
		AM_PAY39    NUMERIC(17,4), 
		AM_PAY40    NUMERIC(17,4), 
		AM_DEDUCT01    NUMERIC(17,4), 
		AM_DEDUCT02    NUMERIC(17,4), 
		AM_DEDUCT03    NUMERIC(17,4), 
		AM_DEDUCT04    NUMERIC(17,4), 
		AM_DEDUCT05    NUMERIC(17,4), 
		AM_DEDUCT06    NUMERIC(17,4), 
		AM_DEDUCT07    NUMERIC(17,4), 
		AM_DEDUCT08    NUMERIC(17,4), 
		AM_DEDUCT09    NUMERIC(17,4), 
		AM_DEDUCT10    NUMERIC(17,4), 
		AM_DEDUCT11    NUMERIC(17,4), 
		AM_DEDUCT12    NUMERIC(17,4), 
		AM_DEDUCT13    NUMERIC(17,4), 
		AM_DEDUCT14    NUMERIC(17,4), 
		AM_DEDUCT15    NUMERIC(17,4), 
		AM_DEDUCT16    NUMERIC(17,4), 
		AM_DEDUCT17    NUMERIC(17,4), 
		AM_DEDUCT18    NUMERIC(17,4), 
		AM_DEDUCT19    NUMERIC(17,4), 
		AM_DEDUCT20    NUMERIC(17,4), 
		AM_DEDUCT21    NUMERIC(17,4), 
		AM_DEDUCT22    NUMERIC(17,4), 
		AM_DEDUCT23    NUMERIC(17,4), 
		AM_DEDUCT24    NUMERIC(17,4), 
		AM_DEDUCT25    NUMERIC(17,4), 
		AM_DEDUCT26    NUMERIC(17,4), 
		AM_DEDUCT27    NUMERIC(17,4), 
		AM_DEDUCT28    NUMERIC(17,4), 
		AM_DEDUCT29    NUMERIC(17,4), 
		AM_DEDUCT30    NUMERIC(17,4), 
		AM_DEDUCT31    NUMERIC(17,4), 
		AM_DEDUCT32    NUMERIC(17,4), 
		AM_DEDUCT33    NUMERIC(17,4), 
		AM_DEDUCT34    NUMERIC(17,4), 
		AM_DEDUCT35    NUMERIC(17,4), 
		AM_DEDUCT36    NUMERIC(17,4), 
		AM_DEDUCT37    NUMERIC(17,4), 
		AM_DEDUCT38    NUMERIC(17,4), 
		AM_DEDUCT39    NUMERIC(17,4), 
		AM_DEDUCT40    NUMERIC(17,4), 
		PAY_01        NUMERIC(17,4),  
		PAY_02        NUMERIC(17,4), 
		PAY_03        NUMERIC(17,4), 
		PAY_04        NUMERIC(17,4), 
		PAY_05        NUMERIC(17,4), 
		PAY_06        NUMERIC(17,4), 
		PAY_07        NUMERIC(17,4), 
		PAY_08        NUMERIC(17,4), 
		PAY_09        NUMERIC(17,4), 
		PAY_10        NUMERIC(17,4), 
		PAY_11        NUMERIC(17,4), 
		PAY_12        NUMERIC(17,4), 
		PAY_13        NUMERIC(17,4), 
		PAY_14        NUMERIC(17,4), 
		PAY_15        NUMERIC(17,4), 
		PAY_16        NUMERIC(17,4), 
		PAY_17        NUMERIC(17,4), 
		PAY_18        NUMERIC(17,4), 
		PAY_19        NUMERIC(17,4), 
		PAY_20        NUMERIC(17,4), 
		PAY_21        NUMERIC(17,4), 
		PAY_22        NUMERIC(17,4), 
		PAY_23        NUMERIC(17,4), 
		PAY_24        NUMERIC(17,4), 
		PAY_25        NUMERIC(17,4), 
		PAY_26        NUMERIC(17,4), 
		PAY_27        NUMERIC(17,4), 
		PAY_28        NUMERIC(17,4), 
		PAY_29        NUMERIC(17,4), 
		PAY_30        NUMERIC(17,4), 
		PAY_31        NUMERIC(17,4), 
		PAY_32        NUMERIC(17,4), 
		PAY_33        NUMERIC(17,4), 
		PAY_34        NUMERIC(17,4), 
		PAY_35        NUMERIC(17,4), 
		PAY_36        NUMERIC(17,4), 
		PAY_37        NUMERIC(17,4), 
		PAY_38        NUMERIC(17,4), 
		PAY_39        NUMERIC(17,4), 
		PAY_40        NUMERIC(17,4), 
		PAY_41        NUMERIC(17,4), 
		PAY_42        NUMERIC(17,4), 
		PAY_43        NUMERIC(17,4), 
		PAY_44        NUMERIC(17,4), 
		PAY_45        NUMERIC(17,4), 
		PAY_46        NUMERIC(17,4), 
		PAY_47        NUMERIC(17,4), 
		PAY_48        NUMERIC(17,4), 
		PAY_49        NUMERIC(17,4), 
		PAY_50        NUMERIC(17,4),
		PAY_51        NUMERIC(17,4), 
		PAY_52        NUMERIC(17,4), 
		PAY_53        NUMERIC(17,4), 
		PAY_54        NUMERIC(17,4), 
		PAY_55        NUMERIC(17,4), 
		PAY_56        NUMERIC(17,4), 
		PAY_57        NUMERIC(17,4), 
		PAY_58        NUMERIC(17,4), 
		PAY_59        NUMERIC(17,4), 
		PAY_60        NUMERIC(17,4),
		PAY_61        NUMERIC(17,4), 
		PAY_62        NUMERIC(17,4), 
		PAY_63        NUMERIC(17,4), 
		PAY_64        NUMERIC(17,4), 
		PAY_65        NUMERIC(17,4), 
		PAY_66        NUMERIC(17,4), 
		PAY_67        NUMERIC(17,4), 
		PAY_68        NUMERIC(17,4), 
		PAY_69        NUMERIC(17,4), 
		PAY_70        NUMERIC(17,4),
		PAY_71        NUMERIC(17,4), 
		PAY_72        NUMERIC(17,4), 
		PAY_73        NUMERIC(17,4), 
		PAY_74        NUMERIC(17,4), 
		PAY_75        NUMERIC(17,4), 
		PAY_76        NUMERIC(17,4), 
		PAY_77        NUMERIC(17,4), 
		PAY_78        NUMERIC(17,4), 
		PAY_79        NUMERIC(17,4), 
		PAY_80        NUMERIC(17,4),        
		DEDU_01        NUMERIC(17,4), 
		DEDU_02        NUMERIC(17,4), 
		DEDU_03        NUMERIC(17,4), 
		DEDU_04        NUMERIC(17,4), 
		DEDU_05        NUMERIC(17,4), 
		DEDU_06        NUMERIC(17,4), 
		DEDU_07        NUMERIC(17,4), 
		DEDU_08        NUMERIC(17,4), 
		DEDU_09        NUMERIC(17,4), 
		DEDU_10        NUMERIC(17,4), 
		DEDU_11        NUMERIC(17,4), 
		DEDU_12        NUMERIC(17,4), 
		DEDU_13        NUMERIC(17,4), 
		DEDU_14        NUMERIC(17,4), 
		DEDU_15        NUMERIC(17,4), 
		DEDU_16        NUMERIC(17,4), 
		DEDU_17        NUMERIC(17,4), 
		DEDU_18        NUMERIC(17,4), 
		DEDU_19        NUMERIC(17,4), 
		DEDU_20        NUMERIC(17,4), 
		DEDU_21        NUMERIC(17,4), 
		DEDU_22        NUMERIC(17,4), 
		DEDU_23        NUMERIC(17,4), 
		DEDU_24        NUMERIC(17,4), 
		DEDU_25        NUMERIC(17,4), 
		DEDU_26        NUMERIC(17,4), 
		DEDU_27        NUMERIC(17,4), 
		DEDU_28        NUMERIC(17,4), 
		DEDU_29        NUMERIC(17,4), 
		DEDU_30        NUMERIC(17,4), 
		DEDU_31        NUMERIC(17,4), 
		DEDU_32        NUMERIC(17,4), 
		DEDU_33        NUMERIC(17,4), 
		DEDU_34        NUMERIC(17,4), 
		DEDU_35        NUMERIC(17,4), 
		DEDU_36        NUMERIC(17,4), 
		DEDU_37        NUMERIC(17,4), 
		DEDU_38        NUMERIC(17,4), 
		DEDU_39        NUMERIC(17,4), 
		DEDU_40        NUMERIC(17,4), 
		DEDU_41        NUMERIC(17,4), 
		DEDU_42        NUMERIC(17,4), 
		DEDU_43        NUMERIC(17,4), 
		DEDU_44        NUMERIC(17,4), 
		DEDU_45        NUMERIC(17,4), 
		DEDU_46        NUMERIC(17,4), 
		DEDU_47        NUMERIC(17,4), 
		DEDU_48        NUMERIC(17,4), 
		DEDU_49        NUMERIC(17,4), 
		DEDU_50        NUMERIC(17,4),
		DEDU_51        NUMERIC(17,4), 
		DEDU_52        NUMERIC(17,4), 
		DEDU_53        NUMERIC(17,4), 
		DEDU_54        NUMERIC(17,4), 
		DEDU_55        NUMERIC(17,4), 
		DEDU_56        NUMERIC(17,4), 
		DEDU_57        NUMERIC(17,4), 
		DEDU_58        NUMERIC(17,4), 
		DEDU_59        NUMERIC(17,4), 
		DEDU_60        NUMERIC(17,4),
		DEDU_61        NUMERIC(17,4), 
		DEDU_62        NUMERIC(17,4), 
		DEDU_63        NUMERIC(17,4), 
		DEDU_64        NUMERIC(17,4), 
		DEDU_65        NUMERIC(17,4), 
		DEDU_66        NUMERIC(17,4), 
		DEDU_67        NUMERIC(17,4), 
		DEDU_68        NUMERIC(17,4), 
		DEDU_69        NUMERIC(17,4), 
		DEDU_70        NUMERIC(17,4),
		DEDU_71        NUMERIC(17,4), 
		DEDU_72        NUMERIC(17,4), 
		DEDU_73        NUMERIC(17,4), 
		DEDU_74        NUMERIC(17,4), 
		DEDU_75        NUMERIC(17,4), 
		DEDU_76        NUMERIC(17,4), 
		DEDU_77        NUMERIC(17,4), 
		DEDU_78        NUMERIC(17,4), 
		DEDU_79        NUMERIC(17,4), 
		DEDU_80        NUMERIC(17,4),        
		AM_TEMP			NUMERIC(17, 4), 
		AM_INCOMTAX		NUMERIC(17,4), 
		AM_RESIDTAX		NUMERIC(17,4), 
		AM_TOTTAX		NUMERIC(17,4), 
		AM_TOTNOTAX		NUMERIC(17,4), 
		AM_NOTAX0		NUMERIC(17,4), 
		AM_NOTAX1		NUMERIC(17,4), 
		AM_NOTAX2		NUMERIC(17,4), 
		AM_NOTAX3		NUMERIC(17,4),		-- 국민 + 건강 
		AM_NOTAX4		NUMERIC(17,4),		-- 고용 
		AM_NANNU		NUMERIC(17,4),		-- 국민연금(사용자)
		AM_NINS			NUMERIC(17,4),		-- 건강보험(사용자)
		AM_NEMPE		NUMERIC(17,4),		-- 고용보험(사용자)
		AM_NOINS		NUMERIC(17,4),		-- 요양보험(사용자),
		AM_SIN			NUMERIC(17,4),		-- 신세계 전용 양식 컬럼 총계에서 제하기 위해 추가
		IN_PAY			NVARCHAR(2), 
		DT_PAY			NVARCHAR(10),
		CD_JOB_SERIES	NVARCHAR(3),
		CD_LTAX_AREA	NVARCHAR(7),
	    
		AM_ANNU			NUMERIC(17,4),		--TMFK 전용
		AM_INS			NUMERIC(17,4),		--TMFK 전용
		AM_INS1			NUMERIC(17,4),		--TMFK 전용
		AM_OINS			NUMERIC(17,4),		--TMFK 전용
		AM_OINS1		NUMERIC(17,4),		--TMFK 전용
		AM_EMPE			NUMERIC(17,4),		--TMFK 전용
		AM_EMPE1		NUMERIC(17,4),		--TMFK 전용
		AM_FIRE			NUMERIC(17,4),		--TMFK 전용
		AM_FIRE1		NUMERIC(17,4),		--TMFK 전용
		
		AM_PAY01_ER		NUMERIC(17,4),		--TMFK 전용
		AM_PAY02_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY03_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY04_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY05_ER		NUMERIC(17,4), 		--TMFK 전용
		AM_PAY06_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY07_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY08_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY09_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY10_ER		NUMERIC(17,4), 		--TMFK 전용
		AM_PAY11_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY12_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY13_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY14_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY15_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY16_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY17_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY18_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY19_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY20_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY21_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY22_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY23_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY24_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY25_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY26_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY27_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY28_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY29_ER		NUMERIC(17,4),		--TMFK 전용 
		AM_PAY30_ER		NUMERIC(17,4),		--TMFK 전용
		AM_NEMPA		NUMERIC(17,4)
		--PRIMARY KEY(회사코드, 사업장코드, 부서코드, CC, 직위코드, 직군코드, 직급코드, 직책코드, 호봉코드, 프로젝트코드, 사번, 고용형태, 사원구분, 급여구분)
	)

    INSERT INTO #PAY_TABLE_TMFK 
    ( 
        회사코드,
        사업장코드, 
        부서코드, 
        CC, 
        직위코드, 
        직군코드, 
        직급코드, 
        직책코드, 
        호봉코드, 
        프로젝트코드,
        사번, 
        고용형태, 
        사원구분, 
        급여구분, 
        퇴사일자, 
        급여시작일, 
        급여종료일, 
        사용자정의1,
        사용자정의2,
        사용자정의3,
        AM_PAY01,AM_PAY02,AM_PAY03,AM_PAY04,AM_PAY05,AM_PAY06,AM_PAY07,AM_PAY08,AM_PAY09,AM_PAY10, 
        AM_PAY11,AM_PAY12,AM_PAY13,AM_PAY14,AM_PAY15,AM_PAY16,AM_PAY17,AM_PAY18,AM_PAY19,AM_PAY20, 
        AM_PAY21,AM_PAY22,AM_PAY23,AM_PAY24,AM_PAY25,AM_PAY26,AM_PAY27,AM_PAY28,AM_PAY29,AM_PAY30, 
        AM_PAY31,AM_PAY32,AM_PAY33,AM_PAY34,AM_PAY35,AM_PAY36,AM_PAY37,AM_PAY38,AM_PAY39,AM_PAY40, 
        AM_DEDUCT01,AM_DEDUCT02,AM_DEDUCT03,AM_DEDUCT04,AM_DEDUCT05,AM_DEDUCT06,AM_DEDUCT07,AM_DEDUCT08,AM_DEDUCT09,AM_DEDUCT10, 
        AM_DEDUCT11,AM_DEDUCT12,AM_DEDUCT13,AM_DEDUCT14,AM_DEDUCT15,AM_DEDUCT16,AM_DEDUCT17,AM_DEDUCT18,AM_DEDUCT19,AM_DEDUCT20, 
        AM_DEDUCT21,AM_DEDUCT22,AM_DEDUCT23,AM_DEDUCT24,AM_DEDUCT25,AM_DEDUCT26,AM_DEDUCT27,AM_DEDUCT28,AM_DEDUCT29,AM_DEDUCT30, 
        AM_DEDUCT31,AM_DEDUCT32,AM_DEDUCT33,AM_DEDUCT34,AM_DEDUCT35,AM_DEDUCT36,AM_DEDUCT37,AM_DEDUCT38,AM_DEDUCT39,AM_DEDUCT40, 
        AM_INCOMTAX, AM_RESIDTAX, AM_TOTTAX, AM_TOTNOTAX, AM_NOTAX0, AM_NOTAX1, AM_NOTAX2, AM_NOTAX3, AM_NOTAX4,
        AM_NANNU, AM_NINS, AM_NEMPE, AM_NOINS, IN_PAY, DT_PAY, AM_SIN,
        AM_ANNU, AM_INS, AM_INS1, AM_OINS, AM_OINS1,
        AM_EMPE, AM_EMPE1, AM_FIRE, AM_FIRE1,
        
        AM_PAY01_ER, AM_PAY02_ER, AM_PAY03_ER, AM_PAY04_ER, AM_PAY05_ER, AM_PAY06_ER, AM_PAY07_ER, AM_PAY08_ER, AM_PAY09_ER, AM_PAY10_ER,  
        AM_PAY11_ER, AM_PAY12_ER, AM_PAY13_ER, AM_PAY14_ER, AM_PAY15_ER, AM_PAY16_ER, AM_PAY17_ER, AM_PAY18_ER, AM_PAY19_ER, AM_PAY20_ER,  
        AM_PAY21_ER, AM_PAY22_ER, AM_PAY23_ER, AM_PAY24_ER, AM_PAY25_ER, AM_PAY26_ER, AM_PAY27_ER, AM_PAY28_ER, AM_PAY29_ER, AM_PAY30_ER,
        
        CD_JOB_SERIES, AM_NEMPA
    ) 
    SELECT  T.CD_COMPANY,  T.CD_BIZAREA, T.CD_DEPT, T.CD_CC, T.CD_DUTY_RANK, T.CD_DUTY_TYPE, T.CD_DUTY_STEP, T.CD_DUTY_RESP, T.CD_PAY_STEP, T.CD_PJT,
            T.NO_EMP, T.CD_EMP, T.TP_EMP, T.TP_PAY, T.DT_RETIRE, T.DT_START, T.DT_END,
            T.CD_USER1, T.CD_USER2, T.CD_USER3,
            T.AM_PAY01,        T.AM_PAY02,     
            T.AM_PAY03,        T.AM_PAY04,        T.AM_PAY05,        T.AM_PAY06,        T.AM_PAY07,        T.AM_PAY08,     
            T.AM_PAY09,        T.AM_PAY10,        T.AM_PAY11,        T.AM_PAY12,        T.AM_PAY13,        T.AM_PAY14,     
            T.AM_PAY15,        T.AM_PAY16,        T.AM_PAY17,        T.AM_PAY18,        T.AM_PAY19,        T.AM_PAY20,     
            T.AM_PAY21,        T.AM_PAY22,        T.AM_PAY23,        T.AM_PAY24,        T.AM_PAY25,        T.AM_PAY26,     
            T.AM_PAY27,        T.AM_PAY28,        T.AM_PAY29,        T.AM_PAY30,        T.AM_PAY31,        T.AM_PAY32,     
            T.AM_PAY33,        T.AM_PAY34,        T.AM_PAY35,        T.AM_PAY36,        T.AM_PAY37,        T.AM_PAY38,     
            T.AM_PAY39,        T.AM_PAY40,        T.AM_DEDUCT01,        T.AM_DEDUCT02,        T.AM_DEDUCT03,        T.AM_DEDUCT04,     
            T.AM_DEDUCT05,        T.AM_DEDUCT06,        T.AM_DEDUCT07,        T.AM_DEDUCT08,        T.AM_DEDUCT09,        T.AM_DEDUCT10,     
            T.AM_DEDUCT11,        T.AM_DEDUCT12,        T.AM_DEDUCT13,        T.AM_DEDUCT14,        T.AM_DEDUCT15,        T.AM_DEDUCT16,     
            T.AM_DEDUCT17,        T.AM_DEDUCT18,        T.AM_DEDUCT19,        T.AM_DEDUCT20,        T.AM_DEDUCT21,        T.AM_DEDUCT22,     
            T.AM_DEDUCT23,        T.AM_DEDUCT24,        T.AM_DEDUCT25,        T.AM_DEDUCT26,        T.AM_DEDUCT27,        T.AM_DEDUCT28,     
            T.AM_DEDUCT29,        T.AM_DEDUCT30,        T.AM_DEDUCT31,        T.AM_DEDUCT32,        T.AM_DEDUCT33,        T.AM_DEDUCT34,     
            T.AM_DEDUCT35,        T.AM_DEDUCT36,        T.AM_DEDUCT37,        T.AM_DEDUCT38,        T.AM_DEDUCT39,        T.AM_DEDUCT40, 
            T.AM_INCOMTAX, T.AM_RESIDTAX, T.AM_TOTTAX, T.AM_TOTNOTAX, 
 
            CASE WHEN SUBSTRING(@P_YM, 1, 4) >= '2009' THEN T.AM_NOTAX0_2009  
            ELSE T.AM_NOTAX0 END AM_NOTAX0, --신고비과세 
 
            CASE WHEN SUBSTRING(@P_YM, 1, 4) >= '2009' THEN T.AM_NOTAX1_2009 - T.AM_NOTAX
            ELSE T.AM_NOTAX1 END AM_NOTAX1,--미신고비과세 
 
            CASE WHEN SUBSTRING(@P_YM, 1, 4) >= '2009' THEN T.AM_NOTAX
            ELSE T.AM_NOTAX2 END AM_NOTAX2,--사용자부담금 
            T.AM_NOTAX3, T.AM_NOTAX4,
            T.AM_NANNU, T.AM_NINS, T.AM_NEMPE, T.AM_NOINS, '', '', 0,
            T.AM_ANNU, T.AM_INS, T.AM_INS1, T.AM_OINS, T.AM_OINS1,
            T.AM_EMPE, T.AM_EMPE1, T.AM_FIRE, T.AM_FIRE1,
            
            T.AM_PAY01_ER, T.AM_PAY02_ER, T.AM_PAY03_ER, T.AM_PAY04_ER, T.AM_PAY05_ER, T.AM_PAY06_ER, T.AM_PAY07_ER, T.AM_PAY08_ER, T.AM_PAY09_ER, T.AM_PAY10_ER,  
			T.AM_PAY11_ER, T.AM_PAY12_ER, T.AM_PAY13_ER, T.AM_PAY14_ER, T.AM_PAY15_ER, T.AM_PAY16_ER, T.AM_PAY17_ER, T.AM_PAY18_ER, T.AM_PAY19_ER, T.AM_PAY20_ER,  
			T.AM_PAY21_ER, T.AM_PAY22_ER, T.AM_PAY23_ER, T.AM_PAY24_ER, T.AM_PAY25_ER, T.AM_PAY26_ER, T.AM_PAY27_ER, T.AM_PAY28_ER, T.AM_PAY29_ER, T.AM_PAY30_ER,
			T.CD_JOB_SERIES, 0 AS AM_NEMPA
    FROM    ( 
            SELECT  PAY.CD_COMPANY,  PAY.CD_BIZAREA,     
            ISNULL(PAY.CD_DEPT, '') CD_DEPT, 
            ISNULL(PAY.CD_CC, '') CD_CC, 
            ISNULL(PAY.CD_DUTY_RANK, '') CD_DUTY_RANK, 
            ISNULL(PAY.CD_DUTY_TYPE, '') CD_DUTY_TYPE, 
            ISNULL(PAY.CD_DUTY_STEP, '') CD_DUTY_STEP, 
            ISNULL(PAY.CD_DUTY_RESP, '') CD_DUTY_RESP,
            ISNULL(PAY.CD_PAY_STEP, '') CD_PAY_STEP, 
            ISNULL(PAY.CD_PJT, '') CD_PJT,
            ISNULL(E.CD_USER1, '') CD_USER1,
            ISNULL(E.CD_USER2, '') CD_USER2,
            ISNULL(E.CD_USER3, '') CD_USER3,
            PAY.NO_EMP, 
            PAY.CD_EMP, 
            PAY.TP_EMP, 
            PAY.TP_PAY, 
            CASE    WHEN E.DT_RETIRE IS NULL OR RTRIM(LTRIM(E.DT_RETIRE)) = '' OR E.DT_RETIRE = '00000000' THEN '99999999' ELSE E.DT_RETIRE END DT_RETIRE, 
            DT.DT_START, 
            DT.DT_END, 
            SUM(PAY.AM_PAY01) AM_PAY01, SUM(PAY.AM_PAY02) AM_PAY02, SUM(PAY.AM_PAY03) AM_PAY03, SUM(PAY.AM_PAY04) AM_PAY04, SUM(PAY.AM_PAY05) AM_PAY05, 
            SUM(PAY.AM_PAY06) AM_PAY06, SUM(PAY.AM_PAY07) AM_PAY07, SUM(PAY.AM_PAY08) AM_PAY08, SUM(PAY.AM_PAY09) AM_PAY09, SUM(PAY.AM_PAY10) AM_PAY10, 
            SUM(PAY.AM_PAY11) AM_PAY11, SUM(PAY.AM_PAY12) AM_PAY12, SUM(PAY.AM_PAY13) AM_PAY13, SUM(PAY.AM_PAY14) AM_PAY14, SUM(PAY.AM_PAY15) AM_PAY15, 
            SUM(PAY.AM_PAY16) AM_PAY16, SUM(PAY.AM_PAY17) AM_PAY17, SUM(PAY.AM_PAY18) AM_PAY18, SUM(PAY.AM_PAY19) AM_PAY19, SUM(PAY.AM_PAY20) AM_PAY20, 
            SUM(PAY.AM_PAY21) AM_PAY21, SUM(PAY.AM_PAY22) AM_PAY22, SUM(PAY.AM_PAY23) AM_PAY23, SUM(PAY.AM_PAY24) AM_PAY24, SUM(PAY.AM_PAY25) AM_PAY25, 
            SUM(PAY.AM_PAY26) AM_PAY26, SUM(PAY.AM_PAY27) AM_PAY27, SUM(PAY.AM_PAY28) AM_PAY28, SUM(PAY.AM_PAY29) AM_PAY29, SUM(PAY.AM_PAY30) AM_PAY30, 
            SUM(PAY.AM_PAY31) AM_PAY31, SUM(PAY.AM_PAY32) AM_PAY32, SUM(PAY.AM_PAY33) AM_PAY33, SUM(PAY.AM_PAY34) AM_PAY34, SUM(PAY.AM_PAY35) AM_PAY35, 
            SUM(PAY.AM_PAY36) AM_PAY36, SUM(PAY.AM_PAY37) AM_PAY37, SUM(PAY.AM_PAY38) AM_PAY38, SUM(PAY.AM_PAY39) AM_PAY39, SUM(PAY.AM_PAY40) AM_PAY40, 
            SUM(PAY.AM_DEDUCT01) AM_DEDUCT01, SUM(PAY.AM_DEDUCT02) AM_DEDUCT02, SUM(PAY.AM_DEDUCT03) AM_DEDUCT03, SUM(PAY.AM_DEDUCT04) AM_DEDUCT04, SUM(PAY.AM_DEDUCT05) AM_DEDUCT05, 
            SUM(PAY.AM_DEDUCT06) AM_DEDUCT06, SUM(PAY.AM_DEDUCT07) AM_DEDUCT07, SUM(PAY.AM_DEDUCT08) AM_DEDUCT08, SUM(PAY.AM_DEDUCT09) AM_DEDUCT09, SUM(PAY.AM_DEDUCT10) AM_DEDUCT10, 
            SUM(PAY.AM_DEDUCT11) AM_DEDUCT11, SUM(PAY.AM_DEDUCT12) AM_DEDUCT12, SUM(PAY.AM_DEDUCT13) AM_DEDUCT13, SUM(PAY.AM_DEDUCT14) AM_DEDUCT14, SUM(PAY.AM_DEDUCT15) AM_DEDUCT15, 
            SUM(PAY.AM_DEDUCT16) AM_DEDUCT16, SUM(PAY.AM_DEDUCT17) AM_DEDUCT17, SUM(PAY.AM_DEDUCT18) AM_DEDUCT18, SUM(PAY.AM_DEDUCT19) AM_DEDUCT19, SUM(PAY.AM_DEDUCT20) AM_DEDUCT20, 
            SUM(PAY.AM_DEDUCT21) AM_DEDUCT21, SUM(PAY.AM_DEDUCT22) AM_DEDUCT22, SUM(PAY.AM_DEDUCT23) AM_DEDUCT23, SUM(PAY.AM_DEDUCT24) AM_DEDUCT24, SUM(PAY.AM_DEDUCT25) AM_DEDUCT25, 
            SUM(PAY.AM_DEDUCT26) AM_DEDUCT26, SUM(PAY.AM_DEDUCT27) AM_DEDUCT27, SUM(PAY.AM_DEDUCT28) AM_DEDUCT28, SUM(PAY.AM_DEDUCT29) AM_DEDUCT29, SUM(PAY.AM_DEDUCT30) AM_DEDUCT30, 
            SUM(PAY.AM_DEDUCT31) AM_DEDUCT31, SUM(PAY.AM_DEDUCT32) AM_DEDUCT32, SUM(PAY.AM_DEDUCT33) AM_DEDUCT33, SUM(PAY.AM_DEDUCT34) AM_DEDUCT34, SUM(PAY.AM_DEDUCT35) AM_DEDUCT35, 
            SUM(PAY.AM_DEDUCT36) AM_DEDUCT36, SUM(PAY.AM_DEDUCT37) AM_DEDUCT37, SUM(PAY.AM_DEDUCT38) AM_DEDUCT38, SUM(PAY.AM_DEDUCT39) AM_DEDUCT39, SUM(PAY.AM_DEDUCT40) AM_DEDUCT40, 
            SUM(AM_INCOMTAX) AM_INCOMTAX, SUM(AM_RESIDTAX) AM_RESIDTAX,  
            SUM(AM_TOTTAX) + SUM(AM_STOCK) + SUM(AM_RBONUS) + SUM(AM_ETCPAY) AM_TOTTAX, 
            SUM(AM_TOTNOTAX) AM_TOTNOTAX, 
 
            ISNULL(SUM(AM_NOTAX_REP), 0) AM_NOTAX0_2009, 
            SUM(AM_NRND) + SUM(AM_NOFOREIGN) + SUM(AM_NOABROD) + SUM(AM_NOEXT) + SUM(AM_NOETC) - SUM(AM_NEAT) - SUM(AM_NTR) AM_NOTAX0, --신고비과세 
 
            ISNULL(SUM(AM_NOTAX_UNREP), 0) AM_NOTAX1_2009, 
            SUM(AM_NEAT) + SUM(AM_NTR) AM_NOTAX1,--미신고비과세 
            SUM(AM_NANNU) + SUM(AM_NINS) + SUM(AM_NEMPE) + SUM(AM_NEMPS) + SUM(AM_NEMPA) + SUM(AM_NEDU) + SUM(ISNULL(AM_NOINS, 0)) AM_NOTAX2,--사용자부담금  
 
            SUM(AM_NANNU) + SUM(AM_NINS) AM_NOTAX3,  
            SUM(AM_NEMPE) + SUM(AM_NEMPS) + SUM(AM_NEMPA) AM_NOTAX4,
			ISNULL(SUM(N.AM_NOTAX), 0) AM_NOTAX,
			ISNULL(SUM(AM_NANNU), 0) AM_NANNU, 
			ISNULL(SUM(AM_NINS), 0) AM_NINS, 
			ISNULL(SUM(AM_NEMPE), 0) AM_NEMPE, 
			ISNULL(SUM(AM_NOINS), 0) AM_NOINS,
			
			SUM(PAY.AM_ANNU) + SUM(PAY.AM_ANNU1) AM_ANNU,
			SUM(PAY.AM_INS) AM_INS,			
			SUM(PAY.AM_INS1) AM_INS1,
			SUM(PAY.AM_OINS) AM_OINS,			
			0 AM_OINS1, --밑에서 계산식 항목 찾아서 다시 계산..
			
			SUM(ISNULL(PAY.AM_NEMPE, 0)) + SUM(ISNULL(PAY.AM_NEMPA, 0)) AM_EMPE, 
			SUM(PF.AM_FPAY) AM_EMPE1,
			SUM(ISNULL(PAY.AM_FIRE, 0)) AM_FIRE, --밑에서 계산식 단취처리 찾아서 다시 계산
			SUM(PF2.AM_FPAY) AM_FIRE1,
			
			SUM(ER.AM_PAY01) AM_PAY01_ER, 
			SUM(ER.AM_PAY02) AM_PAY02_ER, 
			SUM(ER.AM_PAY03) AM_PAY03_ER, 
			SUM(ER.AM_PAY04) AM_PAY04_ER, 
			SUM(ER.AM_PAY05) AM_PAY05_ER, 
			SUM(ER.AM_PAY06) AM_PAY06_ER, 
			SUM(ER.AM_PAY07) AM_PAY07_ER, 
			SUM(ER.AM_PAY08) AM_PAY08_ER, 
			SUM(ER.AM_PAY09) AM_PAY09_ER, 
			SUM(ER.AM_PAY10) AM_PAY10_ER,
			SUM(ER.AM_PAY11) AM_PAY11_ER, 
			SUM(ER.AM_PAY12) AM_PAY12_ER, 
			SUM(ER.AM_PAY13) AM_PAY13_ER, 
			SUM(ER.AM_PAY14) AM_PAY14_ER, 
			SUM(ER.AM_PAY15) AM_PAY15_ER, 
			SUM(ER.AM_PAY16) AM_PAY16_ER, 
			SUM(ER.AM_PAY17) AM_PAY17_ER, 
			SUM(ER.AM_PAY18) AM_PAY18_ER, 
			SUM(ER.AM_PAY19) AM_PAY19_ER, 
			SUM(ER.AM_PAY20) AM_PAY20_ER,
			SUM(ER.AM_PAY21) AM_PAY21_ER, 
			SUM(ER.AM_PAY22) AM_PAY22_ER, 
			SUM(ER.AM_PAY23) AM_PAY23_ER, 
			SUM(ER.AM_PAY24) AM_PAY24_ER, 
			SUM(ER.AM_PAY25) AM_PAY25_ER, 
			SUM(ER.AM_PAY26) AM_PAY26_ER, 
			SUM(ER.AM_PAY27) AM_PAY27_ER, 
			SUM(ER.AM_PAY28) AM_PAY28_ER, 
			SUM(ER.AM_PAY29) AM_PAY29_ER, 
			SUM(ER.AM_PAY30) AM_PAY30_ER,
			
			ISNULL(PAY.CD_JOB_SERIES, '') CD_JOB_SERIES 
			
        FROM    HR_PCALCPAY PAY 
        INNER JOIN MA_EMP E 
        ON    PAY.CD_COMPANY     = E.CD_COMPANY 
        AND    PAY.NO_EMP         = E.NO_EMP 
        INNER JOIN HR_PTITLE TI  
        ON    PAY.CD_COMPANY    = TI.CD_COMPANY 
        AND    PAY.CD_BIZAREA        = TI.CD_BIZAREA 
        AND    PAY.TP_EMP        = TI.TP_EMP  
        AND    PAY.CD_EMP        = TI.CD_EMP 
        AND    PAY.TP_PAY        = TI.TP_PAY 
        AND    PAY.NO_SEQ        = TI.NO_SEQ 
        AND    PAY.YM            = TI.YM 
        AND    (TI.DT_PAY        = @P_DT_PAY OR @P_DT_PAY = '') 
        INNER JOIN 
            ( 
            SELECT     CD_COMPANY, CD_BIZAREA, CD_EMP, TP_EMP, CD_MONTH, DT_CLOSE,   
                CASE CD_MONTH WHEN '001' THEN                          
                    CONVERT(CHAR(8),DATEADD(MONTH, -1, CONVERT(DATETIME, @P_YM + RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2))),112)     
                ELSE                     
                    @P_YM+RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2) 
                END DT_START,  
                CASE CD_MONTH WHEN '001' THEN                      
                    CONVERT(CHAR(8),DATEADD(DAY, -1, CONVERT(DATETIME, @P_YM+RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2))),112)     
                ELSE                     
                    CONVERT(CHAR(8),DATEADD(DAY,-1,DATEADD(MONTH, 1, CONVERT(DATETIME, @P_YM+RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2)))),112) 
                END DT_END           
            FROM     HR_WCLOSE  
            WHERE    (ISNULL(@P_CD_COMPANY, '' ) = '' OR CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
            AND    TP_CLOSE    = '2' 
            ) DT 
        ON    PAY.CD_COMPANY     = DT.CD_COMPANY 
        AND    PAY.CD_BIZAREA     = DT.CD_BIZAREA 
        AND    PAY.CD_EMP         = DT.CD_EMP 
        AND    PAY.TP_EMP         = DT.TP_EMP 
		LEFT OUTER JOIN ( 
						SELECT   N.CD_COMPANY, N.NO_EMP, N.TP_PAY, N.NO_SEQ, SUM(N.AM_NOTAX) AM_NOTAX
						FROM    HR_PCALCPAY_N N
						INNER JOIN    (
									SELECT    DISTINCT CD_COMPANY, CD_BIZAREA, NO_EMP, NO_SEQ, CD_EMP, TP_EMP, TP_PAY
									FROM    HR_PCALCPAY 
									WHERE    (ISNULL(@P_CD_COMPANY, '') = '' OR CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
									AND YM = @P_YM AND (TP_PAY = @P_TP_PAY OR @P_TP_PAY = '') 
									AND        (CD_EMP        = @P_CD_EMP OR @P_CD_EMP = '')     
									AND        (TP_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_TP_EMP)) OR @P_MULTI_TP_EMP = '')
									AND        (NO_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT2(@P_MULTI_EMP)) OR CONVERT(VARCHAR, @P_MULTI_EMP) = '')  
									) P
						ON      N.CD_COMPANY = P.CD_COMPANY AND  N.NO_EMP = P.NO_EMP AND N.NO_SEQ = P.NO_SEQ AND N.TP_PAY = P.TP_PAY
						INNER JOIN HR_PTITLE TI  
						ON       P.CD_COMPANY = TI.CD_COMPANY AND P.CD_BIZAREA = TI.CD_BIZAREA 
						AND        P.TP_EMP = TI.TP_EMP AND P.CD_EMP = TI.CD_EMP AND N.TP_PAY = TI.TP_PAY AND N.NO_SEQ = TI.NO_SEQ 
						AND        N.YM = TI.YM AND (TI.DT_PAY = @P_DT_PAY OR @P_DT_PAY = '') 
						WHERE    (ISNULL(@P_CD_COMPANY, '') = '' OR N.CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
						AND N.YM = @P_YM 
						AND        (@P_TP_PAY IS NULL OR @P_TP_PAY = '' OR N.TP_PAY = @P_TP_PAY) AND N.CD_NOTAX = 'N01' 
						GROUP BY N.CD_COMPANY, N.NO_EMP, N.TP_PAY, N.NO_SEQ
						) N 
        ON   PAY.CD_COMPANY = N.CD_COMPANY AND  PAY.NO_EMP = N.NO_EMP AND PAY.TP_PAY = N.TP_PAY AND PAY.NO_SEQ = N.NO_SEQ
        LEFT OUTER JOIN HR_PFLUCT PF ON PAY.CD_COMPANY = PF.CD_COMPANY AND PAY.YM = PF.YM AND PAY.NO_SEQ = PF.NO_SEQ AND PAY.NO_EMP = PF.NO_EMP AND PF.CD_FLUCT = 'ER1'
        LEFT OUTER JOIN HR_PFLUCT PF2 ON PAY.CD_COMPANY = PF2.CD_COMPANY AND PAY.YM = PF2.YM AND PAY.NO_SEQ = PF2.NO_SEQ AND PAY.NO_EMP = PF2.NO_EMP AND PF2.CD_FLUCT = 'ER2'        
        LEFT OUTER JOIN HR_Z_TMFK_ERINS ER ON PAY.CD_COMPANY = ER.CD_COMPANY AND PAY.NO_EMP = ER.NO_EMP AND PAY.YM = ER.YM AND PAY.NO_SEQ = ER.NO_SEQ AND PAY.TP_PAY = ER.TP_PAY        
        WHERE	(ISNULL(@P_CD_COMPANY, '') = '' OR PAY.CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
        AND		(PAY.CD_BIZAREA IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_BIZAREA)) OR @P_MULTI_BIZAREA = '')  
        AND		(PAY.CD_DEPT IN (SELECT CD_STR FROM GETTABLEFROMSPLIT2(@P_MULTI_DEPT)) OR CONVERT(VARCHAR, @P_MULTI_DEPT) = '' OR @P_MULTI_DEPT IS NULL)  
        AND		(PAY.NO_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT2(@P_MULTI_EMP)) OR CONVERT(VARCHAR, @P_MULTI_EMP) = '')  
        AND		PAY.YM            = @P_YM      
        AND		(PAY.CD_EMP        = @P_CD_EMP OR @P_CD_EMP = '')     
        AND		(PAY.TP_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_TP_EMP)) OR @P_MULTI_TP_EMP = '')      
        AND		(PAY.TP_PAY        = @P_TP_PAY OR @P_TP_PAY = '') 
        --순번 추가
        AND		PAY.NO_SEQ = CASE WHEN @P_NO_SEQ > 0 THEN @P_NO_SEQ ELSE PAY.NO_SEQ END
        AND		(PAY.CD_LTAX_AREA IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_LTAX_AREA)) OR @P_MULTI_LTAX_AREA = '' OR @P_MULTI_LTAX_AREA IS NULL) 
        GROUP BY PAY.CD_COMPANY, PAY.CD_BIZAREA, ISNULL(PAY.CD_DEPT, ''), PAY.YM, ISNULL(PAY.CD_CC, ''), ISNULL(PAY.CD_DUTY_RANK, ''), ISNULL(PAY.CD_DUTY_TYPE, ''), ISNULL(PAY.CD_DUTY_STEP, ''), ISNULL(PAY.CD_DUTY_RESP, ''), ISNULL(PAY.CD_PAY_STEP, ''), ISNULL(PAY.CD_PJT, ''), E.CD_USER1, E.CD_USER2, E.CD_USER3, PAY.NO_EMP, PAY.CD_EMP, PAY.TP_EMP, PAY.TP_PAY, E.DT_RETIRE, DT.DT_START, DT.DT_END, ISNULL(PAY.CD_JOB_SERIES, '')
        --ORDER BY PAY.CD_BIZAREA ASC, PAY.CD_DEPT ASC, PAY.CD_DUTY_RANK ASC, PAY.NO_EMP ASC 
        ) T         
        
        SELECT	IDENTITY(INT, 1, 1) ID,
				사번 NO_EMP, 
				고용형태 CD_EMP, 
				사원구분 TP_EMP,
				급여구분 TP_PAY
		INTO	#TEMP
        FROM	#PAY_TABLE_TMFK
        GROUP BY 사번, 고용형태, 사원구분, 급여구분
        SET @V_ROWCOUNT = @@ROWCOUNT
        
        SET @V_ID = 0
	
		-- 지급항목 LOOP
		WHILE( @V_ID < @V_ROWCOUNT )
		BEGIN
			SET		@V_ID = @V_ID + 1
			SELECT	@V_NO_EMP = NO_EMP,
					@V_CD_EMP = CD_EMP,
					@V_TP_EMP = TP_EMP,
					@V_TP_PAY = TP_PAY
			FROM	#TEMP
			WHERE	ID = @V_ID        
        
			SELECT	@V_MAXYM = MAX(YM)  
			FROM	HR_PCALCHEAD  
			WHERE	CD_COMPANY = @V_CD_COMPANY AND CD_EMP = @V_CD_EMP AND TP_EMP = @V_TP_EMP AND TP_PAY = @V_TP_PAY AND YM <= @P_YM  

			--노인장기요양보험정산 계산식
			SELECT	@V_CD_CPAYDEDUCT = H.CD_CPAYDEDUCT --H.TP_PAYDEDUCT, H.CD_CPAYDEDUCT, H.TP_TAX, H.TP_BACKPAY, H.TP_DEDUCT, H.TP_UTAX, H.TP_GROSSUP, H.YN_CHECK
			FROM	HR_PCALCHEAD H  
			WHERE	H.CD_COMPANY = @V_CD_COMPANY
			AND		H.YM = @V_MAXYM AND H.CD_EMP = @V_CD_EMP AND H.TP_EMP = @V_TP_EMP AND H.TP_PAY = @V_TP_PAY  
			AND		H.YN_CHECK	= 'Y'
			AND		TP_PAYDEDUCT = '002'
			AND		TP_DEDUCT = '021'
						
			SET @V_QUERY = 'UPDATE	#PAY_TABLE_TMFK
							SET		AM_OINS1 = AM_DEDUCT'+ SUBSTRING(@V_CD_CPAYDEDUCT, 2,2) + '
							WHERE	회사코드 = ''' + @V_CD_COMPANY + '''				
							AND		고용형태 = ''' + @V_CD_EMP + '''
							AND		사원구분 = ''' + @V_TP_EMP + '''
							AND		급여구분 = ''' + @V_TP_PAY + '''
							AND		사번 = ''' + @V_NO_EMP + '''
							'
			EXEC (@V_QUERY)  
		END
		
		INSERT INTO @P_DTEMP
		SELECT * FROM #PAY_TABLE_TMFK							
  END
 ELSE
 BEGIN
	IF @P_TP_SUM = '024'
	BEGIN
		INSERT INTO @P_DTEMP 
		( 
			회사코드,
			사업장코드, 
			부서코드, 
			CC, 
			직위코드, 
			직군코드, 
			직급코드, 
			직책코드, 
			호봉코드, 
			프로젝트코드,
			사번, 
			고용형태, 
			사원구분, 
			급여구분, 
			퇴사일자, 
			급여시작일, 
			급여종료일, 
			사용자정의1,
			사용자정의2,
			사용자정의3,
			AM_PAY01,AM_PAY02,AM_PAY03,AM_PAY04,AM_PAY05,AM_PAY06,AM_PAY07,AM_PAY08,AM_PAY09,AM_PAY10, 
			AM_PAY11,AM_PAY12,AM_PAY13,AM_PAY14,AM_PAY15,AM_PAY16,AM_PAY17,AM_PAY18,AM_PAY19,AM_PAY20, 
			AM_PAY21,AM_PAY22,AM_PAY23,AM_PAY24,AM_PAY25,AM_PAY26,AM_PAY27,AM_PAY28,AM_PAY29,AM_PAY30, 
			AM_PAY31,AM_PAY32,AM_PAY33,AM_PAY34,AM_PAY35,AM_PAY36,AM_PAY37,AM_PAY38,AM_PAY39,AM_PAY40, 
			AM_DEDUCT01,AM_DEDUCT02,AM_DEDUCT03,AM_DEDUCT04,AM_DEDUCT05,AM_DEDUCT06,AM_DEDUCT07,AM_DEDUCT08,AM_DEDUCT09,AM_DEDUCT10, 
			AM_DEDUCT11,AM_DEDUCT12,AM_DEDUCT13,AM_DEDUCT14,AM_DEDUCT15,AM_DEDUCT16,AM_DEDUCT17,AM_DEDUCT18,AM_DEDUCT19,AM_DEDUCT20, 
			AM_DEDUCT21,AM_DEDUCT22,AM_DEDUCT23,AM_DEDUCT24,AM_DEDUCT25,AM_DEDUCT26,AM_DEDUCT27,AM_DEDUCT28,AM_DEDUCT29,AM_DEDUCT30, 
			AM_DEDUCT31,AM_DEDUCT32,AM_DEDUCT33,AM_DEDUCT34,AM_DEDUCT35,AM_DEDUCT36,AM_DEDUCT37,AM_DEDUCT38,AM_DEDUCT39,AM_DEDUCT40, 
			AM_INCOMTAX, AM_RESIDTAX, AM_TOTTAX, AM_TOTNOTAX, AM_NOTAX0, AM_NOTAX1, AM_NOTAX2, AM_NOTAX3, AM_NOTAX4,
			AM_NANNU, AM_NINS, AM_NEMPE, AM_NOINS, CD_JOB_SERIES, AM_NEMPA, AM_FIRE
		) 
		SELECT  T.CD_COMPANY,  T.CD_BIZAREA, T.CD_DEPT, T.CD_CC, T.CD_DUTY_RANK, T.CD_DUTY_TYPE, T.CD_DUTY_STEP, T.CD_DUTY_RESP, T.CD_PAY_STEP, T.CD_PJT,
				T.NO_EMP, T.CD_EMP, T.TP_EMP, T.TP_PAY, T.DT_RETIRE, T.DT_START, T.DT_END,
				T.CD_USER1, T.CD_USER2, T.CD_USER3,
				T.AM_PAY01,        T.AM_PAY02,     
				T.AM_PAY03,        T.AM_PAY04,        T.AM_PAY05,        T.AM_PAY06,        T.AM_PAY07,        T.AM_PAY08,     
				T.AM_PAY09,        T.AM_PAY10,        T.AM_PAY11,        T.AM_PAY12,        T.AM_PAY13,        T.AM_PAY14,     
				T.AM_PAY15,        T.AM_PAY16,        T.AM_PAY17,        T.AM_PAY18,        T.AM_PAY19,        T.AM_PAY20,     
				T.AM_PAY21,        T.AM_PAY22,        T.AM_PAY23,        T.AM_PAY24,        T.AM_PAY25,        T.AM_PAY26,     
				T.AM_PAY27,        T.AM_PAY28,        T.AM_PAY29,        T.AM_PAY30,        T.AM_PAY31,        T.AM_PAY32,     
				T.AM_PAY33,        T.AM_PAY34,        T.AM_PAY35,        T.AM_PAY36,        T.AM_PAY37,        T.AM_PAY38,     
				T.AM_PAY39,        T.AM_PAY40,        T.AM_DEDUCT01,        T.AM_DEDUCT02,        T.AM_DEDUCT03,        T.AM_DEDUCT04,     
				T.AM_DEDUCT05,        T.AM_DEDUCT06,        T.AM_DEDUCT07,        T.AM_DEDUCT08,        T.AM_DEDUCT09,        T.AM_DEDUCT10,     
				T.AM_DEDUCT11,        T.AM_DEDUCT12,        T.AM_DEDUCT13,        T.AM_DEDUCT14,        T.AM_DEDUCT15,        T.AM_DEDUCT16,     
				T.AM_DEDUCT17,        T.AM_DEDUCT18,        T.AM_DEDUCT19,        T.AM_DEDUCT20,        T.AM_DEDUCT21,        T.AM_DEDUCT22,     
				T.AM_DEDUCT23,        T.AM_DEDUCT24,        T.AM_DEDUCT25,        T.AM_DEDUCT26,        T.AM_DEDUCT27,        T.AM_DEDUCT28,     
				T.AM_DEDUCT29,        T.AM_DEDUCT30,        T.AM_DEDUCT31,        T.AM_DEDUCT32,        T.AM_DEDUCT33,        T.AM_DEDUCT34,     
				T.AM_DEDUCT35,        T.AM_DEDUCT36,        T.AM_DEDUCT37,        T.AM_DEDUCT38,        T.AM_DEDUCT39,        T.AM_DEDUCT40, 
				T.AM_INCOMTAX, T.AM_RESIDTAX, T.AM_TOTTAX, T.AM_TOTNOTAX, 
	 
				CASE WHEN SUBSTRING(@P_YM, 1, 4) >= '2009' THEN T.AM_NOTAX0_2009  
				ELSE T.AM_NOTAX0 END AM_NOTAX0, --신고비과세 
	 
				CASE WHEN SUBSTRING(@P_YM, 1, 4) >= '2009' THEN T.AM_NOTAX1_2009 --- T.AM_NOTAX
				ELSE T.AM_NOTAX1 END AM_NOTAX1,--미신고비과세 
	 
				CASE WHEN SUBSTRING(@P_YM, 1, 4) >= '2009' THEN 0--T.AM_NOTAX
				ELSE T.AM_NOTAX2 END AM_NOTAX2,--사용자부담금 
				T.AM_NOTAX3, T.AM_NOTAX4,
				T.AM_NANNU, T.AM_NINS, T.AM_NEMPE, T.AM_NOINS, T.CD_JOB_SERIES, T.AM_NEMPA, T.AM_FIRE
		FROM    ( 
				SELECT  PAY.CD_COMPANY,  PAY.CD_BIZAREA,     
				ISNULL(PAY.CD_DEPT, '') CD_DEPT, 
				ISNULL(PAY.CD_CC, '') CD_CC, 
				ISNULL(PAY.CD_DUTY_RANK, '') CD_DUTY_RANK, 
				ISNULL(PAY.CD_DUTY_TYPE, '') CD_DUTY_TYPE, 
				ISNULL(PAY.CD_DUTY_STEP, '') CD_DUTY_STEP, 
				ISNULL(PAY.CD_DUTY_RESP, '') CD_DUTY_RESP,
				ISNULL(PAY.CD_PAY_STEP, '') CD_PAY_STEP, 
				ISNULL(PAY.CD_PJT, '') CD_PJT,
				ISNULL(E.CD_USER1, '') CD_USER1,
				ISNULL(E.CD_USER2, '') CD_USER2,
				ISNULL(E.CD_USER3, '') CD_USER3,
				PAY.NO_EMP, 
				PAY.CD_EMP, 
				PAY.TP_EMP, 
				PAY.TP_PAY, 
				CASE    WHEN E.DT_RETIRE IS NULL OR RTRIM(LTRIM(E.DT_RETIRE)) = '' OR E.DT_RETIRE = '00000000' THEN '99999999' ELSE E.DT_RETIRE END DT_RETIRE, 
				DT.DT_START, 
				DT.DT_END, 
				SUM(AM_PAY01) AM_PAY01, SUM(AM_PAY02) AM_PAY02, SUM(AM_PAY03) AM_PAY03, SUM(AM_PAY04) AM_PAY04, SUM(AM_PAY05) AM_PAY05, 
				SUM(AM_PAY06) AM_PAY06, SUM(AM_PAY07) AM_PAY07, SUM(AM_PAY08) AM_PAY08, SUM(AM_PAY09) AM_PAY09, SUM(AM_PAY10) AM_PAY10, 
				SUM(AM_PAY11) AM_PAY11, SUM(AM_PAY12) AM_PAY12, SUM(AM_PAY13) AM_PAY13, SUM(AM_PAY14) AM_PAY14, SUM(AM_PAY15) AM_PAY15, 
				SUM(AM_PAY16) AM_PAY16, SUM(AM_PAY17) AM_PAY17, SUM(AM_PAY18) AM_PAY18, SUM(AM_PAY19) AM_PAY19, SUM(AM_PAY20) AM_PAY20, 
				SUM(AM_PAY21) AM_PAY21, SUM(AM_PAY22) AM_PAY22, SUM(AM_PAY23) AM_PAY23, SUM(AM_PAY24) AM_PAY24, SUM(AM_PAY25) AM_PAY25, 
				SUM(AM_PAY26) AM_PAY26, SUM(AM_PAY27) AM_PAY27, SUM(AM_PAY28) AM_PAY28, SUM(AM_PAY29) AM_PAY29, SUM(AM_PAY30) AM_PAY30, 
				SUM(AM_PAY31) AM_PAY31, SUM(AM_PAY32) AM_PAY32, SUM(AM_PAY33) AM_PAY33, SUM(AM_PAY34) AM_PAY34, SUM(AM_PAY35) AM_PAY35, 
				SUM(AM_PAY36) AM_PAY36, SUM(AM_PAY37) AM_PAY37, SUM(AM_PAY38) AM_PAY38, SUM(AM_PAY39) AM_PAY39, SUM(AM_PAY40) AM_PAY40, 
				SUM(AM_DEDUCT01) AM_DEDUCT01, SUM(AM_DEDUCT02) AM_DEDUCT02, SUM(AM_DEDUCT03) AM_DEDUCT03, SUM(AM_DEDUCT04) AM_DEDUCT04, SUM(AM_DEDUCT05) AM_DEDUCT05, 
				SUM(AM_DEDUCT06) AM_DEDUCT06, SUM(AM_DEDUCT07) AM_DEDUCT07, SUM(AM_DEDUCT08) AM_DEDUCT08, SUM(AM_DEDUCT09) AM_DEDUCT09, SUM(AM_DEDUCT10) AM_DEDUCT10, 
				SUM(AM_DEDUCT11) AM_DEDUCT11, SUM(AM_DEDUCT12) AM_DEDUCT12, SUM(AM_DEDUCT13) AM_DEDUCT13, SUM(AM_DEDUCT14) AM_DEDUCT14, SUM(AM_DEDUCT15) AM_DEDUCT15, 
				SUM(AM_DEDUCT16) AM_DEDUCT16, SUM(AM_DEDUCT17) AM_DEDUCT17, SUM(AM_DEDUCT18) AM_DEDUCT18, SUM(AM_DEDUCT19) AM_DEDUCT19, SUM(AM_DEDUCT20) AM_DEDUCT20, 
				SUM(AM_DEDUCT21) AM_DEDUCT21, SUM(AM_DEDUCT22) AM_DEDUCT22, SUM(AM_DEDUCT23) AM_DEDUCT23, SUM(AM_DEDUCT24) AM_DEDUCT24, SUM(AM_DEDUCT25) AM_DEDUCT25, 
				SUM(AM_DEDUCT26) AM_DEDUCT26, SUM(AM_DEDUCT27) AM_DEDUCT27, SUM(AM_DEDUCT28) AM_DEDUCT28, SUM(AM_DEDUCT29) AM_DEDUCT29, SUM(AM_DEDUCT30) AM_DEDUCT30, 
				SUM(AM_DEDUCT31) AM_DEDUCT31, SUM(AM_DEDUCT32) AM_DEDUCT32, SUM(AM_DEDUCT33) AM_DEDUCT33, SUM(AM_DEDUCT34) AM_DEDUCT34, SUM(AM_DEDUCT35) AM_DEDUCT35, 
				SUM(AM_DEDUCT36) AM_DEDUCT36, SUM(AM_DEDUCT37) AM_DEDUCT37, SUM(AM_DEDUCT38) AM_DEDUCT38, SUM(AM_DEDUCT39) AM_DEDUCT39, SUM(AM_DEDUCT40) AM_DEDUCT40, 
				SUM(AM_INCOMTAX) AM_INCOMTAX, SUM(AM_RESIDTAX) AM_RESIDTAX,  
				--SUM(AM_TOTTAX) + SUM(AM_STOCK) + SUM(AM_RBONUS) + SUM(AM_ETCPAY) AM_TOTTAX, 
				0 AM_TOTTAX,
				
				SUM(AM_TOTNOTAX) AM_TOTNOTAX, 
	 
				ISNULL(SUM(AM_NOTAX_REP), 0) AM_NOTAX0_2009, 
				--SUM(AM_NRND) + SUM(AM_NOFOREIGN) + SUM(AM_NOABROD) + SUM(AM_NOEXT) + SUM(AM_NOETC) - SUM(AM_NEAT) - SUM(AM_NTR) AM_NOTAX0, --신고비과세 
				0 AM_NOTAX0,
	 
				ISNULL(SUM(AM_NOTAX_UNREP), 0) AM_NOTAX1_2009, 
				--SUM(AM_NEAT) + SUM(AM_NTR) AM_NOTAX1,--미신고비과세 
				0 AM_NOTAX1,
				--SUM(AM_NANNU) + SUM(AM_NINS) + SUM(AM_NEMPE) + SUM(AM_NEMPS) + SUM(AM_NEMPA) + SUM(AM_NEDU) + SUM(ISNULL(AM_NOINS, 0)) AM_NOTAX2,--사용자부담금 	 
				0 AM_NOTAX2,
	 
				SUM(AM_NANNU) + SUM(AM_NINS) AM_NOTAX3,  
				SUM(AM_NEMPE) + SUM(AM_NEMPS) + SUM(AM_NEMPA) AM_NOTAX4,
				0 AM_NOTAX,--ISNULL(SUM(AM_NOTAX), 0) AM_NOTAX,
				ISNULL(SUM(AM_NANNU), 0) AM_NANNU, 
				ISNULL(SUM(AM_NINS), 0) AM_NINS, 
				ISNULL(SUM(AM_NEMPE), 0) AM_NEMPE, 
				ISNULL(SUM(AM_NOINS), 0) AM_NOINS,
				ISNULL(PAY.CD_JOB_SERIES, '') CD_JOB_SERIES,
				ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE
			FROM    (
						SELECT	PD.CD_COMPANY, PD.CD_BIZAREA, PD.YM, PD.CD_EMP, PD.TP_EMP, PD.TP_PAY, PD.NO_EMP, PD.CD_DEPT, PD.CD_DUTY_RANK, PD.CD_DUTY_TYPE, 
								ISNULL(PD.CD_DUTY_STEP, E.CD_DUTY_STEP) CD_DUTY_STEP, ISNULL(PD.CD_PAY_STEP, E.CD_PAY_STEP) CD_PAY_STEP,
								PD.CD_CC, PD.CD_DUTY_RESP, PD.CD_PJT,
								
								SUM(AM_PAY01) AM_PAY01, SUM(AM_PAY02) AM_PAY02, SUM(AM_PAY03) AM_PAY03, SUM(AM_PAY04) AM_PAY04, SUM(AM_PAY05) AM_PAY05, 
								SUM(AM_PAY06) AM_PAY06, SUM(AM_PAY07) AM_PAY07, SUM(AM_PAY08) AM_PAY08, SUM(AM_PAY09) AM_PAY09, SUM(AM_PAY10) AM_PAY10, 
								SUM(AM_PAY11) AM_PAY11, SUM(AM_PAY12) AM_PAY12, SUM(AM_PAY13) AM_PAY13, SUM(AM_PAY14) AM_PAY14, SUM(AM_PAY15) AM_PAY15, 
								SUM(AM_PAY16) AM_PAY16, SUM(AM_PAY17) AM_PAY17, SUM(AM_PAY18) AM_PAY18, SUM(AM_PAY19) AM_PAY19, SUM(AM_PAY20) AM_PAY20, 
								SUM(AM_PAY21) AM_PAY21, SUM(AM_PAY22) AM_PAY22, SUM(AM_PAY23) AM_PAY23, SUM(AM_PAY24) AM_PAY24, SUM(AM_PAY25) AM_PAY25, 
								SUM(AM_PAY26) AM_PAY26, SUM(AM_PAY27) AM_PAY27, SUM(AM_PAY28) AM_PAY28, SUM(AM_PAY29) AM_PAY29, SUM(AM_PAY30) AM_PAY30, 
								SUM(AM_PAY31) AM_PAY31, SUM(AM_PAY32) AM_PAY32, SUM(AM_PAY33) AM_PAY33, SUM(AM_PAY34) AM_PAY34, SUM(AM_PAY35) AM_PAY35, 
								SUM(AM_PAY36) AM_PAY36, SUM(AM_PAY37) AM_PAY37, SUM(AM_PAY38) AM_PAY38, SUM(AM_PAY39) AM_PAY39, SUM(AM_PAY40) AM_PAY40, 
								SUM(AM_DEDUCT01) AM_DEDUCT01, SUM(AM_DEDUCT02) AM_DEDUCT02, SUM(AM_DEDUCT03) AM_DEDUCT03, SUM(AM_DEDUCT04) AM_DEDUCT04, SUM(AM_DEDUCT05) AM_DEDUCT05, 
								SUM(AM_DEDUCT06) AM_DEDUCT06, SUM(AM_DEDUCT07) AM_DEDUCT07, SUM(AM_DEDUCT08) AM_DEDUCT08, SUM(AM_DEDUCT09) AM_DEDUCT09, SUM(AM_DEDUCT10) AM_DEDUCT10, 
								SUM(AM_DEDUCT11) AM_DEDUCT11, SUM(AM_DEDUCT12) AM_DEDUCT12, SUM(AM_DEDUCT13) AM_DEDUCT13, SUM(AM_DEDUCT14) AM_DEDUCT14, SUM(AM_DEDUCT15) AM_DEDUCT15, 
								SUM(AM_DEDUCT16) AM_DEDUCT16, SUM(AM_DEDUCT17) AM_DEDUCT17, SUM(AM_DEDUCT18) AM_DEDUCT18, SUM(AM_DEDUCT19) AM_DEDUCT19, SUM(AM_DEDUCT20) AM_DEDUCT20, 
								SUM(AM_DEDUCT21) AM_DEDUCT21, SUM(AM_DEDUCT22) AM_DEDUCT22, SUM(AM_DEDUCT23) AM_DEDUCT23, SUM(AM_DEDUCT24) AM_DEDUCT24, SUM(AM_DEDUCT25) AM_DEDUCT25, 
								SUM(AM_DEDUCT26) AM_DEDUCT26, SUM(AM_DEDUCT27) AM_DEDUCT27, SUM(AM_DEDUCT28) AM_DEDUCT28, SUM(AM_DEDUCT29) AM_DEDUCT29, SUM(AM_DEDUCT30) AM_DEDUCT30, 
								SUM(AM_DEDUCT31) AM_DEDUCT31, SUM(AM_DEDUCT32) AM_DEDUCT32, SUM(AM_DEDUCT33) AM_DEDUCT33, SUM(AM_DEDUCT34) AM_DEDUCT34, SUM(AM_DEDUCT35) AM_DEDUCT35, 
								SUM(AM_DEDUCT36) AM_DEDUCT36, SUM(AM_DEDUCT37) AM_DEDUCT37, SUM(AM_DEDUCT38) AM_DEDUCT38, SUM(AM_DEDUCT39) AM_DEDUCT39, SUM(AM_DEDUCT40) AM_DEDUCT40, 
								SUM(AM_INCOMTAX) AM_INCOMTAX, SUM(AM_RESIDTAX) AM_RESIDTAX,  
								SUM(AM_TOTTAX) + SUM(AM_STOCK) + SUM(AM_RBONUS) + SUM(AM_ETCPAY) AM_TOTTAX, 
								SUM(AM_TOTNOTAX) AM_TOTNOTAX,
								
								SUM(AM_STOCK) AM_STOCK, SUM(AM_RBONUS) AM_RBONUS, SUM(AM_ETCPAY) AM_ETCPAY,
								
								SUM(AM_NOTAX_REP) AM_NOTAX_REP,
								SUM(AM_NRND) AM_NRND, SUM(AM_NOFOREIGN) AM_NOFOREIGN, SUM(AM_NOABROD) AM_NOABROD,
								SUM(AM_NOEXT) AM_NOEXT, SUM(AM_NOETC) AM_NOETC, SUM(AM_NTR) AM_NTR, 
					 
								ISNULL(SUM(AM_NOTAX_UNREP), 0) AM_NOTAX_UNREP, 
								SUM(AM_NEAT) AM_NEAT, 
								SUM(AM_NANNU) AM_NANNU, SUM(AM_NINS) AM_NINS, SUM(AM_NEMPE) AM_NEMPE,
								SUM(AM_NEMPS) AM_NEMPS, SUM(AM_NEMPA) AM_NEMPA, SUM(AM_NEDU) AM_NEDU, SUM(ISNULL(AM_NOINS, 0)) AM_NOINS,
					 			ISNULL(PD.CD_JOB_SERIES, E.CD_JOB_SERIES) CD_JOB_SERIES, SUM(PD.AM_FIRE) AM_FIRE	
						FROM	HR_PDCALCPAY PD
						LEFT OUTER JOIN MA_EMP E ON PD.CD_COMPANY = E.CD_COMPANY AND PD.NO_EMP = E.NO_EMP
						WHERE	(ISNULL(@P_CD_COMPANY, '') ='' OR PD.CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
						AND		YM = @P_YM
						GROUP BY PD.CD_COMPANY, PD.CD_BIZAREA, PD.YM, PD.CD_EMP, PD.TP_EMP, PD.TP_PAY, PD.NO_EMP, PD.CD_DEPT, PD.CD_DUTY_RANK, PD.CD_DUTY_TYPE, 
								 ISNULL(PD.CD_DUTY_STEP, E.CD_DUTY_STEP), ISNULL(PD.CD_PAY_STEP, E.CD_PAY_STEP),
								 PD.CD_CC, PD.CD_DUTY_RESP, PD.CD_PJT, ISNULL(PD.CD_JOB_SERIES, E.CD_JOB_SERIES)
					) PAY
			INNER JOIN MA_EMP AS E 
			ON    PAY.CD_COMPANY = E.CD_COMPANY AND PAY.NO_EMP = E.NO_EMP 
			INNER JOIN 
				( 
				SELECT     CD_COMPANY, CD_BIZAREA, CD_EMP, TP_EMP, CD_MONTH, DT_CLOSE,   
					CASE CD_MONTH WHEN '001' THEN                          
						CONVERT(CHAR(8),DATEADD(MONTH, -1, CONVERT(DATETIME, @P_YM + RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2))),112)     
					ELSE                     
						@P_YM+RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2) 
					END DT_START,  
					CASE CD_MONTH WHEN '001' THEN                      
						CONVERT(CHAR(8),DATEADD(DAY, -1, CONVERT(DATETIME, @P_YM+RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2))),112)     
					ELSE                     
						CONVERT(CHAR(8),DATEADD(DAY,-1,DATEADD(MONTH, 1, CONVERT(DATETIME, @P_YM+RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2)))),112) 
					END DT_END           
				FROM     HR_WCLOSE  
				WHERE    (ISNULL(@P_CD_COMPANY, '' ) = '' OR CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
				AND    TP_CLOSE    = '2' 
				) AS DT 
			ON    PAY.CD_COMPANY     = DT.CD_COMPANY 
			AND    PAY.CD_BIZAREA     = DT.CD_BIZAREA 
			AND    PAY.CD_EMP         = DT.CD_EMP 
			AND    PAY.TP_EMP         = DT.TP_EMP 
			WHERE	(ISNULL(@P_CD_COMPANY, '') = '' OR PAY.CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
			AND		(PAY.CD_BIZAREA IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_BIZAREA)) OR @P_MULTI_BIZAREA = '')  
			AND		(PAY.CD_DEPT IN (SELECT CD_STR FROM GETTABLEFROMSPLIT2(@P_MULTI_DEPT)) OR CONVERT(VARCHAR, @P_MULTI_DEPT) = '' OR @P_MULTI_DEPT IS NULL)  
			AND		(PAY.NO_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT2(@P_MULTI_EMP)) OR CONVERT(VARCHAR, @P_MULTI_EMP) = '')  
			AND		PAY.YM            = @P_YM      
			AND		(PAY.CD_EMP        = @P_CD_EMP OR @P_CD_EMP = '')     
			AND		(PAY.TP_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_TP_EMP)) OR @P_MULTI_TP_EMP = '')      
			AND		(PAY.TP_PAY        = @P_TP_PAY OR @P_TP_PAY = '') 
			
			GROUP BY PAY.CD_COMPANY, PAY.CD_BIZAREA, ISNULL(PAY.CD_DEPT, ''), PAY.YM, ISNULL(PAY.CD_CC, ''), ISNULL(PAY.CD_DUTY_RANK, ''), ISNULL(PAY.CD_DUTY_TYPE, ''), ISNULL(PAY.CD_DUTY_STEP, ''), ISNULL(PAY.CD_DUTY_RESP, ''), ISNULL(PAY.CD_PAY_STEP, ''), ISNULL(PAY.CD_PJT, ''), E.CD_USER1, E.CD_USER2, E.CD_USER3, PAY.NO_EMP, PAY.CD_EMP, PAY.TP_EMP, PAY.TP_PAY, E.DT_RETIRE, DT.DT_START, DT.DT_END, ISNULL(PAY.CD_JOB_SERIES, '')
			--ORDER BY PAY.CD_BIZAREA ASC, PAY.CD_DEPT ASC, PAY.CD_DUTY_RANK ASC, PAY.NO_EMP ASC 
			) T	
	END
	ELSE
	BEGIN  
		INSERT INTO @P_DTEMP 
		( 
			회사코드,
			사업장코드, 
			부서코드, 
			CC, 
			직위코드, 
			직군코드, 
			직급코드, 
			직책코드, 
			호봉코드, 
			프로젝트코드,
			사번, 
			고용형태, 
			사원구분, 
			급여구분, 
			퇴사일자, 
			급여시작일, 
			급여종료일, 
			사용자정의1,
			사용자정의2,
			사용자정의3,
			AM_PAY01,AM_PAY02,AM_PAY03,AM_PAY04,AM_PAY05,AM_PAY06,AM_PAY07,AM_PAY08,AM_PAY09,AM_PAY10, 
			AM_PAY11,AM_PAY12,AM_PAY13,AM_PAY14,AM_PAY15,AM_PAY16,AM_PAY17,AM_PAY18,AM_PAY19,AM_PAY20, 
			AM_PAY21,AM_PAY22,AM_PAY23,AM_PAY24,AM_PAY25,AM_PAY26,AM_PAY27,AM_PAY28,AM_PAY29,AM_PAY30, 
			AM_PAY31,AM_PAY32,AM_PAY33,AM_PAY34,AM_PAY35,AM_PAY36,AM_PAY37,AM_PAY38,AM_PAY39,AM_PAY40, 
			AM_DEDUCT01,AM_DEDUCT02,AM_DEDUCT03,AM_DEDUCT04,AM_DEDUCT05,AM_DEDUCT06,AM_DEDUCT07,AM_DEDUCT08,AM_DEDUCT09,AM_DEDUCT10, 
			AM_DEDUCT11,AM_DEDUCT12,AM_DEDUCT13,AM_DEDUCT14,AM_DEDUCT15,AM_DEDUCT16,AM_DEDUCT17,AM_DEDUCT18,AM_DEDUCT19,AM_DEDUCT20, 
			AM_DEDUCT21,AM_DEDUCT22,AM_DEDUCT23,AM_DEDUCT24,AM_DEDUCT25,AM_DEDUCT26,AM_DEDUCT27,AM_DEDUCT28,AM_DEDUCT29,AM_DEDUCT30, 
			AM_DEDUCT31,AM_DEDUCT32,AM_DEDUCT33,AM_DEDUCT34,AM_DEDUCT35,AM_DEDUCT36,AM_DEDUCT37,AM_DEDUCT38,AM_DEDUCT39,AM_DEDUCT40, 
			AM_INCOMTAX, AM_RESIDTAX, AM_TOTTAX, AM_TOTNOTAX, AM_NOTAX0, AM_NOTAX1, AM_NOTAX2, AM_NOTAX3, AM_NOTAX4,
			AM_NANNU, AM_NINS, AM_NEMPE, AM_NOINS,CD_JOB_SERIES, CD_LTAX_AREA, AM_NEMPA, AM_FIRE
		) 
		SELECT  T.CD_COMPANY,  T.CD_BIZAREA, T.CD_DEPT, T.CD_CC, T.CD_DUTY_RANK, T.CD_DUTY_TYPE, T.CD_DUTY_STEP, T.CD_DUTY_RESP, T.CD_PAY_STEP, T.CD_PJT,
				T.NO_EMP, T.CD_EMP, T.TP_EMP, T.TP_PAY, T.DT_RETIRE, T.DT_START, T.DT_END,
				T.CD_USER1, T.CD_USER2, T.CD_USER3,
				T.AM_PAY01,        T.AM_PAY02,     
				T.AM_PAY03,        T.AM_PAY04,        T.AM_PAY05,        T.AM_PAY06,        T.AM_PAY07,        T.AM_PAY08,     
				T.AM_PAY09,        T.AM_PAY10,        T.AM_PAY11,        T.AM_PAY12,        T.AM_PAY13,        T.AM_PAY14,     
				T.AM_PAY15,        T.AM_PAY16,        T.AM_PAY17,        T.AM_PAY18,        T.AM_PAY19,        T.AM_PAY20,     
				T.AM_PAY21,        T.AM_PAY22,        T.AM_PAY23,        T.AM_PAY24,        T.AM_PAY25,        T.AM_PAY26,     
				T.AM_PAY27,        T.AM_PAY28,        T.AM_PAY29,        T.AM_PAY30,        T.AM_PAY31,        T.AM_PAY32,     
				T.AM_PAY33,        T.AM_PAY34,        T.AM_PAY35,        T.AM_PAY36,        T.AM_PAY37,        T.AM_PAY38,     
				T.AM_PAY39,        T.AM_PAY40,        T.AM_DEDUCT01,        T.AM_DEDUCT02,        T.AM_DEDUCT03,        T.AM_DEDUCT04,     
				T.AM_DEDUCT05,        T.AM_DEDUCT06,        T.AM_DEDUCT07,        T.AM_DEDUCT08,        T.AM_DEDUCT09,        T.AM_DEDUCT10,     
				T.AM_DEDUCT11,        T.AM_DEDUCT12,        T.AM_DEDUCT13,        T.AM_DEDUCT14,        T.AM_DEDUCT15,        T.AM_DEDUCT16,     
				T.AM_DEDUCT17,        T.AM_DEDUCT18,        T.AM_DEDUCT19,        T.AM_DEDUCT20,        T.AM_DEDUCT21,        T.AM_DEDUCT22,     
				T.AM_DEDUCT23,        T.AM_DEDUCT24,        T.AM_DEDUCT25,        T.AM_DEDUCT26,        T.AM_DEDUCT27,        T.AM_DEDUCT28,     
				T.AM_DEDUCT29,        T.AM_DEDUCT30,        T.AM_DEDUCT31,        T.AM_DEDUCT32,        T.AM_DEDUCT33,        T.AM_DEDUCT34,     
				T.AM_DEDUCT35,        T.AM_DEDUCT36,        T.AM_DEDUCT37,        T.AM_DEDUCT38,        T.AM_DEDUCT39,        T.AM_DEDUCT40, 
				T.AM_INCOMTAX, T.AM_RESIDTAX, T.AM_TOTTAX, T.AM_TOTNOTAX, 
	 
				CASE WHEN SUBSTRING(@P_YM, 1, 4) >= '2009' THEN T.AM_NOTAX0_2009  
				ELSE T.AM_NOTAX0 END AM_NOTAX0, --신고비과세 
	 
				CASE WHEN SUBSTRING(@P_YM, 1, 4) >= '2009' THEN T.AM_NOTAX1_2009 - T.AM_NOTAX
				ELSE T.AM_NOTAX1 END AM_NOTAX1,--미신고비과세 
	 
				CASE WHEN SUBSTRING(@P_YM, 1, 4) >= '2009' THEN T.AM_NOTAX
				ELSE T.AM_NOTAX2 END AM_NOTAX2,--사용자부담금 
				T.AM_NOTAX3, T.AM_NOTAX4,
				T.AM_NANNU, T.AM_NINS, T.AM_NEMPE, T.AM_NOINS, T.CD_JOB_SERIES, T.CD_LTAX_AREA, T.AM_NEMPA, T.AM_FIRE
		FROM    ( 
				SELECT  PAY.CD_COMPANY,  PAY.CD_BIZAREA,     
				ISNULL(PAY.CD_DEPT, '') CD_DEPT, 
				ISNULL(PAY.CD_CC, '') CD_CC, 
				ISNULL(PAY.CD_DUTY_RANK, '') CD_DUTY_RANK, 
				ISNULL(PAY.CD_DUTY_TYPE, '') CD_DUTY_TYPE, 
				ISNULL(PAY.CD_DUTY_STEP, '') CD_DUTY_STEP, 
				ISNULL(PAY.CD_DUTY_RESP, '') CD_DUTY_RESP,
				ISNULL(PAY.CD_PAY_STEP, '') CD_PAY_STEP, 
				ISNULL(PAY.CD_PJT, '') CD_PJT,
				ISNULL(E.CD_USER1, '') CD_USER1,
				ISNULL(E.CD_USER2, '') CD_USER2,
				ISNULL(E.CD_USER3, '') CD_USER3,
				PAY.NO_EMP, 
				PAY.CD_EMP, 
				PAY.TP_EMP, 
				PAY.TP_PAY, 
				CASE    WHEN E.DT_RETIRE IS NULL OR RTRIM(LTRIM(E.DT_RETIRE)) = '' OR E.DT_RETIRE = '00000000' THEN '99999999' ELSE E.DT_RETIRE END DT_RETIRE, 
				DT.DT_START, 
				DT.DT_END, 
				SUM(AM_PAY01) AM_PAY01, SUM(AM_PAY02) AM_PAY02, SUM(AM_PAY03) AM_PAY03, SUM(AM_PAY04) AM_PAY04, SUM(AM_PAY05) AM_PAY05, 
				SUM(AM_PAY06) AM_PAY06, SUM(AM_PAY07) AM_PAY07, SUM(AM_PAY08) AM_PAY08, SUM(AM_PAY09) AM_PAY09, SUM(AM_PAY10) AM_PAY10, 
				SUM(AM_PAY11) AM_PAY11, SUM(AM_PAY12) AM_PAY12, SUM(AM_PAY13) AM_PAY13, SUM(AM_PAY14) AM_PAY14, SUM(AM_PAY15) AM_PAY15, 
				SUM(AM_PAY16) AM_PAY16, SUM(AM_PAY17) AM_PAY17, SUM(AM_PAY18) AM_PAY18, SUM(AM_PAY19) AM_PAY19, SUM(AM_PAY20) AM_PAY20, 
				SUM(AM_PAY21) AM_PAY21, SUM(AM_PAY22) AM_PAY22, SUM(AM_PAY23) AM_PAY23, SUM(AM_PAY24) AM_PAY24, SUM(AM_PAY25) AM_PAY25, 
				SUM(AM_PAY26) AM_PAY26, SUM(AM_PAY27) AM_PAY27, SUM(AM_PAY28) AM_PAY28, SUM(AM_PAY29) AM_PAY29, SUM(AM_PAY30) AM_PAY30, 
				SUM(AM_PAY31) AM_PAY31, SUM(AM_PAY32) AM_PAY32, SUM(AM_PAY33) AM_PAY33, SUM(AM_PAY34) AM_PAY34, SUM(AM_PAY35) AM_PAY35, 
				SUM(AM_PAY36) AM_PAY36, SUM(AM_PAY37) AM_PAY37, SUM(AM_PAY38) AM_PAY38, SUM(AM_PAY39) AM_PAY39, SUM(AM_PAY40) AM_PAY40, 
				SUM(AM_DEDUCT01) AM_DEDUCT01, SUM(AM_DEDUCT02) AM_DEDUCT02, SUM(AM_DEDUCT03) AM_DEDUCT03, SUM(AM_DEDUCT04) AM_DEDUCT04, SUM(AM_DEDUCT05) AM_DEDUCT05, 
				SUM(AM_DEDUCT06) AM_DEDUCT06, SUM(AM_DEDUCT07) AM_DEDUCT07, SUM(AM_DEDUCT08) AM_DEDUCT08, SUM(AM_DEDUCT09) AM_DEDUCT09, SUM(AM_DEDUCT10) AM_DEDUCT10, 
				SUM(AM_DEDUCT11) AM_DEDUCT11, SUM(AM_DEDUCT12) AM_DEDUCT12, SUM(AM_DEDUCT13) AM_DEDUCT13, SUM(AM_DEDUCT14) AM_DEDUCT14, SUM(AM_DEDUCT15) AM_DEDUCT15, 
				SUM(AM_DEDUCT16) AM_DEDUCT16, SUM(AM_DEDUCT17) AM_DEDUCT17, SUM(AM_DEDUCT18) AM_DEDUCT18, SUM(AM_DEDUCT19) AM_DEDUCT19, SUM(AM_DEDUCT20) AM_DEDUCT20, 
				SUM(AM_DEDUCT21) AM_DEDUCT21, SUM(AM_DEDUCT22) AM_DEDUCT22, SUM(AM_DEDUCT23) AM_DEDUCT23, SUM(AM_DEDUCT24) AM_DEDUCT24, SUM(AM_DEDUCT25) AM_DEDUCT25, 
				SUM(AM_DEDUCT26) AM_DEDUCT26, SUM(AM_DEDUCT27) AM_DEDUCT27, SUM(AM_DEDUCT28) AM_DEDUCT28, SUM(AM_DEDUCT29) AM_DEDUCT29, SUM(AM_DEDUCT30) AM_DEDUCT30, 
				SUM(AM_DEDUCT31) AM_DEDUCT31, SUM(AM_DEDUCT32) AM_DEDUCT32, SUM(AM_DEDUCT33) AM_DEDUCT33, SUM(AM_DEDUCT34) AM_DEDUCT34, SUM(AM_DEDUCT35) AM_DEDUCT35, 
				SUM(AM_DEDUCT36) AM_DEDUCT36, SUM(AM_DEDUCT37) AM_DEDUCT37, SUM(AM_DEDUCT38) AM_DEDUCT38, SUM(AM_DEDUCT39) AM_DEDUCT39, SUM(AM_DEDUCT40) AM_DEDUCT40, 
				SUM(AM_INCOMTAX) AM_INCOMTAX, SUM(AM_RESIDTAX) AM_RESIDTAX,  
				SUM(AM_TOTTAX) + SUM(AM_STOCK) + SUM(AM_RBONUS) + SUM(AM_ETCPAY) AM_TOTTAX, 
				SUM(AM_TOTNOTAX) AM_TOTNOTAX, 
	 
				ISNULL(SUM(AM_NOTAX_REP), 0) AM_NOTAX0_2009, 
				SUM(AM_NRND) + SUM(AM_NOFOREIGN) + SUM(AM_NOABROD) + SUM(AM_NOEXT) + SUM(AM_NOETC) - SUM(AM_NEAT) - SUM(AM_NTR) AM_NOTAX0, --신고비과세 
	 
				ISNULL(SUM(AM_NOTAX_UNREP), 0) AM_NOTAX1_2009, 
				SUM(AM_NEAT) + SUM(AM_NTR) AM_NOTAX1,--미신고비과세 
				SUM(AM_NANNU) + SUM(AM_NINS) + SUM(AM_NEMPE) + SUM(AM_NEMPS) + SUM(AM_NEMPA) + SUM(AM_NEDU) + SUM(ISNULL(AM_NOINS, 0)) AM_NOTAX2,--사용자부담금 
	 
	 
				SUM(AM_NANNU) + SUM(AM_NINS) AM_NOTAX3,  
				SUM(AM_NEMPE) + SUM(AM_NEMPS) + SUM(AM_NEMPA) AM_NOTAX4,
				ISNULL(SUM(N.AM_NOTAX), 0) AM_NOTAX,
				ISNULL(SUM(AM_NANNU), 0) AM_NANNU, 
				ISNULL(SUM(AM_NINS), 0) AM_NINS, 
				ISNULL(SUM(AM_NEMPE), 0) AM_NEMPE, 
				ISNULL(SUM(AM_NOINS), 0) AM_NOINS,
				ISNULL(PAY.CD_JOB_SERIES, '') CD_JOB_SERIES,
				ISNULL(MAX(PAY.CD_LTAX_AREA), '') CD_LTAX_AREA, 
				ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA,
				ISNULL(SUM(AM_FIRE), 0) AM_FIRE
			FROM    HR_PCALCPAY AS PAY 
			INNER JOIN MA_EMP AS E 
			ON    PAY.CD_COMPANY     = E.CD_COMPANY 
			AND    PAY.NO_EMP         = E.NO_EMP 
			INNER JOIN HR_PTITLE AS TI  
			ON    PAY.CD_COMPANY    = TI.CD_COMPANY 
			AND    PAY.CD_BIZAREA        = TI.CD_BIZAREA 
			AND    PAY.TP_EMP        = TI.TP_EMP  
			AND    PAY.CD_EMP        = TI.CD_EMP 
			AND    PAY.TP_PAY        = TI.TP_PAY 
			AND    PAY.NO_SEQ        = TI.NO_SEQ 
			AND    PAY.YM            = TI.YM 
			AND    (TI.DT_PAY        = @P_DT_PAY OR @P_DT_PAY = '') 
			INNER JOIN 
				( 
				SELECT     CD_COMPANY, CD_BIZAREA, CD_EMP, TP_EMP, CD_MONTH, DT_CLOSE,   
					CASE CD_MONTH WHEN '001' THEN                          
						CONVERT(CHAR(8),DATEADD(MONTH, -1, CONVERT(DATETIME, @P_YM + RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2))),112)     
					ELSE                     
						@P_YM+RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2) 
					END DT_START,  
					CASE CD_MONTH WHEN '001' THEN                      
						CONVERT(CHAR(8),DATEADD(DAY, -1, CONVERT(DATETIME, @P_YM+RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2))),112)     
					ELSE                     
						CONVERT(CHAR(8),DATEADD(DAY,-1,DATEADD(MONTH, 1, CONVERT(DATETIME, @P_YM+RIGHT('00'+(CASE WHEN DT_CLOSE < '31' THEN DT_CLOSE ELSE '31' END ),2)))),112) 
					END DT_END           
				FROM     HR_WCLOSE  
				WHERE    (ISNULL(@P_CD_COMPANY, '' ) = '' OR CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
				AND    TP_CLOSE    = '2' 
				) AS DT 
			ON    PAY.CD_COMPANY     = DT.CD_COMPANY 
			AND    PAY.CD_BIZAREA     = DT.CD_BIZAREA 
			AND    PAY.CD_EMP         = DT.CD_EMP 
			AND    PAY.TP_EMP         = DT.TP_EMP 
			LEFT OUTER JOIN ( 
							SELECT   N.CD_COMPANY, N.NO_EMP, N.TP_PAY, N.NO_SEQ, SUM(N.AM_NOTAX) AM_NOTAX
							FROM    HR_PCALCPAY_N N
							INNER JOIN    (
										SELECT    DISTINCT CD_COMPANY, CD_BIZAREA, NO_EMP, NO_SEQ, CD_EMP, TP_EMP, TP_PAY
										FROM    HR_PCALCPAY 
										WHERE    (ISNULL(@P_CD_COMPANY, '') = '' OR CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
										AND YM = @P_YM AND (TP_PAY = @P_TP_PAY OR @P_TP_PAY = '') 
										AND        (CD_EMP        = @P_CD_EMP OR @P_CD_EMP = '')     
										AND        (TP_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_TP_EMP)) OR @P_MULTI_TP_EMP = '')
										AND        (NO_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT2(@P_MULTI_EMP)) OR CONVERT(VARCHAR, @P_MULTI_EMP) = '')  
										) P
							ON      N.CD_COMPANY = P.CD_COMPANY AND  N.NO_EMP = P.NO_EMP AND N.NO_SEQ = P.NO_SEQ AND N.TP_PAY = P.TP_PAY
							INNER JOIN HR_PTITLE TI  
							ON       P.CD_COMPANY = TI.CD_COMPANY AND P.CD_BIZAREA = TI.CD_BIZAREA 
							AND        P.TP_EMP = TI.TP_EMP AND P.CD_EMP = TI.CD_EMP AND N.TP_PAY = TI.TP_PAY AND N.NO_SEQ = TI.NO_SEQ 
							AND        N.YM = TI.YM AND (TI.DT_PAY = @P_DT_PAY OR @P_DT_PAY = '') 
							WHERE    (ISNULL(@P_CD_COMPANY, '') = '' OR N.CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
							AND N.YM = @P_YM 
							AND        (@P_TP_PAY IS NULL OR @P_TP_PAY = '' OR N.TP_PAY = @P_TP_PAY) AND N.CD_NOTAX = 'N01' 
							GROUP BY N.CD_COMPANY, N.NO_EMP, N.TP_PAY, N.NO_SEQ
							) N 
			ON   PAY.CD_COMPANY = N.CD_COMPANY AND    PAY.NO_EMP = N.NO_EMP AND PAY.TP_PAY = N.TP_PAY AND PAY.NO_SEQ = N.NO_SEQ
			WHERE	(ISNULL(@P_CD_COMPANY, '') = '' OR PAY.CD_COMPANY IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_CD_COMPANY))) 
			AND		(PAY.CD_BIZAREA IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_BIZAREA)) OR @P_MULTI_BIZAREA = '')  
			AND		(PAY.CD_DEPT IN (SELECT CD_STR FROM GETTABLEFROMSPLIT2(@P_MULTI_DEPT)) OR CONVERT(VARCHAR, @P_MULTI_DEPT) = '' OR @P_MULTI_DEPT IS NULL)  
			AND		(PAY.NO_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT2(@P_MULTI_EMP)) OR CONVERT(VARCHAR, @P_MULTI_EMP) = '')  
			AND		PAY.YM            = @P_YM      
			AND		(PAY.CD_EMP        = @P_CD_EMP OR @P_CD_EMP = '')     
			AND		(PAY.TP_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_TP_EMP)) OR @P_MULTI_TP_EMP = '')      
			AND		(PAY.TP_PAY        = @P_TP_PAY OR @P_TP_PAY = '') 
			--순번 추가
			AND		PAY.NO_SEQ = CASE WHEN @P_NO_SEQ > 0 THEN @P_NO_SEQ ELSE PAY.NO_SEQ END
			AND		(PAY.CD_LTAX_AREA IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_LTAX_AREA)) OR @P_MULTI_LTAX_AREA = '' OR @P_MULTI_LTAX_AREA IS NULL) 
			GROUP BY PAY.CD_COMPANY, PAY.CD_BIZAREA, ISNULL(PAY.CD_DEPT, ''), PAY.YM, ISNULL(PAY.CD_CC, ''), ISNULL(PAY.CD_DUTY_RANK, ''), ISNULL(PAY.CD_DUTY_TYPE, ''), ISNULL(PAY.CD_DUTY_STEP, ''), ISNULL(PAY.CD_DUTY_RESP, ''), ISNULL(PAY.CD_PAY_STEP, ''), ISNULL(PAY.CD_PJT, ''), E.CD_USER1, E.CD_USER2, E.CD_USER3, PAY.NO_EMP, PAY.CD_EMP, PAY.TP_EMP, PAY.TP_PAY, E.DT_RETIRE, DT.DT_START, DT.DT_END,
					 ISNULL(PAY.CD_JOB_SERIES, '')--, ISNULL(PAY.CD_LTAX_AREA, '')
			--ORDER BY PAY.CD_BIZAREA ASC, PAY.CD_DEPT ASC, PAY.CD_DUTY_RANK ASC, PAY.NO_EMP ASC 
			) T
	END			
  END   
        
--지급총액이 0인 사원 제외  
IF @P_AM_TOTPAY = 'Y'  
BEGIN  
	DELETE  
	FROM	@P_DTEMP  
	WHERE	사번 IN (SELECT 사번 FROM @P_DTEMP GROUP BY 사번   
	HAVING SUM(AM_PAY01+AM_PAY02+AM_PAY03+AM_PAY04+AM_PAY05+AM_PAY06+AM_PAY07+AM_PAY08+AM_PAY09+AM_PAY10+  
	AM_PAY11+AM_PAY12+AM_PAY13+AM_PAY14+AM_PAY15+AM_PAY16+AM_PAY17+AM_PAY18+AM_PAY19+AM_PAY20+  
	AM_PAY21+AM_PAY22+AM_PAY23+AM_PAY24+AM_PAY25+AM_PAY26+AM_PAY27+AM_PAY28+AM_PAY29+AM_PAY30+  
	AM_PAY31+AM_PAY32+AM_PAY33+AM_PAY34+AM_PAY35+AM_PAY36+AM_PAY37+AM_PAY38+AM_PAY39+AM_PAY40) = 0   
	AND SUM(AM_DEDUCT01+AM_DEDUCT02+AM_DEDUCT03+AM_DEDUCT04+AM_DEDUCT05+AM_DEDUCT06+AM_DEDUCT07+AM_DEDUCT08+AM_DEDUCT09+AM_DEDUCT10+  
	AM_DEDUCT11+AM_DEDUCT12+AM_DEDUCT13+AM_DEDUCT14+AM_DEDUCT15+AM_DEDUCT16+AM_DEDUCT17+AM_DEDUCT18+AM_DEDUCT19+AM_DEDUCT20+  
	AM_DEDUCT21+AM_DEDUCT22+AM_DEDUCT23+AM_DEDUCT24+AM_DEDUCT25+AM_DEDUCT26+AM_DEDUCT27+AM_DEDUCT28+AM_DEDUCT29+AM_DEDUCT30+  
	AM_DEDUCT31+AM_DEDUCT32+AM_DEDUCT33+AM_DEDUCT34+AM_DEDUCT35+AM_DEDUCT36+AM_DEDUCT37+AM_DEDUCT38+AM_DEDUCT39+AM_DEDUCT40) = 0)  
END  
        
 
-- 재직구분 : 재직 
IF(@P_CD_INCOM = '001') 
BEGIN 
    DELETE     
    FROM    @P_DTEMP 
    WHERE    퇴사일자 BETWEEN 급여시작일 AND 급여종료일 
END 
ELSE IF(@P_CD_INCOM = '002') 
BEGIN 
    DELETE 
    FROM    @P_DTEMP 
    WHERE    퇴사일자 > 급여종료일 
END 
 
DECLARE  
    @P_C_고용형태    NVARCHAR(3), 
    @P_C_사원구분    NVARCHAR(3), 
    @P_C_급여구분    NVARCHAR(3), 
    @P_C_공제구분    NVARCHAR(3), 
    @P_C_출력코드    NVARCHAR(3), 
    @P_C_지급공제코드    NVARCHAR(3), 
    @P_저장할필드명    NVARCHAR(10), 
    @P_금액필드명    NVARCHAR(10), 
    @P_SQL        NVARCHAR(200) 
 
DECLARE CUR CURSOR FOR 
    SELECT    CD.CD_EMP, 
        CD.TP_EMP, 
        CD.TP_PAY, 
        FM.TP_PDREPORT, 
        FM.CD_REPORT, 
        CD.CD_CPAYDEDUCT 
    FROM    HR_PREPFORM AS FM 
    LEFT OUTER JOIN    ( 
            SELECT    CD.CD_COMPANY, CD.CD_EMP, CD.TP_EMP, CD.TP_PAY,  
                CD.TP_PAYDEDUCT, CD.CD_CPAYDEDUCT,CD.CD_PAYDEDUCT 
            FROM    HR_PCALCHEAD AS CD 
            INNER JOIN  
                ( 
                SELECT     CD_COMPANY, CD_EMP, TP_EMP, TP_PAY, MAX(YM) YM  
                FROM     HR_PCALCHEAD                   
                WHERE    CD_COMPANY    = @P_CD_COMPANY_L 
                AND    YM         <= @P_YM 
                AND    (CD_EMP    = @P_CD_EMP OR @P_CD_EMP = '')     
                AND    (TP_EMP IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@P_MULTI_TP_EMP)) OR @P_MULTI_TP_EMP = '')      
                AND    (TP_PAY        = @P_TP_PAY OR @P_TP_PAY = '') 
                GROUP BY CD_COMPANY, CD_EMP, TP_EMP, TP_PAY 
                ) AS MAXH 
            ON    CD.CD_COMPANY    = MAXH.CD_COMPANY 
            AND    CD.YM         = MAXH.YM 
            AND    CD.CD_EMP     = MAXH.CD_EMP 
            AND    CD.TP_EMP     = MAXH.TP_EMP 
            AND    CD.TP_PAY     = MAXH.TP_PAY 
            ) AS CD 
    ON    FM.CD_COMPANY        = CD.CD_COMPANY 
    AND    FM.TP_PDREPORT    = CD.TP_PAYDEDUCT 
    AND    FM.CD_PAYDEDUCT    = CD.CD_PAYDEDUCT 
     
    WHERE    FM.CD_COMPANY        = @P_CD_COMPANY_L 
    AND    FM.TP_REPORT        = @P_TP_REPORT 
    AND    (FM.TP_PDREPORT = '001' OR FM.TP_PDREPORT = '002') 
    AND    FM.CD_PAYDEDUCT NOT IN ('STX', 'JTX', 'NTX') 
    ORDER BY CD.CD_EMP ASC, CD.TP_EMP ASC, CD.TP_PAY, FM.TP_PDREPORT ASC, CONVERT(INT, FM.CD_RSEQ) ASC, FM.CD_REPORT ASC, FM.CD_PAYDEDUCT ASC 
 
OPEN CUR 
 
FETCH NEXT FROM CUR 
INTO @P_C_고용형태, @P_C_사원구분, @P_C_급여구분, @P_C_공제구분, @P_C_출력코드, @P_C_지급공제코드 
 
WHILE (@@FETCH_STATUS = 0) 
BEGIN 
    SET @P_저장할필드명 = '' 
    SET @P_금액필드명 = '' 
    SET @P_SQL = '' 
 
    UPDATE    @P_DTEMP 
    SET    AM_TEMP    = 0 
    WHERE    고용형태        = @P_C_고용형태 
    AND    사원구분        = @P_C_사원구분 
    AND    급여구분        = @P_C_급여구분 
 
    -- 지급 
    IF(@P_C_공제구분 = '001') 
    BEGIN         
 
        UPDATE    @P_DTEMP 
        SET    AM_TEMP    = ISNULL( 
                    CASE    WHEN     @P_C_지급공제코드 = '001' THEN AM_PAY01    WHEN    @P_C_지급공제코드 = '002' THEN AM_PAY02 
                        WHEN    @P_C_지급공제코드 = '003' THEN AM_PAY03    WHEN    @P_C_지급공제코드 = '004' THEN AM_PAY04 
                        WHEN    @P_C_지급공제코드 = '005' THEN AM_PAY05    WHEN    @P_C_지급공제코드 = '006' THEN AM_PAY06 
                        WHEN    @P_C_지급공제코드 = '007' THEN AM_PAY07    WHEN    @P_C_지급공제코드 = '008' THEN AM_PAY08 
                        WHEN    @P_C_지급공제코드 = '009' THEN AM_PAY09    WHEN    @P_C_지급공제코드 = '010' THEN AM_PAY10 
                        WHEN    @P_C_지급공제코드 = '011' THEN AM_PAY11    WHEN    @P_C_지급공제코드 = '012' THEN AM_PAY12 
                        WHEN    @P_C_지급공제코드 = '013' THEN AM_PAY13    WHEN    @P_C_지급공제코드 = '014' THEN AM_PAY14 
                        WHEN    @P_C_지급공제코드 = '015' THEN AM_PAY15    WHEN    @P_C_지급공제코드 = '016' THEN AM_PAY16 
                        WHEN    @P_C_지급공제코드 = '017' THEN AM_PAY17    WHEN    @P_C_지급공제코드 = '018' THEN AM_PAY18 
                        WHEN    @P_C_지급공제코드 = '019' THEN AM_PAY19    WHEN    @P_C_지급공제코드 = '020' THEN AM_PAY20 
                        WHEN    @P_C_지급공제코드 = '021' THEN AM_PAY21    WHEN    @P_C_지급공제코드 = '022' THEN AM_PAY22 
                        WHEN    @P_C_지급공제코드 = '023' THEN AM_PAY23    WHEN    @P_C_지급공제코드 = '024' THEN AM_PAY24 
                        WHEN    @P_C_지급공제코드 = '025' THEN AM_PAY25    WHEN    @P_C_지급공제코드 = '026' THEN AM_PAY26 
                        WHEN    @P_C_지급공제코드 = '027' THEN AM_PAY27    WHEN    @P_C_지급공제코드 = '028' THEN AM_PAY28 
                        WHEN    @P_C_지급공제코드 = '029' THEN AM_PAY29    WHEN    @P_C_지급공제코드 = '030' THEN AM_PAY30 
                        WHEN    @P_C_지급공제코드 = '031' THEN AM_PAY31    WHEN    @P_C_지급공제코드 = '032' THEN AM_PAY32 
                        WHEN    @P_C_지급공제코드 = '033' THEN AM_PAY33    WHEN    @P_C_지급공제코드 = '034' THEN AM_PAY34 
                        WHEN    @P_C_지급공제코드 = '035' THEN AM_PAY35    WHEN    @P_C_지급공제코드 = '036' THEN AM_PAY36 
                        WHEN    @P_C_지급공제코드 = '037' THEN AM_PAY37    WHEN    @P_C_지급공제코드 = '038' THEN AM_PAY38 
                        WHEN    @P_C_지급공제코드 = '039' THEN AM_PAY39    WHEN    @P_C_지급공제코드 = '040' THEN AM_PAY40 
                    END, 0) 
        WHERE    고용형태        = @P_C_고용형태 
        AND    사원구분        = @P_C_사원구분 
        AND    급여구분        = @P_C_급여구분 
 
        IF(@P_C_출력코드 = '001')     
            UPDATE    @P_DTEMP SET PAY_01 = ISNULL(PAY_01, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '002')     
            UPDATE    @P_DTEMP SET PAY_02 = ISNULL(PAY_02, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '003')     
            UPDATE    @P_DTEMP SET PAY_03 = ISNULL(PAY_03, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '004')     
            UPDATE    @P_DTEMP SET PAY_04 = ISNULL(PAY_04, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '005')     
            UPDATE    @P_DTEMP SET PAY_05 = ISNULL(PAY_05, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '006')     
            UPDATE    @P_DTEMP SET PAY_06 = ISNULL(PAY_06, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '007')     
            UPDATE    @P_DTEMP SET PAY_07 = ISNULL(PAY_07, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '008')     
            UPDATE    @P_DTEMP SET PAY_08 = ISNULL(PAY_08, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '009')     
            UPDATE    @P_DTEMP SET PAY_09 = ISNULL(PAY_09, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '010')     
            UPDATE    @P_DTEMP SET PAY_10 = ISNULL(PAY_10, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '011')     
            UPDATE    @P_DTEMP SET PAY_11 = ISNULL(PAY_11, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '012')     
            UPDATE    @P_DTEMP SET PAY_12 = ISNULL(PAY_12, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '013')     
            UPDATE    @P_DTEMP SET PAY_13 = ISNULL(PAY_13, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '014')     
            UPDATE    @P_DTEMP SET PAY_14 = ISNULL(PAY_14, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '015')     
            UPDATE    @P_DTEMP SET PAY_15 = ISNULL(PAY_15, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '016')     
            UPDATE    @P_DTEMP SET PAY_16 = ISNULL(PAY_16, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '017')     
            UPDATE    @P_DTEMP SET PAY_17 = ISNULL(PAY_17, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '018')     
            UPDATE    @P_DTEMP SET PAY_18 = ISNULL(PAY_18, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '019')     
            UPDATE    @P_DTEMP SET PAY_19 = ISNULL(PAY_19, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '020')     
            UPDATE    @P_DTEMP SET PAY_20 = ISNULL(PAY_20, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '021')     
            UPDATE    @P_DTEMP SET PAY_21 = ISNULL(PAY_21, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '022')     
            UPDATE    @P_DTEMP SET PAY_22 = ISNULL(PAY_22, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '023')     
            UPDATE    @P_DTEMP SET PAY_23 = ISNULL(PAY_23, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '024')     
            UPDATE    @P_DTEMP SET PAY_24 = ISNULL(PAY_24, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '025')     
            UPDATE    @P_DTEMP SET PAY_25 = ISNULL(PAY_25, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '026')     
            UPDATE    @P_DTEMP SET PAY_26 = ISNULL(PAY_26, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '027')     
            UPDATE    @P_DTEMP SET PAY_27 = ISNULL(PAY_27, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '028')     
            UPDATE    @P_DTEMP SET PAY_28 = ISNULL(PAY_28, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '029')     
            UPDATE    @P_DTEMP SET PAY_29 = ISNULL(PAY_29, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '030')     
            UPDATE    @P_DTEMP SET PAY_30 = ISNULL(PAY_30, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '031')     
            UPDATE    @P_DTEMP SET PAY_31 = ISNULL(PAY_31, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '032')     
            UPDATE    @P_DTEMP SET PAY_32 = ISNULL(PAY_32, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '033')     
            UPDATE    @P_DTEMP SET PAY_33 = ISNULL(PAY_33, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '034')     
            UPDATE    @P_DTEMP SET PAY_34 = ISNULL(PAY_34, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '035')     
            UPDATE    @P_DTEMP SET PAY_35 = ISNULL(PAY_35, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '036')     
            UPDATE    @P_DTEMP SET PAY_36 = ISNULL(PAY_36, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '037')     
            UPDATE    @P_DTEMP SET PAY_37 = ISNULL(PAY_37, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '038')     
            UPDATE    @P_DTEMP SET PAY_38 = ISNULL(PAY_38, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '039')     
            UPDATE    @P_DTEMP SET PAY_39 = ISNULL(PAY_39, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '040')     
            UPDATE    @P_DTEMP SET PAY_40 = ISNULL(PAY_40, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분             
        ELSE IF(@P_C_출력코드 = '041')     
            UPDATE    @P_DTEMP SET PAY_41 = ISNULL(PAY_41, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '042')     
            UPDATE    @P_DTEMP SET PAY_42 = ISNULL(PAY_42, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '043')     
            UPDATE    @P_DTEMP SET PAY_43 = ISNULL(PAY_43, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '044')     
            UPDATE    @P_DTEMP SET PAY_44 = ISNULL(PAY_44, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '045')     
            UPDATE    @P_DTEMP SET PAY_45 = ISNULL(PAY_45, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '046')     
            UPDATE    @P_DTEMP SET PAY_46 = ISNULL(PAY_46, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '047')     
            UPDATE    @P_DTEMP SET PAY_47 = ISNULL(PAY_47, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '048')     
            UPDATE    @P_DTEMP SET PAY_48 = ISNULL(PAY_48, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '049')     
            UPDATE    @P_DTEMP SET PAY_49 = ISNULL(PAY_49, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분
        ELSE IF(@P_C_출력코드 = '050')     
            UPDATE    @P_DTEMP SET PAY_50 = ISNULL(PAY_50, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분             
        ELSE IF(@P_C_출력코드 = '051')     
            UPDATE    @P_DTEMP SET PAY_51 = ISNULL(PAY_51, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '052')     
            UPDATE    @P_DTEMP SET PAY_52 = ISNULL(PAY_52, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '053')     
            UPDATE    @P_DTEMP SET PAY_53 = ISNULL(PAY_53, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '054')     
            UPDATE    @P_DTEMP SET PAY_54 = ISNULL(PAY_54, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '055')     
            UPDATE    @P_DTEMP SET PAY_55 = ISNULL(PAY_55, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '056')     
            UPDATE    @P_DTEMP SET PAY_56 = ISNULL(PAY_56, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '057')     
            UPDATE    @P_DTEMP SET PAY_57 = ISNULL(PAY_57, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '058')     
            UPDATE    @P_DTEMP SET PAY_58 = ISNULL(PAY_58, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '059')     
            UPDATE    @P_DTEMP SET PAY_59 = ISNULL(PAY_59, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분                        
        ELSE IF(@P_C_출력코드 = '060')     
            UPDATE    @P_DTEMP SET PAY_60 = ISNULL(PAY_60, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분             
        ELSE IF(@P_C_출력코드 = '061')     
            UPDATE    @P_DTEMP SET PAY_61 = ISNULL(PAY_61, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '062')     
            UPDATE    @P_DTEMP SET PAY_62 = ISNULL(PAY_62, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '063')     
            UPDATE    @P_DTEMP SET PAY_63 = ISNULL(PAY_63, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '064')     
            UPDATE    @P_DTEMP SET PAY_64 = ISNULL(PAY_64, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '065')     
            UPDATE    @P_DTEMP SET PAY_65 = ISNULL(PAY_65, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '066')     
            UPDATE    @P_DTEMP SET PAY_66 = ISNULL(PAY_66, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '067')     
            UPDATE    @P_DTEMP SET PAY_67 = ISNULL(PAY_67, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '068')     
            UPDATE    @P_DTEMP SET PAY_68 = ISNULL(PAY_68, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '069')     
            UPDATE    @P_DTEMP SET PAY_69 = ISNULL(PAY_69, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분            
        ELSE IF(@P_C_출력코드 = '070')     
            UPDATE    @P_DTEMP SET PAY_70 = ISNULL(PAY_70, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분             
        ELSE IF(@P_C_출력코드 = '071')     
            UPDATE    @P_DTEMP SET PAY_71 = ISNULL(PAY_71, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '072')     
            UPDATE    @P_DTEMP SET PAY_72 = ISNULL(PAY_72, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '073')     
            UPDATE    @P_DTEMP SET PAY_73 = ISNULL(PAY_73, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '074')     
            UPDATE    @P_DTEMP SET PAY_74 = ISNULL(PAY_74, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '075')     
            UPDATE    @P_DTEMP SET PAY_75 = ISNULL(PAY_75, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '076')     
            UPDATE    @P_DTEMP SET PAY_76 = ISNULL(PAY_76, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '077')     
            UPDATE    @P_DTEMP SET PAY_77 = ISNULL(PAY_77, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '078')     
            UPDATE    @P_DTEMP SET PAY_78 = ISNULL(PAY_78, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '079')     
            UPDATE    @P_DTEMP SET PAY_79 = ISNULL(PAY_79, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분            
		ELSE IF(@P_C_출력코드 = '080')     
            UPDATE    @P_DTEMP SET PAY_80 = ISNULL(PAY_80, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분                         
    END 
    -- 공제 
    ELSE IF(@P_C_공제구분 = '002') 
    BEGIN 
        UPDATE    @P_DTEMP 
        SET    AM_TEMP    = ISNULL( 
                    CASE    WHEN     @P_C_지급공제코드 = '001' THEN AM_DEDUCT01    WHEN    @P_C_지급공제코드 = '002' THEN AM_DEDUCT02 
                        WHEN    @P_C_지급공제코드 = '003' THEN AM_DEDUCT03    WHEN    @P_C_지급공제코드 = '004' THEN AM_DEDUCT04 
                        WHEN    @P_C_지급공제코드 = '005' THEN AM_DEDUCT05    WHEN    @P_C_지급공제코드 = '006' THEN AM_DEDUCT06 
                        WHEN    @P_C_지급공제코드 = '007' THEN AM_DEDUCT07    WHEN    @P_C_지급공제코드 = '008' THEN AM_DEDUCT08 
                        WHEN    @P_C_지급공제코드 = '009' THEN AM_DEDUCT09    WHEN    @P_C_지급공제코드 = '010' THEN AM_DEDUCT10 
                        WHEN    @P_C_지급공제코드 = '011' THEN AM_DEDUCT11    WHEN    @P_C_지급공제코드 = '012' THEN AM_DEDUCT12 
                        WHEN    @P_C_지급공제코드 = '013' THEN AM_DEDUCT13    WHEN    @P_C_지급공제코드 = '014' THEN AM_DEDUCT14 
                        WHEN    @P_C_지급공제코드 = '015' THEN AM_DEDUCT15    WHEN    @P_C_지급공제코드 = '016' THEN AM_DEDUCT16 
                        WHEN    @P_C_지급공제코드 = '017' THEN AM_DEDUCT17    WHEN    @P_C_지급공제코드 = '018' THEN AM_DEDUCT18 
                        WHEN    @P_C_지급공제코드 = '019' THEN AM_DEDUCT19    WHEN    @P_C_지급공제코드 = '020' THEN AM_DEDUCT20 
                        WHEN    @P_C_지급공제코드 = '021' THEN AM_DEDUCT21    WHEN    @P_C_지급공제코드 = '022' THEN AM_DEDUCT22 
                        WHEN    @P_C_지급공제코드 = '023' THEN AM_DEDUCT23    WHEN    @P_C_지급공제코드 = '024' THEN AM_DEDUCT24 
                        WHEN    @P_C_지급공제코드 = '025' THEN AM_DEDUCT25    WHEN    @P_C_지급공제코드 = '026' THEN AM_DEDUCT26 
                        WHEN    @P_C_지급공제코드 = '027' THEN AM_DEDUCT27    WHEN    @P_C_지급공제코드 = '028' THEN AM_DEDUCT28 
                        WHEN    @P_C_지급공제코드 = '029' THEN AM_DEDUCT29    WHEN    @P_C_지급공제코드 = '030' THEN AM_DEDUCT30 
                        WHEN    @P_C_지급공제코드 = '031' THEN AM_DEDUCT31    WHEN    @P_C_지급공제코드 = '032' THEN AM_DEDUCT32 
                        WHEN    @P_C_지급공제코드 = '033' THEN AM_DEDUCT33    WHEN    @P_C_지급공제코드 = '034' THEN AM_DEDUCT34 
                        WHEN    @P_C_지급공제코드 = '035' THEN AM_DEDUCT35    WHEN    @P_C_지급공제코드 = '036' THEN AM_DEDUCT36 
                        WHEN    @P_C_지급공제코드 = '037' THEN AM_DEDUCT37    WHEN    @P_C_지급공제코드 = '038' THEN AM_DEDUCT38 
                        WHEN    @P_C_지급공제코드 = '039' THEN AM_DEDUCT39    WHEN    @P_C_지급공제코드 = '040' THEN AM_DEDUCT40 
                    END, 0) 
        WHERE    고용형태        = @P_C_고용형태 
        AND    사원구분        = @P_C_사원구분 
        AND    급여구분        = @P_C_급여구분 
 
        IF(@P_C_출력코드 = '001')     
            UPDATE    @P_DTEMP SET DEDU_01 = ISNULL(DEDU_01, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '002')     
            UPDATE    @P_DTEMP SET DEDU_02 = ISNULL(DEDU_02, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        IF(@P_C_출력코드 = '003')     
            UPDATE    @P_DTEMP SET DEDU_03 = ISNULL(DEDU_03, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        IF(@P_C_출력코드 = '004')     
            UPDATE    @P_DTEMP SET DEDU_04 = ISNULL(DEDU_04, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '005')     
            UPDATE    @P_DTEMP SET DEDU_05 = ISNULL(DEDU_05, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '006')     
            UPDATE    @P_DTEMP SET DEDU_06 = ISNULL(DEDU_06, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '007')     
            UPDATE    @P_DTEMP SET DEDU_07 = ISNULL(DEDU_07, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '008')     
            UPDATE    @P_DTEMP SET DEDU_08 = ISNULL(DEDU_08, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '009')     
            UPDATE    @P_DTEMP SET DEDU_09 = ISNULL(DEDU_09, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '010')     
            UPDATE    @P_DTEMP SET DEDU_10 = ISNULL(DEDU_10, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '011')     
            UPDATE    @P_DTEMP SET DEDU_11 = ISNULL(DEDU_11, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '012')     
            UPDATE    @P_DTEMP SET DEDU_12 = ISNULL(DEDU_12, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '013')     
            UPDATE    @P_DTEMP SET DEDU_13 = ISNULL(DEDU_13, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '014')     
            UPDATE    @P_DTEMP SET DEDU_14 = ISNULL(DEDU_14, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '015')     
            UPDATE    @P_DTEMP SET DEDU_15 = ISNULL(DEDU_15, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '016')     
            UPDATE    @P_DTEMP SET DEDU_16 = ISNULL(DEDU_16, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '017')     
            UPDATE    @P_DTEMP SET DEDU_17 = ISNULL(DEDU_17, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '018')     
            UPDATE    @P_DTEMP SET DEDU_18 = ISNULL(DEDU_18, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '019')     
            UPDATE    @P_DTEMP SET DEDU_19 = ISNULL(DEDU_19, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '020')     
            UPDATE    @P_DTEMP SET DEDU_20 = ISNULL(DEDU_20, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '021')     
            UPDATE    @P_DTEMP SET DEDU_21 = ISNULL(DEDU_21, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '022')     
            UPDATE    @P_DTEMP SET DEDU_22 = ISNULL(DEDU_22, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '023')     
            UPDATE    @P_DTEMP SET DEDU_23 = ISNULL(DEDU_23, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '024')     
            UPDATE    @P_DTEMP SET DEDU_24 = ISNULL(DEDU_24, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '025')     
            UPDATE    @P_DTEMP SET DEDU_25 = ISNULL(DEDU_25, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '026')     
            UPDATE    @P_DTEMP SET DEDU_26 = ISNULL(DEDU_26, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '027')     
            UPDATE    @P_DTEMP SET DEDU_27 = ISNULL(DEDU_27, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '028')     
            UPDATE    @P_DTEMP SET DEDU_28 = ISNULL(DEDU_28, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '029')     
            UPDATE    @P_DTEMP SET DEDU_29 = ISNULL(DEDU_29, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '030')     
            UPDATE    @P_DTEMP SET DEDU_30 = ISNULL(DEDU_30, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '031')     
            UPDATE    @P_DTEMP SET DEDU_31 = ISNULL(DEDU_31, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '032')     
            UPDATE    @P_DTEMP SET DEDU_32 = ISNULL(DEDU_32, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '033')     
            UPDATE    @P_DTEMP SET DEDU_33 = ISNULL(DEDU_33, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '034')     
            UPDATE    @P_DTEMP SET DEDU_34 = ISNULL(DEDU_34, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '035')     
            UPDATE    @P_DTEMP SET DEDU_35 = ISNULL(DEDU_35, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '036')     
            UPDATE    @P_DTEMP SET DEDU_36 = ISNULL(DEDU_36, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '037')     
            UPDATE    @P_DTEMP SET DEDU_37 = ISNULL(DEDU_37, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '038')     
            UPDATE    @P_DTEMP SET DEDU_38 = ISNULL(DEDU_38, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '039')     
            UPDATE    @P_DTEMP SET DEDU_39 = ISNULL(DEDU_39, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '040')     
            UPDATE    @P_DTEMP SET DEDU_40 = ISNULL(DEDU_40, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '041')     
            UPDATE    @P_DTEMP SET DEDU_41 = ISNULL(DEDU_41, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '042')     
            UPDATE    @P_DTEMP SET DEDU_42 = ISNULL(DEDU_42, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '043')     
            UPDATE    @P_DTEMP SET DEDU_43 = ISNULL(DEDU_43, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '044')     
            UPDATE    @P_DTEMP SET DEDU_44 = ISNULL(DEDU_44, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '045')     
            UPDATE    @P_DTEMP SET DEDU_45 = ISNULL(DEDU_45, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '046')     
            UPDATE    @P_DTEMP SET DEDU_46 = ISNULL(DEDU_46, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '047')     
            UPDATE    @P_DTEMP SET DEDU_47 = ISNULL(DEDU_47, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '048')     
            UPDATE    @P_DTEMP SET DEDU_48 = ISNULL(DEDU_48, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '049')     
            UPDATE    @P_DTEMP SET DEDU_49 = ISNULL(DEDU_49, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분
        ELSE IF(@P_C_출력코드 = '050')     
            UPDATE    @P_DTEMP SET DEDU_50 = ISNULL(DEDU_50, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분             
        ELSE IF(@P_C_출력코드 = '051')     
            UPDATE    @P_DTEMP SET DEDU_51 = ISNULL(DEDU_51, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '052')     
            UPDATE    @P_DTEMP SET DEDU_52 = ISNULL(DEDU_52, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '053')     
            UPDATE    @P_DTEMP SET DEDU_53 = ISNULL(DEDU_53, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '054')     
            UPDATE    @P_DTEMP SET DEDU_54 = ISNULL(DEDU_54, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '055')     
            UPDATE    @P_DTEMP SET DEDU_55 = ISNULL(DEDU_55, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '056')     
            UPDATE    @P_DTEMP SET DEDU_56 = ISNULL(DEDU_56, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '057')     
            UPDATE    @P_DTEMP SET DEDU_57 = ISNULL(DEDU_57, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '058')     
            UPDATE    @P_DTEMP SET DEDU_58 = ISNULL(DEDU_58, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '059')     
            UPDATE    @P_DTEMP SET DEDU_59 = ISNULL(DEDU_59, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분                        
        ELSE IF(@P_C_출력코드 = '060')     
            UPDATE    @P_DTEMP SET DEDU_60 = ISNULL(DEDU_60, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분             
        ELSE IF(@P_C_출력코드 = '061')     
            UPDATE    @P_DTEMP SET DEDU_61 = ISNULL(DEDU_61, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '062')     
            UPDATE    @P_DTEMP SET DEDU_62 = ISNULL(DEDU_62, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '063')     
            UPDATE    @P_DTEMP SET DEDU_63 = ISNULL(DEDU_63, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '064')     
            UPDATE    @P_DTEMP SET DEDU_64 = ISNULL(DEDU_64, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '065')     
            UPDATE    @P_DTEMP SET DEDU_65 = ISNULL(DEDU_65, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '066')     
            UPDATE    @P_DTEMP SET DEDU_66 = ISNULL(DEDU_66, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '067')     
            UPDATE    @P_DTEMP SET DEDU_67 = ISNULL(DEDU_67, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '068')     
            UPDATE    @P_DTEMP SET DEDU_68 = ISNULL(DEDU_68, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '069')     
            UPDATE    @P_DTEMP SET DEDU_69 = ISNULL(DEDU_69, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분            
        ELSE IF(@P_C_출력코드 = '070')     
            UPDATE    @P_DTEMP SET DEDU_70 = ISNULL(DEDU_70, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분             
        ELSE IF(@P_C_출력코드 = '071')     
            UPDATE    @P_DTEMP SET DEDU_71 = ISNULL(DEDU_71, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '072')     
            UPDATE    @P_DTEMP SET DEDU_72 = ISNULL(DEDU_72, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '073')     
            UPDATE    @P_DTEMP SET DEDU_73 = ISNULL(DEDU_73, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '074')     
            UPDATE    @P_DTEMP SET DEDU_74 = ISNULL(DEDU_74, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '075')     
            UPDATE    @P_DTEMP SET DEDU_75 = ISNULL(DEDU_75, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '076')     
            UPDATE    @P_DTEMP SET DEDU_76 = ISNULL(DEDU_76, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '077')     
            UPDATE    @P_DTEMP SET DEDU_77 = ISNULL(DEDU_77, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '078')     
            UPDATE    @P_DTEMP SET DEDU_78 = ISNULL(DEDU_78, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분 
        ELSE IF(@P_C_출력코드 = '079')     
            UPDATE    @P_DTEMP SET DEDU_79 = ISNULL(DEDU_79, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분            
		ELSE IF(@P_C_출력코드 = '080')     
            UPDATE    @P_DTEMP SET DEDU_80 = ISNULL(DEDU_80, 0) + ISNULL(AM_TEMP, 0) WHERE 고용형태 = @P_C_고용형태 AND 사원구분 = @P_C_사원구분 AND 급여구분 = @P_C_급여구분                         
    END 
 
    FETCH NEXT FROM CUR 
    INTO @P_C_고용형태, @P_C_사원구분, @P_C_급여구분, @P_C_공제구분, @P_C_출력코드, @P_C_지급공제코드 
END 
 
 
CLOSE CUR 
DEALLOCATE CUR 
 
-- 소득세 
DECLARE @P_CD_REPORT    NVARCHAR(3) 
 
SELECT    @P_CD_REPORT = CD_REPORT 
FROM    HR_PREPFORM  
WHERE    CD_COMPANY    = @P_CD_COMPANY_L 
AND    TP_REPORT    = @P_TP_REPORT 
AND    TP_PDREPORT    = '002' 
AND    CD_PAYDEDUCT    = 'STX' 
 
IF(@P_CD_REPORT IS NOT NULL) 
BEGIN 
    IF(@P_CD_REPORT = '001') 
        UPDATE @P_DTEMP SET DEDU_01 = ISNULL(DEDU_01, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '002') 
        UPDATE @P_DTEMP SET DEDU_02 = ISNULL(DEDU_02, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '003') 
        UPDATE @P_DTEMP SET DEDU_03 = ISNULL(DEDU_03, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '004') 
        UPDATE @P_DTEMP SET DEDU_04 = ISNULL(DEDU_04, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '005') 
        UPDATE @P_DTEMP SET DEDU_05 = ISNULL(DEDU_05, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '006') 
        UPDATE @P_DTEMP SET DEDU_06 = ISNULL(DEDU_06, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '007') 
        UPDATE @P_DTEMP SET DEDU_07 = ISNULL(DEDU_07, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '008') 
        UPDATE @P_DTEMP SET DEDU_08 = ISNULL(DEDU_08, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '009') 
        UPDATE @P_DTEMP SET DEDU_09 = ISNULL(DEDU_09, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '010') 
        UPDATE @P_DTEMP SET DEDU_10 = ISNULL(DEDU_10, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '011') 
        UPDATE @P_DTEMP SET DEDU_11 = ISNULL(DEDU_11, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '012') 
        UPDATE @P_DTEMP SET DEDU_12 = ISNULL(DEDU_12, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '013') 
        UPDATE @P_DTEMP SET DEDU_13 = ISNULL(DEDU_13, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '014') 
        UPDATE @P_DTEMP SET DEDU_14 = ISNULL(DEDU_14, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '015') 
        UPDATE @P_DTEMP SET DEDU_15 = ISNULL(DEDU_15, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '016') 
        UPDATE @P_DTEMP SET DEDU_16 = ISNULL(DEDU_16, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '017') 
        UPDATE @P_DTEMP SET DEDU_17 = ISNULL(DEDU_17, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '018') 
        UPDATE @P_DTEMP SET DEDU_18 = ISNULL(DEDU_18, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '019') 
        UPDATE @P_DTEMP SET DEDU_19 = ISNULL(DEDU_19, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '020') 
        UPDATE @P_DTEMP SET DEDU_20 = ISNULL(DEDU_20, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '021') 
        UPDATE @P_DTEMP SET DEDU_21 = ISNULL(DEDU_21, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '022') 
        UPDATE @P_DTEMP SET DEDU_22 = ISNULL(DEDU_22, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '023') 
        UPDATE @P_DTEMP SET DEDU_23 = ISNULL(DEDU_23, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '024') 
        UPDATE @P_DTEMP SET DEDU_24 = ISNULL(DEDU_24, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '025') 
        UPDATE @P_DTEMP SET DEDU_25 = ISNULL(DEDU_25, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '026') 
        UPDATE @P_DTEMP SET DEDU_26 = ISNULL(DEDU_26, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '027') 
        UPDATE @P_DTEMP SET DEDU_27 = ISNULL(DEDU_27, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '028') 
        UPDATE @P_DTEMP SET DEDU_28 = ISNULL(DEDU_28, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '029') 
        UPDATE @P_DTEMP SET DEDU_29 = ISNULL(DEDU_29, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '030') 
        UPDATE @P_DTEMP SET DEDU_30 = ISNULL(DEDU_30, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '031') 
        UPDATE @P_DTEMP SET DEDU_31 = ISNULL(DEDU_31, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '032') 
        UPDATE @P_DTEMP SET DEDU_32 = ISNULL(DEDU_32, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '033') 
        UPDATE @P_DTEMP SET DEDU_33 = ISNULL(DEDU_33, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '034') 
        UPDATE @P_DTEMP SET DEDU_34 = ISNULL(DEDU_34, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '035') 
        UPDATE @P_DTEMP SET DEDU_35 = ISNULL(DEDU_35, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '036') 
        UPDATE @P_DTEMP SET DEDU_36 = ISNULL(DEDU_36, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '037') 
        UPDATE @P_DTEMP SET DEDU_37 = ISNULL(DEDU_37, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '038') 
        UPDATE @P_DTEMP SET DEDU_38 = ISNULL(DEDU_38, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '039') 
        UPDATE @P_DTEMP SET DEDU_39 = ISNULL(DEDU_39, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '040') 
        UPDATE @P_DTEMP SET DEDU_40 = ISNULL(DEDU_40, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '041') 
        UPDATE @P_DTEMP SET DEDU_41 = ISNULL(DEDU_41, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '042') 
        UPDATE @P_DTEMP SET DEDU_42 = ISNULL(DEDU_42, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '043') 
        UPDATE @P_DTEMP SET DEDU_43 = ISNULL(DEDU_43, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '044') 
        UPDATE @P_DTEMP SET DEDU_44 = ISNULL(DEDU_44, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '045') 
        UPDATE @P_DTEMP SET DEDU_45 = ISNULL(DEDU_45, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '046') 
        UPDATE @P_DTEMP SET DEDU_46 = ISNULL(DEDU_46, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '047') 
        UPDATE @P_DTEMP SET DEDU_47 = ISNULL(DEDU_47, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '048') 
        UPDATE @P_DTEMP SET DEDU_48 = ISNULL(DEDU_48, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '049') 
        UPDATE @P_DTEMP SET DEDU_49 = ISNULL(DEDU_49, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '050') 
        UPDATE @P_DTEMP SET DEDU_50 = ISNULL(DEDU_50, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '051') 
        UPDATE @P_DTEMP SET DEDU_51 = ISNULL(DEDU_51, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '052') 
        UPDATE @P_DTEMP SET DEDU_52 = ISNULL(DEDU_52, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '053') 
        UPDATE @P_DTEMP SET DEDU_53 = ISNULL(DEDU_53, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '054') 
        UPDATE @P_DTEMP SET DEDU_54 = ISNULL(DEDU_54, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '055') 
        UPDATE @P_DTEMP SET DEDU_55 = ISNULL(DEDU_55, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '056') 
        UPDATE @P_DTEMP SET DEDU_56 = ISNULL(DEDU_56, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '057') 
        UPDATE @P_DTEMP SET DEDU_57 = ISNULL(DEDU_57, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '058') 
        UPDATE @P_DTEMP SET DEDU_58 = ISNULL(DEDU_58, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '059') 
        UPDATE @P_DTEMP SET DEDU_59 = ISNULL(DEDU_59, 0) + ISNULL(AM_INCOMTAX, 0)
    ELSE IF(@P_CD_REPORT = '060') 
        UPDATE @P_DTEMP SET DEDU_60 = ISNULL(DEDU_60, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '061') 
        UPDATE @P_DTEMP SET DEDU_61 = ISNULL(DEDU_61, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '062') 
        UPDATE @P_DTEMP SET DEDU_62 = ISNULL(DEDU_62, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '063') 
        UPDATE @P_DTEMP SET DEDU_63 = ISNULL(DEDU_63, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '064') 
        UPDATE @P_DTEMP SET DEDU_64 = ISNULL(DEDU_64, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '065') 
        UPDATE @P_DTEMP SET DEDU_65 = ISNULL(DEDU_65, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '066') 
        UPDATE @P_DTEMP SET DEDU_66 = ISNULL(DEDU_66, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '067') 
        UPDATE @P_DTEMP SET DEDU_67 = ISNULL(DEDU_67, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '068') 
        UPDATE @P_DTEMP SET DEDU_68 = ISNULL(DEDU_68, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '069') 
        UPDATE @P_DTEMP SET DEDU_69 = ISNULL(DEDU_69, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '070') 
        UPDATE @P_DTEMP SET DEDU_70 = ISNULL(DEDU_70, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '071') 
        UPDATE @P_DTEMP SET DEDU_71 = ISNULL(DEDU_71, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '072') 
        UPDATE @P_DTEMP SET DEDU_72 = ISNULL(DEDU_72, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '073') 
        UPDATE @P_DTEMP SET DEDU_73 = ISNULL(DEDU_73, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '074') 
        UPDATE @P_DTEMP SET DEDU_74 = ISNULL(DEDU_74, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '075') 
        UPDATE @P_DTEMP SET DEDU_75 = ISNULL(DEDU_75, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '076') 
        UPDATE @P_DTEMP SET DEDU_76 = ISNULL(DEDU_76, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '077') 
        UPDATE @P_DTEMP SET DEDU_77 = ISNULL(DEDU_77, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '078') 
        UPDATE @P_DTEMP SET DEDU_78 = ISNULL(DEDU_78, 0) + ISNULL(AM_INCOMTAX, 0) 
    ELSE IF(@P_CD_REPORT = '079') 
        UPDATE @P_DTEMP SET DEDU_79 = ISNULL(DEDU_79, 0) + ISNULL(AM_INCOMTAX, 0)      
    ELSE IF(@P_CD_REPORT = '080') 
        UPDATE @P_DTEMP SET DEDU_80 = ISNULL(DEDU_80, 0) + ISNULL(AM_INCOMTAX, 0)
END 


--급여 소득세 계산    
SET @P_CD_REPORT = NULL --초기화    
    
SELECT @P_CD_REPORT = CD_REPORT    
FROM HR_PREPFORM     
WHERE CD_COMPANY  = @P_CD_COMPANY_L    
AND  TP_REPORT  = @P_TP_REPORT    
AND  TP_PDREPORT  = '002'    
AND  CD_PAYDEDUCT = 'STX1'    
    
IF(@P_CD_REPORT IS NOT NULL)    
BEGIN    
	IF(@P_CD_REPORT = '001')    
		UPDATE @P_DTEMP SET DEDU_01 = ISNULL(DEDU_01, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '002')    
		UPDATE @P_DTEMP SET DEDU_02 = ISNULL(DEDU_02, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '003')    
		UPDATE @P_DTEMP SET DEDU_03 = ISNULL(DEDU_03, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '004')    
		UPDATE @P_DTEMP SET DEDU_04 = ISNULL(DEDU_04, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '005')    
		UPDATE @P_DTEMP SET DEDU_05 = ISNULL(DEDU_05, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '006')    
		UPDATE @P_DTEMP SET DEDU_06 = ISNULL(DEDU_06, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '007')    
		UPDATE @P_DTEMP SET DEDU_07 = ISNULL(DEDU_07, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '008')    
		UPDATE @P_DTEMP SET DEDU_08 = ISNULL(DEDU_08, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '009')    
		UPDATE @P_DTEMP SET DEDU_09 = ISNULL(DEDU_09, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '010')    
		UPDATE @P_DTEMP SET DEDU_10 = ISNULL(DEDU_10, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '011')    
		UPDATE @P_DTEMP SET DEDU_11 = ISNULL(DEDU_11, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '012')    
		UPDATE @P_DTEMP SET DEDU_12 = ISNULL(DEDU_12, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '013')    
		UPDATE @P_DTEMP SET DEDU_13 = ISNULL(DEDU_13, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '014')    
		UPDATE @P_DTEMP SET DEDU_14 = ISNULL(DEDU_14, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '015')    
		UPDATE @P_DTEMP SET DEDU_15 = ISNULL(DEDU_15, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '016')    
		UPDATE @P_DTEMP SET DEDU_16 = ISNULL(DEDU_16, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '017')    
		UPDATE @P_DTEMP SET DEDU_17 = ISNULL(DEDU_17, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '018')    
		UPDATE @P_DTEMP SET DEDU_18 = ISNULL(DEDU_18, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '019')    
		UPDATE @P_DTEMP SET DEDU_19 = ISNULL(DEDU_19, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '020')    
		UPDATE @P_DTEMP SET DEDU_20 = ISNULL(DEDU_20, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '021')    
		UPDATE @P_DTEMP SET DEDU_21 = ISNULL(DEDU_21, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '022')    
		UPDATE @P_DTEMP SET DEDU_22 = ISNULL(DEDU_22, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '023')    
		UPDATE @P_DTEMP SET DEDU_23 = ISNULL(DEDU_23, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '024')    
		UPDATE @P_DTEMP SET DEDU_24 = ISNULL(DEDU_24, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '025')    
		UPDATE @P_DTEMP SET DEDU_25 = ISNULL(DEDU_25, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '026')    
		UPDATE @P_DTEMP SET DEDU_26 = ISNULL(DEDU_26, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '027')    
		UPDATE @P_DTEMP SET DEDU_27 = ISNULL(DEDU_27, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '028')    
		UPDATE @P_DTEMP SET DEDU_28 = ISNULL(DEDU_28, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '029')    
		UPDATE @P_DTEMP SET DEDU_29 = ISNULL(DEDU_29, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '030')    
		UPDATE @P_DTEMP SET DEDU_30 = ISNULL(DEDU_30, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '031')    
		UPDATE @P_DTEMP SET DEDU_31 = ISNULL(DEDU_31, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '032')    
		UPDATE @P_DTEMP SET DEDU_32 = ISNULL(DEDU_32, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '033')    
		UPDATE @P_DTEMP SET DEDU_33 = ISNULL(DEDU_33, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '034')    
		UPDATE @P_DTEMP SET DEDU_34 = ISNULL(DEDU_34, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '035')    
		UPDATE @P_DTEMP SET DEDU_35 = ISNULL(DEDU_35, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '036')    
		UPDATE @P_DTEMP SET DEDU_36 = ISNULL(DEDU_36, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '037')    
		UPDATE @P_DTEMP SET DEDU_37 = ISNULL(DEDU_37, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '038')    
		UPDATE @P_DTEMP SET DEDU_38 = ISNULL(DEDU_38, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '039')    
		UPDATE @P_DTEMP SET DEDU_39 = ISNULL(DEDU_39, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '040')    
		UPDATE @P_DTEMP SET DEDU_40 = ISNULL(DEDU_40, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'    
    ELSE IF(@P_CD_REPORT = '041') 
        UPDATE @P_DTEMP SET DEDU_41 = ISNULL(DEDU_41, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '042') 
        UPDATE @P_DTEMP SET DEDU_42 = ISNULL(DEDU_42, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '043') 
        UPDATE @P_DTEMP SET DEDU_43 = ISNULL(DEDU_43, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '044') 
        UPDATE @P_DTEMP SET DEDU_44 = ISNULL(DEDU_44, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '045') 
        UPDATE @P_DTEMP SET DEDU_45 = ISNULL(DEDU_45, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '046') 
        UPDATE @P_DTEMP SET DEDU_46 = ISNULL(DEDU_46, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '047') 
        UPDATE @P_DTEMP SET DEDU_47 = ISNULL(DEDU_47, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '048') 
        UPDATE @P_DTEMP SET DEDU_48 = ISNULL(DEDU_48, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '049') 
        UPDATE @P_DTEMP SET DEDU_49 = ISNULL(DEDU_49, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '050') 
        UPDATE @P_DTEMP SET DEDU_50 = ISNULL(DEDU_50, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '051') 
        UPDATE @P_DTEMP SET DEDU_51 = ISNULL(DEDU_51, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '052') 
        UPDATE @P_DTEMP SET DEDU_52 = ISNULL(DEDU_52, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '053') 
        UPDATE @P_DTEMP SET DEDU_53 = ISNULL(DEDU_53, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '054') 
        UPDATE @P_DTEMP SET DEDU_54 = ISNULL(DEDU_54, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '055') 
        UPDATE @P_DTEMP SET DEDU_55 = ISNULL(DEDU_55, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '056') 
        UPDATE @P_DTEMP SET DEDU_56 = ISNULL(DEDU_56, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '057') 
        UPDATE @P_DTEMP SET DEDU_57 = ISNULL(DEDU_57, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '058') 
        UPDATE @P_DTEMP SET DEDU_58 = ISNULL(DEDU_58, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '059') 
        UPDATE @P_DTEMP SET DEDU_59 = ISNULL(DEDU_59, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'
    ELSE IF(@P_CD_REPORT = '060') 
        UPDATE @P_DTEMP SET DEDU_60 = ISNULL(DEDU_60, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '061') 
        UPDATE @P_DTEMP SET DEDU_61 = ISNULL(DEDU_61, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '062') 
        UPDATE @P_DTEMP SET DEDU_62 = ISNULL(DEDU_62, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '063') 
        UPDATE @P_DTEMP SET DEDU_63 = ISNULL(DEDU_63, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '064') 
        UPDATE @P_DTEMP SET DEDU_64 = ISNULL(DEDU_64, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '065') 
        UPDATE @P_DTEMP SET DEDU_65 = ISNULL(DEDU_65, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '066') 
        UPDATE @P_DTEMP SET DEDU_66 = ISNULL(DEDU_66, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '067') 
        UPDATE @P_DTEMP SET DEDU_67 = ISNULL(DEDU_67, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '068') 
        UPDATE @P_DTEMP SET DEDU_68 = ISNULL(DEDU_68, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '069') 
        UPDATE @P_DTEMP SET DEDU_69 = ISNULL(DEDU_69, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '070') 
        UPDATE @P_DTEMP SET DEDU_70 = ISNULL(DEDU_70, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '071') 
        UPDATE @P_DTEMP SET DEDU_71 = ISNULL(DEDU_71, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '072') 
        UPDATE @P_DTEMP SET DEDU_72 = ISNULL(DEDU_72, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '073') 
        UPDATE @P_DTEMP SET DEDU_73 = ISNULL(DEDU_73, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '074') 
        UPDATE @P_DTEMP SET DEDU_74 = ISNULL(DEDU_74, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '075') 
        UPDATE @P_DTEMP SET DEDU_75 = ISNULL(DEDU_75, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '076') 
        UPDATE @P_DTEMP SET DEDU_76 = ISNULL(DEDU_76, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '077') 
        UPDATE @P_DTEMP SET DEDU_77 = ISNULL(DEDU_77, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '078') 
        UPDATE @P_DTEMP SET DEDU_78 = ISNULL(DEDU_78, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '079') 
        UPDATE @P_DTEMP SET DEDU_79 = ISNULL(DEDU_79, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'      
    ELSE IF(@P_CD_REPORT = '080') 
        UPDATE @P_DTEMP SET DEDU_80 = ISNULL(DEDU_80, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '001'  
END    
    
--상여 소득세 계산    
SET @P_CD_REPORT = NULL --초기화    
    
SELECT @P_CD_REPORT = CD_REPORT    
FROM HR_PREPFORM     
WHERE CD_COMPANY  = @P_CD_COMPANY_L    
AND  TP_REPORT  = @P_TP_REPORT    
AND  TP_PDREPORT  = '002'    
AND  CD_PAYDEDUCT = 'STX2'    
    
IF(@P_CD_REPORT IS NOT NULL)    
BEGIN    
	IF(@P_CD_REPORT = '001')    
		UPDATE @P_DTEMP SET DEDU_01 = ISNULL(DEDU_01, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '002')    
		UPDATE @P_DTEMP SET DEDU_02 = ISNULL(DEDU_02, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '003')    
		UPDATE @P_DTEMP SET DEDU_03 = ISNULL(DEDU_03, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '004')    
		UPDATE @P_DTEMP SET DEDU_04 = ISNULL(DEDU_04, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '005')    
		UPDATE @P_DTEMP SET DEDU_05 = ISNULL(DEDU_05, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '006')    
		UPDATE @P_DTEMP SET DEDU_06 = ISNULL(DEDU_06, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '007')    
		UPDATE @P_DTEMP SET DEDU_07 = ISNULL(DEDU_07, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '008')    
		UPDATE @P_DTEMP SET DEDU_08 = ISNULL(DEDU_08, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '009')    
		UPDATE @P_DTEMP SET DEDU_09 = ISNULL(DEDU_09, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '010')    
		UPDATE @P_DTEMP SET DEDU_10 = ISNULL(DEDU_10, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '011')    
		UPDATE @P_DTEMP SET DEDU_11 = ISNULL(DEDU_11, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '012')    
		UPDATE @P_DTEMP SET DEDU_12 = ISNULL(DEDU_12, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '013')    
		UPDATE @P_DTEMP SET DEDU_13 = ISNULL(DEDU_13, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '014')    
		UPDATE @P_DTEMP SET DEDU_14 = ISNULL(DEDU_14, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '015')    
		UPDATE @P_DTEMP SET DEDU_15 = ISNULL(DEDU_15, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '016')    
		UPDATE @P_DTEMP SET DEDU_16 = ISNULL(DEDU_16, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '017')    
		UPDATE @P_DTEMP SET DEDU_17 = ISNULL(DEDU_17, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '018')    
		UPDATE @P_DTEMP SET DEDU_18 = ISNULL(DEDU_18, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '019')    
		UPDATE @P_DTEMP SET DEDU_19 = ISNULL(DEDU_19, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '020')    
		UPDATE @P_DTEMP SET DEDU_20 = ISNULL(DEDU_20, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '021')    
		UPDATE @P_DTEMP SET DEDU_21 = ISNULL(DEDU_21, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '022')    
		UPDATE @P_DTEMP SET DEDU_22 = ISNULL(DEDU_22, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '023')    
		UPDATE @P_DTEMP SET DEDU_23 = ISNULL(DEDU_23, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '024')    
		UPDATE @P_DTEMP SET DEDU_24 = ISNULL(DEDU_24, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '025')    
		UPDATE @P_DTEMP SET DEDU_25 = ISNULL(DEDU_25, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '026')    
		UPDATE @P_DTEMP SET DEDU_26 = ISNULL(DEDU_26, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '027')    
		UPDATE @P_DTEMP SET DEDU_27 = ISNULL(DEDU_27, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '028')    
		UPDATE @P_DTEMP SET DEDU_28 = ISNULL(DEDU_28, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '029')    
		UPDATE @P_DTEMP SET DEDU_29 = ISNULL(DEDU_29, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '030')    
		UPDATE @P_DTEMP SET DEDU_30 = ISNULL(DEDU_30, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '031')    
		UPDATE @P_DTEMP SET DEDU_31 = ISNULL(DEDU_31, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '032')    
		UPDATE @P_DTEMP SET DEDU_32 = ISNULL(DEDU_32, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '033')    
		UPDATE @P_DTEMP SET DEDU_33 = ISNULL(DEDU_33, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '034')    
		UPDATE @P_DTEMP SET DEDU_34 = ISNULL(DEDU_34, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '035')    
		UPDATE @P_DTEMP SET DEDU_35 = ISNULL(DEDU_35, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '036')    
		UPDATE @P_DTEMP SET DEDU_36 = ISNULL(DEDU_36, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '037')    
		UPDATE @P_DTEMP SET DEDU_37 = ISNULL(DEDU_37, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '038')    
		UPDATE @P_DTEMP SET DEDU_38 = ISNULL(DEDU_38, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '039')    
		UPDATE @P_DTEMP SET DEDU_39 = ISNULL(DEDU_39, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '040')    
		UPDATE @P_DTEMP SET DEDU_40 = ISNULL(DEDU_40, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'    
    ELSE IF(@P_CD_REPORT = '041') 
        UPDATE @P_DTEMP SET DEDU_41 = ISNULL(DEDU_41, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '042') 
        UPDATE @P_DTEMP SET DEDU_42 = ISNULL(DEDU_42, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '043') 
        UPDATE @P_DTEMP SET DEDU_43 = ISNULL(DEDU_43, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '044') 
        UPDATE @P_DTEMP SET DEDU_44 = ISNULL(DEDU_44, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '045') 
        UPDATE @P_DTEMP SET DEDU_45 = ISNULL(DEDU_45, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '046') 
        UPDATE @P_DTEMP SET DEDU_46 = ISNULL(DEDU_46, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '047') 
        UPDATE @P_DTEMP SET DEDU_47 = ISNULL(DEDU_47, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '048') 
        UPDATE @P_DTEMP SET DEDU_48 = ISNULL(DEDU_48, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '049') 
        UPDATE @P_DTEMP SET DEDU_49 = ISNULL(DEDU_49, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '050') 
        UPDATE @P_DTEMP SET DEDU_50 = ISNULL(DEDU_50, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '051') 
        UPDATE @P_DTEMP SET DEDU_51 = ISNULL(DEDU_51, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '052') 
        UPDATE @P_DTEMP SET DEDU_52 = ISNULL(DEDU_52, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '053') 
        UPDATE @P_DTEMP SET DEDU_53 = ISNULL(DEDU_53, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '054') 
        UPDATE @P_DTEMP SET DEDU_54 = ISNULL(DEDU_54, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '055') 
        UPDATE @P_DTEMP SET DEDU_55 = ISNULL(DEDU_55, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '056') 
        UPDATE @P_DTEMP SET DEDU_56 = ISNULL(DEDU_56, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '057') 
        UPDATE @P_DTEMP SET DEDU_57 = ISNULL(DEDU_57, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '058') 
        UPDATE @P_DTEMP SET DEDU_58 = ISNULL(DEDU_58, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '059') 
        UPDATE @P_DTEMP SET DEDU_59 = ISNULL(DEDU_59, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'
    ELSE IF(@P_CD_REPORT = '060') 
        UPDATE @P_DTEMP SET DEDU_60 = ISNULL(DEDU_60, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '061') 
        UPDATE @P_DTEMP SET DEDU_61 = ISNULL(DEDU_61, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '062') 
        UPDATE @P_DTEMP SET DEDU_62 = ISNULL(DEDU_62, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '063') 
        UPDATE @P_DTEMP SET DEDU_63 = ISNULL(DEDU_63, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '064') 
        UPDATE @P_DTEMP SET DEDU_64 = ISNULL(DEDU_64, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '065') 
        UPDATE @P_DTEMP SET DEDU_65 = ISNULL(DEDU_65, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '066') 
        UPDATE @P_DTEMP SET DEDU_66 = ISNULL(DEDU_66, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '067') 
        UPDATE @P_DTEMP SET DEDU_67 = ISNULL(DEDU_67, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '068') 
        UPDATE @P_DTEMP SET DEDU_68 = ISNULL(DEDU_68, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '069') 
        UPDATE @P_DTEMP SET DEDU_69 = ISNULL(DEDU_69, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '070') 
        UPDATE @P_DTEMP SET DEDU_70 = ISNULL(DEDU_70, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '071') 
        UPDATE @P_DTEMP SET DEDU_71 = ISNULL(DEDU_71, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '072') 
        UPDATE @P_DTEMP SET DEDU_72 = ISNULL(DEDU_72, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '073') 
        UPDATE @P_DTEMP SET DEDU_73 = ISNULL(DEDU_73, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '074') 
        UPDATE @P_DTEMP SET DEDU_74 = ISNULL(DEDU_74, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '075') 
        UPDATE @P_DTEMP SET DEDU_75 = ISNULL(DEDU_75, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '076') 
        UPDATE @P_DTEMP SET DEDU_76 = ISNULL(DEDU_76, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '077') 
        UPDATE @P_DTEMP SET DEDU_77 = ISNULL(DEDU_77, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '078') 
        UPDATE @P_DTEMP SET DEDU_78 = ISNULL(DEDU_78, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '079') 
        UPDATE @P_DTEMP SET DEDU_79 = ISNULL(DEDU_79, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002'      
    ELSE IF(@P_CD_REPORT = '080') 
        UPDATE @P_DTEMP SET DEDU_80 = ISNULL(DEDU_80, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '002' 
END    
    
    
--연월차 소득세 계산    
SET @P_CD_REPORT = NULL --초기화    
    
SELECT @P_CD_REPORT = CD_REPORT    
FROM HR_PREPFORM     
WHERE CD_COMPANY  = @P_CD_COMPANY_L    
AND  TP_REPORT  = @P_TP_REPORT    
AND  TP_PDREPORT  = '002'    
AND  CD_PAYDEDUCT = 'STX3'    
    
IF(@P_CD_REPORT IS NOT NULL)    
BEGIN    
	IF(@P_CD_REPORT = '001')    
		UPDATE @P_DTEMP SET DEDU_01 = ISNULL(DEDU_01, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '002')    
		UPDATE @P_DTEMP SET DEDU_02 = ISNULL(DEDU_02, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '003')    
		UPDATE @P_DTEMP SET DEDU_03 = ISNULL(DEDU_03, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '004')    
		UPDATE @P_DTEMP SET DEDU_04 = ISNULL(DEDU_04, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '005')    
		UPDATE @P_DTEMP SET DEDU_05 = ISNULL(DEDU_05, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '006')    
		UPDATE @P_DTEMP SET DEDU_06 = ISNULL(DEDU_06, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '007')    
		UPDATE @P_DTEMP SET DEDU_07 = ISNULL(DEDU_07, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '008')    
		UPDATE @P_DTEMP SET DEDU_08 = ISNULL(DEDU_08, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '009')    
		UPDATE @P_DTEMP SET DEDU_09 = ISNULL(DEDU_09, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '010')    
		UPDATE @P_DTEMP SET DEDU_10 = ISNULL(DEDU_10, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '011')    
		UPDATE @P_DTEMP SET DEDU_11 = ISNULL(DEDU_11, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '012')    
		UPDATE @P_DTEMP SET DEDU_12 = ISNULL(DEDU_12, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '013')    
		UPDATE @P_DTEMP SET DEDU_13 = ISNULL(DEDU_13, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '014')    
		UPDATE @P_DTEMP SET DEDU_14 = ISNULL(DEDU_14, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '015')    
		UPDATE @P_DTEMP SET DEDU_15 = ISNULL(DEDU_15, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '016')    
		UPDATE @P_DTEMP SET DEDU_16 = ISNULL(DEDU_16, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '017')    
		UPDATE @P_DTEMP SET DEDU_17 = ISNULL(DEDU_17, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '018')    
		UPDATE @P_DTEMP SET DEDU_18 = ISNULL(DEDU_18, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '019')    
		UPDATE @P_DTEMP SET DEDU_19 = ISNULL(DEDU_19, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '020')    
		UPDATE @P_DTEMP SET DEDU_20 = ISNULL(DEDU_20, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '021')    
		UPDATE @P_DTEMP SET DEDU_21 = ISNULL(DEDU_21, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '022')    
		UPDATE @P_DTEMP SET DEDU_22 = ISNULL(DEDU_22, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '023')    
		UPDATE @P_DTEMP SET DEDU_23 = ISNULL(DEDU_23, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '024')    
		UPDATE @P_DTEMP SET DEDU_24 = ISNULL(DEDU_24, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '025')    
		UPDATE @P_DTEMP SET DEDU_25 = ISNULL(DEDU_25, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '026')    
		UPDATE @P_DTEMP SET DEDU_26 = ISNULL(DEDU_26, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '027')    
		UPDATE @P_DTEMP SET DEDU_27 = ISNULL(DEDU_27, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '028')    
		UPDATE @P_DTEMP SET DEDU_28 = ISNULL(DEDU_28, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '029')    
		UPDATE @P_DTEMP SET DEDU_29 = ISNULL(DEDU_29, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '030')    
		UPDATE @P_DTEMP SET DEDU_30 = ISNULL(DEDU_30, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '031')    
		UPDATE @P_DTEMP SET DEDU_31 = ISNULL(DEDU_31, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '032')    
		UPDATE @P_DTEMP SET DEDU_32 = ISNULL(DEDU_32, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '033')    
		UPDATE @P_DTEMP SET DEDU_33 = ISNULL(DEDU_33, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '034')    
		UPDATE @P_DTEMP SET DEDU_34 = ISNULL(DEDU_34, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '035')    
		UPDATE @P_DTEMP SET DEDU_35 = ISNULL(DEDU_35, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '036')    
		UPDATE @P_DTEMP SET DEDU_36 = ISNULL(DEDU_36, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '037')    
		UPDATE @P_DTEMP SET DEDU_37 = ISNULL(DEDU_37, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '038')    
		UPDATE @P_DTEMP SET DEDU_38 = ISNULL(DEDU_38, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '039')    
		UPDATE @P_DTEMP SET DEDU_39 = ISNULL(DEDU_39, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '040')    
		UPDATE @P_DTEMP SET DEDU_40 = ISNULL(DEDU_40, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'    
    ELSE IF(@P_CD_REPORT = '041') 
        UPDATE @P_DTEMP SET DEDU_41 = ISNULL(DEDU_41, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '042') 
        UPDATE @P_DTEMP SET DEDU_42 = ISNULL(DEDU_42, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '043') 
        UPDATE @P_DTEMP SET DEDU_43 = ISNULL(DEDU_43, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '044') 
        UPDATE @P_DTEMP SET DEDU_44 = ISNULL(DEDU_44, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '045') 
        UPDATE @P_DTEMP SET DEDU_45 = ISNULL(DEDU_45, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '046') 
        UPDATE @P_DTEMP SET DEDU_46 = ISNULL(DEDU_46, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '047') 
        UPDATE @P_DTEMP SET DEDU_47 = ISNULL(DEDU_47, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '048') 
        UPDATE @P_DTEMP SET DEDU_48 = ISNULL(DEDU_48, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '049') 
        UPDATE @P_DTEMP SET DEDU_49 = ISNULL(DEDU_49, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '050') 
        UPDATE @P_DTEMP SET DEDU_50 = ISNULL(DEDU_50, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '051') 
        UPDATE @P_DTEMP SET DEDU_51 = ISNULL(DEDU_51, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '052') 
        UPDATE @P_DTEMP SET DEDU_52 = ISNULL(DEDU_52, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '053') 
        UPDATE @P_DTEMP SET DEDU_53 = ISNULL(DEDU_53, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '054') 
        UPDATE @P_DTEMP SET DEDU_54 = ISNULL(DEDU_54, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '055') 
        UPDATE @P_DTEMP SET DEDU_55 = ISNULL(DEDU_55, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '056') 
        UPDATE @P_DTEMP SET DEDU_56 = ISNULL(DEDU_56, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '057') 
        UPDATE @P_DTEMP SET DEDU_57 = ISNULL(DEDU_57, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '058') 
        UPDATE @P_DTEMP SET DEDU_58 = ISNULL(DEDU_58, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '059') 
        UPDATE @P_DTEMP SET DEDU_59 = ISNULL(DEDU_59, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'
    ELSE IF(@P_CD_REPORT = '060') 
        UPDATE @P_DTEMP SET DEDU_60 = ISNULL(DEDU_60, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '061') 
        UPDATE @P_DTEMP SET DEDU_61 = ISNULL(DEDU_61, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '062') 
        UPDATE @P_DTEMP SET DEDU_62 = ISNULL(DEDU_62, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '063') 
        UPDATE @P_DTEMP SET DEDU_63 = ISNULL(DEDU_63, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '064') 
        UPDATE @P_DTEMP SET DEDU_64 = ISNULL(DEDU_64, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '065') 
        UPDATE @P_DTEMP SET DEDU_65 = ISNULL(DEDU_65, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '066') 
        UPDATE @P_DTEMP SET DEDU_66 = ISNULL(DEDU_66, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '067') 
        UPDATE @P_DTEMP SET DEDU_67 = ISNULL(DEDU_67, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '068') 
        UPDATE @P_DTEMP SET DEDU_68 = ISNULL(DEDU_68, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '069') 
        UPDATE @P_DTEMP SET DEDU_69 = ISNULL(DEDU_69, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '070') 
        UPDATE @P_DTEMP SET DEDU_70 = ISNULL(DEDU_70, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '071') 
        UPDATE @P_DTEMP SET DEDU_71 = ISNULL(DEDU_71, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '072') 
        UPDATE @P_DTEMP SET DEDU_72 = ISNULL(DEDU_72, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '073') 
        UPDATE @P_DTEMP SET DEDU_73 = ISNULL(DEDU_73, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '074') 
        UPDATE @P_DTEMP SET DEDU_74 = ISNULL(DEDU_74, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '075') 
        UPDATE @P_DTEMP SET DEDU_75 = ISNULL(DEDU_75, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '076') 
        UPDATE @P_DTEMP SET DEDU_76 = ISNULL(DEDU_76, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '077') 
        UPDATE @P_DTEMP SET DEDU_77 = ISNULL(DEDU_77, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '078') 
        UPDATE @P_DTEMP SET DEDU_78 = ISNULL(DEDU_78, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '079') 
        UPDATE @P_DTEMP SET DEDU_79 = ISNULL(DEDU_79, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'      
    ELSE IF(@P_CD_REPORT = '080') 
        UPDATE @P_DTEMP SET DEDU_80 = ISNULL(DEDU_80, 0) + ISNULL(AM_INCOMTAX, 0) WHERE 급여구분 = '003'   
END    

 
--소득세 변수로 사용후 주민세 이용시 해당값이 초기화가 안되어
--값을 인지하여 오류 발생함
SET @P_CD_REPORT = NULL

--주민세
SELECT    @P_CD_REPORT = CD_REPORT 
FROM    HR_PREPFORM  
WHERE    CD_COMPANY    = @P_CD_COMPANY_L 
AND    TP_REPORT    = @P_TP_REPORT 
AND    TP_PDREPORT    = '002' 
AND    CD_PAYDEDUCT    = 'JTX' 
 
IF(@P_CD_REPORT IS NOT NULL) 
BEGIN 
    IF(@P_CD_REPORT = '001') 
        UPDATE @P_DTEMP SET DEDU_01 = ISNULL(DEDU_01, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '002') 
        UPDATE @P_DTEMP SET DEDU_02 = ISNULL(DEDU_02, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '003') 
        UPDATE @P_DTEMP SET DEDU_03 = ISNULL(DEDU_03, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '004') 
        UPDATE @P_DTEMP SET DEDU_04 = ISNULL(DEDU_04, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '005') 
        UPDATE @P_DTEMP SET DEDU_05 = ISNULL(DEDU_05, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '006') 
        UPDATE @P_DTEMP SET DEDU_06 = ISNULL(DEDU_06, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '007') 
        UPDATE @P_DTEMP SET DEDU_07 = ISNULL(DEDU_07, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '008') 
        UPDATE @P_DTEMP SET DEDU_08 = ISNULL(DEDU_08, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '009') 
        UPDATE @P_DTEMP SET DEDU_09 = ISNULL(DEDU_09, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '010') 
        UPDATE @P_DTEMP SET DEDU_10 = ISNULL(DEDU_10, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '011') 
        UPDATE @P_DTEMP SET DEDU_11 = ISNULL(DEDU_11, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '012') 
        UPDATE @P_DTEMP SET DEDU_12 = ISNULL(DEDU_12, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '013') 
        UPDATE @P_DTEMP SET DEDU_13 = ISNULL(DEDU_13, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '014') 
        UPDATE @P_DTEMP SET DEDU_14 = ISNULL(DEDU_14, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '015') 
        UPDATE @P_DTEMP SET DEDU_15 = ISNULL(DEDU_15, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '016') 
        UPDATE @P_DTEMP SET DEDU_16 = ISNULL(DEDU_16, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '017') 
        UPDATE @P_DTEMP SET DEDU_17 = ISNULL(DEDU_17, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '018')  
        UPDATE @P_DTEMP SET DEDU_18 = ISNULL(DEDU_18, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '019') 
        UPDATE @P_DTEMP SET DEDU_19 = ISNULL(DEDU_19, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '020') 
        UPDATE @P_DTEMP SET DEDU_20 = ISNULL(DEDU_20, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '021') 
        UPDATE @P_DTEMP SET DEDU_21 = ISNULL(DEDU_21, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '022') 
        UPDATE @P_DTEMP SET DEDU_22 = ISNULL(DEDU_22, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '023') 
        UPDATE @P_DTEMP SET DEDU_23 = ISNULL(DEDU_23, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '024') 
        UPDATE @P_DTEMP SET DEDU_24 = ISNULL(DEDU_24, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '025') 
        UPDATE @P_DTEMP SET DEDU_25 = ISNULL(DEDU_25, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '026') 
        UPDATE @P_DTEMP SET DEDU_26 = ISNULL(DEDU_26, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '027') 
        UPDATE @P_DTEMP SET DEDU_27 = ISNULL(DEDU_27, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '028') 
        UPDATE @P_DTEMP SET DEDU_28 = ISNULL(DEDU_28, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '029') 
        UPDATE @P_DTEMP SET DEDU_29 = ISNULL(DEDU_29, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '030') 
        UPDATE @P_DTEMP SET DEDU_30 = ISNULL(DEDU_30, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '031') 
        UPDATE @P_DTEMP SET DEDU_31 = ISNULL(DEDU_31, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '032') 
        UPDATE @P_DTEMP SET DEDU_32 = ISNULL(DEDU_32, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '033') 
        UPDATE @P_DTEMP SET DEDU_33 = ISNULL(DEDU_33, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '034') 
        UPDATE @P_DTEMP SET DEDU_34 = ISNULL(DEDU_34, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '035') 
        UPDATE @P_DTEMP SET DEDU_35 = ISNULL(DEDU_35, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '036') 
        UPDATE @P_DTEMP SET DEDU_36 = ISNULL(DEDU_36, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '037') 
        UPDATE @P_DTEMP SET DEDU_37 = ISNULL(DEDU_37, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '038') 
        UPDATE @P_DTEMP SET DEDU_38 = ISNULL(DEDU_38, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '039') 
        UPDATE @P_DTEMP SET DEDU_39 = ISNULL(DEDU_39, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '040') 
        UPDATE @P_DTEMP SET DEDU_40 = ISNULL(DEDU_40, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '041') 
        UPDATE @P_DTEMP SET DEDU_41 = ISNULL(DEDU_41, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '042') 
        UPDATE @P_DTEMP SET DEDU_42 = ISNULL(DEDU_42, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '043') 
        UPDATE @P_DTEMP SET DEDU_43 = ISNULL(DEDU_43, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '044') 
        UPDATE @P_DTEMP SET DEDU_44 = ISNULL(DEDU_44, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '045') 
        UPDATE @P_DTEMP SET DEDU_45 = ISNULL(DEDU_45, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '046') 
        UPDATE @P_DTEMP SET DEDU_46 = ISNULL(DEDU_46, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '047') 
        UPDATE @P_DTEMP SET DEDU_47 = ISNULL(DEDU_47, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '048') 
        UPDATE @P_DTEMP SET DEDU_48 = ISNULL(DEDU_48, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '049') 
        UPDATE @P_DTEMP SET DEDU_49 = ISNULL(DEDU_49, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '050') 
        UPDATE @P_DTEMP SET DEDU_50 = ISNULL(DEDU_50, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '051') 
        UPDATE @P_DTEMP SET DEDU_51 = ISNULL(DEDU_51, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '052') 
        UPDATE @P_DTEMP SET DEDU_52 = ISNULL(DEDU_52, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '053') 
        UPDATE @P_DTEMP SET DEDU_53 = ISNULL(DEDU_53, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '054') 
        UPDATE @P_DTEMP SET DEDU_54 = ISNULL(DEDU_54, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '055') 
        UPDATE @P_DTEMP SET DEDU_55 = ISNULL(DEDU_55, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '056') 
        UPDATE @P_DTEMP SET DEDU_56 = ISNULL(DEDU_56, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '057') 
        UPDATE @P_DTEMP SET DEDU_57 = ISNULL(DEDU_57, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '058') 
        UPDATE @P_DTEMP SET DEDU_58 = ISNULL(DEDU_58, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '059') 
        UPDATE @P_DTEMP SET DEDU_59 = ISNULL(DEDU_59, 0) + ISNULL(AM_RESIDTAX, 0)
    ELSE IF(@P_CD_REPORT = '060') 
        UPDATE @P_DTEMP SET DEDU_60 = ISNULL(DEDU_60, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '061') 
        UPDATE @P_DTEMP SET DEDU_61 = ISNULL(DEDU_61, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '062') 
        UPDATE @P_DTEMP SET DEDU_62 = ISNULL(DEDU_62, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '063') 
        UPDATE @P_DTEMP SET DEDU_63 = ISNULL(DEDU_63, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '064') 
        UPDATE @P_DTEMP SET DEDU_64 = ISNULL(DEDU_64, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '065') 
        UPDATE @P_DTEMP SET DEDU_65 = ISNULL(DEDU_65, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '066') 
        UPDATE @P_DTEMP SET DEDU_66 = ISNULL(DEDU_66, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '067') 
        UPDATE @P_DTEMP SET DEDU_67 = ISNULL(DEDU_67, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '068') 
        UPDATE @P_DTEMP SET DEDU_68 = ISNULL(DEDU_68, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '069') 
        UPDATE @P_DTEMP SET DEDU_69 = ISNULL(DEDU_69, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '070') 
        UPDATE @P_DTEMP SET DEDU_70 = ISNULL(DEDU_70, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '071') 
        UPDATE @P_DTEMP SET DEDU_71 = ISNULL(DEDU_71, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '072') 
        UPDATE @P_DTEMP SET DEDU_72 = ISNULL(DEDU_72, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '073') 
        UPDATE @P_DTEMP SET DEDU_73 = ISNULL(DEDU_73, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '074') 
        UPDATE @P_DTEMP SET DEDU_74 = ISNULL(DEDU_74, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '075') 
        UPDATE @P_DTEMP SET DEDU_75 = ISNULL(DEDU_75, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '076') 
        UPDATE @P_DTEMP SET DEDU_76 = ISNULL(DEDU_76, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '077') 
        UPDATE @P_DTEMP SET DEDU_77 = ISNULL(DEDU_77, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '078') 
        UPDATE @P_DTEMP SET DEDU_78 = ISNULL(DEDU_78, 0) + ISNULL(AM_RESIDTAX, 0) 
    ELSE IF(@P_CD_REPORT = '079') 
        UPDATE @P_DTEMP SET DEDU_79 = ISNULL(DEDU_79, 0) + ISNULL(AM_RESIDTAX, 0)      
    ELSE IF(@P_CD_REPORT = '080') 
        UPDATE @P_DTEMP SET DEDU_80 = ISNULL(DEDU_80, 0) + ISNULL(AM_RESIDTAX, 0)        
END 


--급여 주민세 계산
SET @P_CD_REPORT = NULL

SELECT	@P_CD_REPORT	= CD_REPORT
FROM	HR_PREPFORM 
WHERE	CD_COMPANY		= @P_CD_COMPANY_L
AND		TP_REPORT		= @P_TP_REPORT
AND		TP_PDREPORT		= '002'
AND		CD_PAYDEDUCT	= 'JTX1'


IF(@P_CD_REPORT IS NOT NULL)
BEGIN
	IF(@P_CD_REPORT = '001')    
		UPDATE @P_DTEMP SET DEDU_01 = ISNULL(DEDU_01, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '002')    
		UPDATE @P_DTEMP SET DEDU_02 = ISNULL(DEDU_02, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '003')    
		UPDATE @P_DTEMP SET DEDU_03 = ISNULL(DEDU_03, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '004')    
		UPDATE @P_DTEMP SET DEDU_04 = ISNULL(DEDU_04, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '005')    
		UPDATE @P_DTEMP SET DEDU_05 = ISNULL(DEDU_05, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '006')    
		UPDATE @P_DTEMP SET DEDU_06 = ISNULL(DEDU_06, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '007')    
		UPDATE @P_DTEMP SET DEDU_07 = ISNULL(DEDU_07, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '008')    
		UPDATE @P_DTEMP SET DEDU_08 = ISNULL(DEDU_08, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '009')    
		UPDATE @P_DTEMP SET DEDU_09 = ISNULL(DEDU_09, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '010')    
		UPDATE @P_DTEMP SET DEDU_10 = ISNULL(DEDU_10, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '011')    
		UPDATE @P_DTEMP SET DEDU_11 = ISNULL(DEDU_11, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '012')    
		UPDATE @P_DTEMP SET DEDU_12 = ISNULL(DEDU_12, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '013')    
		UPDATE @P_DTEMP SET DEDU_13 = ISNULL(DEDU_13, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '014')    
		UPDATE @P_DTEMP SET DEDU_14 = ISNULL(DEDU_14, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '015')    
		UPDATE @P_DTEMP SET DEDU_15 = ISNULL(DEDU_15, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '016')    
		UPDATE @P_DTEMP SET DEDU_16 = ISNULL(DEDU_16, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '017')    
		UPDATE @P_DTEMP SET DEDU_17 = ISNULL(DEDU_17, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '018')    
		UPDATE @P_DTEMP SET DEDU_18 = ISNULL(DEDU_18, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '019')    
		UPDATE @P_DTEMP SET DEDU_19 = ISNULL(DEDU_19, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '020')    
		UPDATE @P_DTEMP SET DEDU_20 = ISNULL(DEDU_20, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '021')    
		UPDATE @P_DTEMP SET DEDU_21 = ISNULL(DEDU_21, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '022')    
		UPDATE @P_DTEMP SET DEDU_22 = ISNULL(DEDU_22, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '023')    
		UPDATE @P_DTEMP SET DEDU_23 = ISNULL(DEDU_23, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '024')    
		UPDATE @P_DTEMP SET DEDU_24 = ISNULL(DEDU_24, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '025')    
		UPDATE @P_DTEMP SET DEDU_25 = ISNULL(DEDU_25, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '026')    
		UPDATE @P_DTEMP SET DEDU_26 = ISNULL(DEDU_26, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '027')    
		UPDATE @P_DTEMP SET DEDU_27 = ISNULL(DEDU_27, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '028')    
		UPDATE @P_DTEMP SET DEDU_28 = ISNULL(DEDU_28, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '029')    
		UPDATE @P_DTEMP SET DEDU_29 = ISNULL(DEDU_29, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '030')    
		UPDATE @P_DTEMP SET DEDU_30 = ISNULL(DEDU_30, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '031')    
		UPDATE @P_DTEMP SET DEDU_31 = ISNULL(DEDU_31, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '032')    
		UPDATE @P_DTEMP SET DEDU_32 = ISNULL(DEDU_32, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '033')    
		UPDATE @P_DTEMP SET DEDU_33 = ISNULL(DEDU_33, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '034')    
		UPDATE @P_DTEMP SET DEDU_34 = ISNULL(DEDU_34, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '035')    
		UPDATE @P_DTEMP SET DEDU_35 = ISNULL(DEDU_35, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '036')    
		UPDATE @P_DTEMP SET DEDU_36 = ISNULL(DEDU_36, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '037')    
		UPDATE @P_DTEMP SET DEDU_37 = ISNULL(DEDU_37, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '038')    
		UPDATE @P_DTEMP SET DEDU_38 = ISNULL(DEDU_38, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '039')    
		UPDATE @P_DTEMP SET DEDU_39 = ISNULL(DEDU_39, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
	ELSE IF(@P_CD_REPORT = '040')    
		UPDATE @P_DTEMP SET DEDU_40 = ISNULL(DEDU_40, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'    
    ELSE IF(@P_CD_REPORT = '041') 
        UPDATE @P_DTEMP SET DEDU_41 = ISNULL(DEDU_41, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '042') 
        UPDATE @P_DTEMP SET DEDU_42 = ISNULL(DEDU_42, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '043') 
        UPDATE @P_DTEMP SET DEDU_43 = ISNULL(DEDU_43, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '044') 
        UPDATE @P_DTEMP SET DEDU_44 = ISNULL(DEDU_44, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '045') 
        UPDATE @P_DTEMP SET DEDU_45 = ISNULL(DEDU_45, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '046') 
        UPDATE @P_DTEMP SET DEDU_46 = ISNULL(DEDU_46, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '047') 
        UPDATE @P_DTEMP SET DEDU_47 = ISNULL(DEDU_47, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '048') 
        UPDATE @P_DTEMP SET DEDU_48 = ISNULL(DEDU_48, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '049') 
        UPDATE @P_DTEMP SET DEDU_49 = ISNULL(DEDU_49, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '050') 
        UPDATE @P_DTEMP SET DEDU_50 = ISNULL(DEDU_50, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '051') 
        UPDATE @P_DTEMP SET DEDU_51 = ISNULL(DEDU_51, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '052') 
        UPDATE @P_DTEMP SET DEDU_52 = ISNULL(DEDU_52, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '053') 
        UPDATE @P_DTEMP SET DEDU_53 = ISNULL(DEDU_53, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '054') 
        UPDATE @P_DTEMP SET DEDU_54 = ISNULL(DEDU_54, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '055') 
        UPDATE @P_DTEMP SET DEDU_55 = ISNULL(DEDU_55, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '056') 
        UPDATE @P_DTEMP SET DEDU_56 = ISNULL(DEDU_56, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '057') 
        UPDATE @P_DTEMP SET DEDU_57 = ISNULL(DEDU_57, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '058') 
        UPDATE @P_DTEMP SET DEDU_58 = ISNULL(DEDU_58, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '059') 
        UPDATE @P_DTEMP SET DEDU_59 = ISNULL(DEDU_59, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'
    ELSE IF(@P_CD_REPORT = '060') 
        UPDATE @P_DTEMP SET DEDU_60 = ISNULL(DEDU_60, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '061') 
        UPDATE @P_DTEMP SET DEDU_61 = ISNULL(DEDU_61, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '062') 
        UPDATE @P_DTEMP SET DEDU_62 = ISNULL(DEDU_62, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '063') 
        UPDATE @P_DTEMP SET DEDU_63 = ISNULL(DEDU_63, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '064') 
        UPDATE @P_DTEMP SET DEDU_64 = ISNULL(DEDU_64, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '065') 
        UPDATE @P_DTEMP SET DEDU_65 = ISNULL(DEDU_65, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '066') 
        UPDATE @P_DTEMP SET DEDU_66 = ISNULL(DEDU_66, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '067') 
        UPDATE @P_DTEMP SET DEDU_67 = ISNULL(DEDU_67, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '068') 
        UPDATE @P_DTEMP SET DEDU_68 = ISNULL(DEDU_68, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '069') 
        UPDATE @P_DTEMP SET DEDU_69 = ISNULL(DEDU_69, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '070') 
        UPDATE @P_DTEMP SET DEDU_70 = ISNULL(DEDU_70, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '071') 
        UPDATE @P_DTEMP SET DEDU_71 = ISNULL(DEDU_71, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '072') 
        UPDATE @P_DTEMP SET DEDU_72 = ISNULL(DEDU_72, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '073') 
        UPDATE @P_DTEMP SET DEDU_73 = ISNULL(DEDU_73, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '074') 
        UPDATE @P_DTEMP SET DEDU_74 = ISNULL(DEDU_74, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '075') 
        UPDATE @P_DTEMP SET DEDU_75 = ISNULL(DEDU_75, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '076') 
        UPDATE @P_DTEMP SET DEDU_76 = ISNULL(DEDU_76, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '077') 
        UPDATE @P_DTEMP SET DEDU_77 = ISNULL(DEDU_77, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '078') 
        UPDATE @P_DTEMP SET DEDU_78 = ISNULL(DEDU_78, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001' 
    ELSE IF(@P_CD_REPORT = '079') 
        UPDATE @P_DTEMP SET DEDU_79 = ISNULL(DEDU_79, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'      
    ELSE IF(@P_CD_REPORT = '080') 
        UPDATE @P_DTEMP SET DEDU_80 = ISNULL(DEDU_80, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '001'  
END

--상여 주민세 계산    
SET @P_CD_REPORT = NULL    
    
SELECT @P_CD_REPORT = CD_REPORT    
FROM HR_PREPFORM     
WHERE CD_COMPANY  = @P_CD_COMPANY_L    
AND  TP_REPORT  = @P_TP_REPORT    
AND  TP_PDREPORT  = '002'    
AND  CD_PAYDEDUCT = 'JTX2'    
    
IF(@P_CD_REPORT IS NOT NULL)    
BEGIN    
	IF(@P_CD_REPORT = '001')    
		UPDATE @P_DTEMP SET DEDU_01 = ISNULL(DEDU_01, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '002')    
		UPDATE @P_DTEMP SET DEDU_02 = ISNULL(DEDU_02, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '003')    
		UPDATE @P_DTEMP SET DEDU_03 = ISNULL(DEDU_03, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '004')    
		UPDATE @P_DTEMP SET DEDU_04 = ISNULL(DEDU_04, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '005')    
		UPDATE @P_DTEMP SET DEDU_05 = ISNULL(DEDU_05, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '006')    
		UPDATE @P_DTEMP SET DEDU_06 = ISNULL(DEDU_06, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '007')    
		UPDATE @P_DTEMP SET DEDU_07 = ISNULL(DEDU_07, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '008')    
		UPDATE @P_DTEMP SET DEDU_08 = ISNULL(DEDU_08, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '009')    
		UPDATE @P_DTEMP SET DEDU_09 = ISNULL(DEDU_09, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '010')    
		UPDATE @P_DTEMP SET DEDU_10 = ISNULL(DEDU_10, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '011')    
		UPDATE @P_DTEMP SET DEDU_11 = ISNULL(DEDU_11, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '012')    
		UPDATE @P_DTEMP SET DEDU_12 = ISNULL(DEDU_12, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '013')    
		UPDATE @P_DTEMP SET DEDU_13 = ISNULL(DEDU_13, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '014')    
		UPDATE @P_DTEMP SET DEDU_14 = ISNULL(DEDU_14, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '015')    
		UPDATE @P_DTEMP SET DEDU_15 = ISNULL(DEDU_15, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '016')    
		UPDATE @P_DTEMP SET DEDU_16 = ISNULL(DEDU_16, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '017')    
		UPDATE @P_DTEMP SET DEDU_17 = ISNULL(DEDU_17, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '018')    
		UPDATE @P_DTEMP SET DEDU_18 = ISNULL(DEDU_18, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '019')    
		UPDATE @P_DTEMP SET DEDU_19 = ISNULL(DEDU_19, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '020')    
		UPDATE @P_DTEMP SET DEDU_20 = ISNULL(DEDU_20, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '021')    
		UPDATE @P_DTEMP SET DEDU_21 = ISNULL(DEDU_21, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '022')    
		UPDATE @P_DTEMP SET DEDU_22 = ISNULL(DEDU_22, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '023')    
		UPDATE @P_DTEMP SET DEDU_23 = ISNULL(DEDU_23, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '024')    
		UPDATE @P_DTEMP SET DEDU_24 = ISNULL(DEDU_24, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '025')    
		UPDATE @P_DTEMP SET DEDU_25 = ISNULL(DEDU_25, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '026')    
		UPDATE @P_DTEMP SET DEDU_26 = ISNULL(DEDU_26, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '027')    
		UPDATE @P_DTEMP SET DEDU_27 = ISNULL(DEDU_27, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '028')    
		UPDATE @P_DTEMP SET DEDU_28 = ISNULL(DEDU_28, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '029')    
		UPDATE @P_DTEMP SET DEDU_29 = ISNULL(DEDU_29, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '030')    
		UPDATE @P_DTEMP SET DEDU_30 = ISNULL(DEDU_30, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '031')    
		UPDATE @P_DTEMP SET DEDU_31 = ISNULL(DEDU_31, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '032')    
		UPDATE @P_DTEMP SET DEDU_32 = ISNULL(DEDU_32, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '033')    
		UPDATE @P_DTEMP SET DEDU_33 = ISNULL(DEDU_33, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '034')    
		UPDATE @P_DTEMP SET DEDU_34 = ISNULL(DEDU_34, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '035')    
		UPDATE @P_DTEMP SET DEDU_35 = ISNULL(DEDU_35, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '036')    
		UPDATE @P_DTEMP SET DEDU_36 = ISNULL(DEDU_36, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '037')    
		UPDATE @P_DTEMP SET DEDU_37 = ISNULL(DEDU_37, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '038')    
		UPDATE @P_DTEMP SET DEDU_38 = ISNULL(DEDU_38, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '039')    
		UPDATE @P_DTEMP SET DEDU_39 = ISNULL(DEDU_39, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
	ELSE IF(@P_CD_REPORT = '040')    
		UPDATE @P_DTEMP SET DEDU_40 = ISNULL(DEDU_40, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'    
    ELSE IF(@P_CD_REPORT = '041') 
        UPDATE @P_DTEMP SET DEDU_41 = ISNULL(DEDU_41, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '042') 
        UPDATE @P_DTEMP SET DEDU_42 = ISNULL(DEDU_42, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '043') 
        UPDATE @P_DTEMP SET DEDU_43 = ISNULL(DEDU_43, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '044') 
        UPDATE @P_DTEMP SET DEDU_44 = ISNULL(DEDU_44, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '045') 
        UPDATE @P_DTEMP SET DEDU_45 = ISNULL(DEDU_45, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '046') 
        UPDATE @P_DTEMP SET DEDU_46 = ISNULL(DEDU_46, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '047') 
        UPDATE @P_DTEMP SET DEDU_47 = ISNULL(DEDU_47, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '048') 
        UPDATE @P_DTEMP SET DEDU_48 = ISNULL(DEDU_48, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '049') 
        UPDATE @P_DTEMP SET DEDU_49 = ISNULL(DEDU_49, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '050') 
        UPDATE @P_DTEMP SET DEDU_50 = ISNULL(DEDU_50, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '051') 
        UPDATE @P_DTEMP SET DEDU_51 = ISNULL(DEDU_51, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '052') 
        UPDATE @P_DTEMP SET DEDU_52 = ISNULL(DEDU_52, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '053') 
        UPDATE @P_DTEMP SET DEDU_53 = ISNULL(DEDU_53, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '054') 
        UPDATE @P_DTEMP SET DEDU_54 = ISNULL(DEDU_54, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '055') 
        UPDATE @P_DTEMP SET DEDU_55 = ISNULL(DEDU_55, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '056') 
        UPDATE @P_DTEMP SET DEDU_56 = ISNULL(DEDU_56, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '057') 
        UPDATE @P_DTEMP SET DEDU_57 = ISNULL(DEDU_57, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '058') 
        UPDATE @P_DTEMP SET DEDU_58 = ISNULL(DEDU_58, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '059') 
        UPDATE @P_DTEMP SET DEDU_59 = ISNULL(DEDU_59, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'
    ELSE IF(@P_CD_REPORT = '060') 
        UPDATE @P_DTEMP SET DEDU_60 = ISNULL(DEDU_60, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '061') 
        UPDATE @P_DTEMP SET DEDU_61 = ISNULL(DEDU_61, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '062') 
        UPDATE @P_DTEMP SET DEDU_62 = ISNULL(DEDU_62, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '063') 
        UPDATE @P_DTEMP SET DEDU_63 = ISNULL(DEDU_63, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '064') 
        UPDATE @P_DTEMP SET DEDU_64 = ISNULL(DEDU_64, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '065') 
        UPDATE @P_DTEMP SET DEDU_65 = ISNULL(DEDU_65, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '066') 
        UPDATE @P_DTEMP SET DEDU_66 = ISNULL(DEDU_66, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '067') 
        UPDATE @P_DTEMP SET DEDU_67 = ISNULL(DEDU_67, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '068') 
        UPDATE @P_DTEMP SET DEDU_68 = ISNULL(DEDU_68, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '069') 
        UPDATE @P_DTEMP SET DEDU_69 = ISNULL(DEDU_69, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '070') 
        UPDATE @P_DTEMP SET DEDU_70 = ISNULL(DEDU_70, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '071') 
        UPDATE @P_DTEMP SET DEDU_71 = ISNULL(DEDU_71, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '072') 
        UPDATE @P_DTEMP SET DEDU_72 = ISNULL(DEDU_72, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '073') 
        UPDATE @P_DTEMP SET DEDU_73 = ISNULL(DEDU_73, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '074') 
        UPDATE @P_DTEMP SET DEDU_74 = ISNULL(DEDU_74, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '075') 
        UPDATE @P_DTEMP SET DEDU_75 = ISNULL(DEDU_75, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '076') 
        UPDATE @P_DTEMP SET DEDU_76 = ISNULL(DEDU_76, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '077') 
        UPDATE @P_DTEMP SET DEDU_77 = ISNULL(DEDU_77, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '078') 
        UPDATE @P_DTEMP SET DEDU_78 = ISNULL(DEDU_78, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002' 
    ELSE IF(@P_CD_REPORT = '079') 
        UPDATE @P_DTEMP SET DEDU_79 = ISNULL(DEDU_79, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'      
    ELSE IF(@P_CD_REPORT = '080') 
        UPDATE @P_DTEMP SET DEDU_80 = ISNULL(DEDU_80, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '002'   
END    
    
--연월차 주민세 계산    
SET @P_CD_REPORT = NULL    
    
SELECT @P_CD_REPORT = CD_REPORT    
FROM HR_PREPFORM     
WHERE CD_COMPANY  = @P_CD_COMPANY_L    
AND  TP_REPORT  = @P_TP_REPORT    
AND  TP_PDREPORT  = '002'    
AND  CD_PAYDEDUCT = 'JTX3'    
    
IF(@P_CD_REPORT IS NOT NULL)    
BEGIN    
	IF(@P_CD_REPORT = '001')    
		UPDATE @P_DTEMP SET DEDU_01 = ISNULL(DEDU_01, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '002')    
		UPDATE @P_DTEMP SET DEDU_02 = ISNULL(DEDU_02, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '003')    
		UPDATE @P_DTEMP SET DEDU_03 = ISNULL(DEDU_03, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '004')    
		UPDATE @P_DTEMP SET DEDU_04 = ISNULL(DEDU_04, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '005')    
		UPDATE @P_DTEMP SET DEDU_05 = ISNULL(DEDU_05, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '006')    
		UPDATE @P_DTEMP SET DEDU_06 = ISNULL(DEDU_06, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '007')    
		UPDATE @P_DTEMP SET DEDU_07 = ISNULL(DEDU_07, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '008')    
		UPDATE @P_DTEMP SET DEDU_08 = ISNULL(DEDU_08, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '009')    
		UPDATE @P_DTEMP SET DEDU_09 = ISNULL(DEDU_09, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '010')    
		UPDATE @P_DTEMP SET DEDU_10 = ISNULL(DEDU_10, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '011')    
		UPDATE @P_DTEMP SET DEDU_11 = ISNULL(DEDU_11, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '012')    
		UPDATE @P_DTEMP SET DEDU_12 = ISNULL(DEDU_12, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '013')    
		UPDATE @P_DTEMP SET DEDU_13 = ISNULL(DEDU_13, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '014')    
		UPDATE @P_DTEMP SET DEDU_14 = ISNULL(DEDU_14, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '015')    
		UPDATE @P_DTEMP SET DEDU_15 = ISNULL(DEDU_15, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '016')    
		UPDATE @P_DTEMP SET DEDU_16 = ISNULL(DEDU_16, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '017')    
		UPDATE @P_DTEMP SET DEDU_17 = ISNULL(DEDU_17, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '018')    
		UPDATE @P_DTEMP SET DEDU_18 = ISNULL(DEDU_18, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '019')    
		UPDATE @P_DTEMP SET DEDU_19 = ISNULL(DEDU_19, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '020')    
		UPDATE @P_DTEMP SET DEDU_20 = ISNULL(DEDU_20, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '021')    
		UPDATE @P_DTEMP SET DEDU_21 = ISNULL(DEDU_21, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '022')    
		UPDATE @P_DTEMP SET DEDU_22 = ISNULL(DEDU_22, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '023')    
		UPDATE @P_DTEMP SET DEDU_23 = ISNULL(DEDU_23, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '024')    
		UPDATE @P_DTEMP SET DEDU_24 = ISNULL(DEDU_24, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '025')    
		UPDATE @P_DTEMP SET DEDU_25 = ISNULL(DEDU_25, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '026')    
		UPDATE @P_DTEMP SET DEDU_26 = ISNULL(DEDU_26, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '027')    
		UPDATE @P_DTEMP SET DEDU_27 = ISNULL(DEDU_27, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '028')    
		UPDATE @P_DTEMP SET DEDU_28 = ISNULL(DEDU_28, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '029')    
		UPDATE @P_DTEMP SET DEDU_29 = ISNULL(DEDU_29, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '030')    
		UPDATE @P_DTEMP SET DEDU_30 = ISNULL(DEDU_30, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '031')    
		UPDATE @P_DTEMP SET DEDU_31 = ISNULL(DEDU_31, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '032')    
		UPDATE @P_DTEMP SET DEDU_32 = ISNULL(DEDU_32, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '033')    
		UPDATE @P_DTEMP SET DEDU_33 = ISNULL(DEDU_33, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '034')    
		UPDATE @P_DTEMP SET DEDU_34 = ISNULL(DEDU_34, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '035')    
		UPDATE @P_DTEMP SET DEDU_35 = ISNULL(DEDU_35, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '036')    
		UPDATE @P_DTEMP SET DEDU_36 = ISNULL(DEDU_36, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '037')    
		UPDATE @P_DTEMP SET DEDU_37 = ISNULL(DEDU_37, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '038')    
		UPDATE @P_DTEMP SET DEDU_38 = ISNULL(DEDU_38, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '039')    
		UPDATE @P_DTEMP SET DEDU_39 = ISNULL(DEDU_39, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
	ELSE IF(@P_CD_REPORT = '040')    
		UPDATE @P_DTEMP SET DEDU_40 = ISNULL(DEDU_40, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'    
    ELSE IF(@P_CD_REPORT = '041') 
        UPDATE @P_DTEMP SET DEDU_41 = ISNULL(DEDU_41, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '042') 
        UPDATE @P_DTEMP SET DEDU_42 = ISNULL(DEDU_42, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '043') 
        UPDATE @P_DTEMP SET DEDU_43 = ISNULL(DEDU_43, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '044') 
        UPDATE @P_DTEMP SET DEDU_44 = ISNULL(DEDU_44, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '045') 
        UPDATE @P_DTEMP SET DEDU_45 = ISNULL(DEDU_45, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '046') 
        UPDATE @P_DTEMP SET DEDU_46 = ISNULL(DEDU_46, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '047') 
        UPDATE @P_DTEMP SET DEDU_47 = ISNULL(DEDU_47, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '048') 
        UPDATE @P_DTEMP SET DEDU_48 = ISNULL(DEDU_48, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '049') 
        UPDATE @P_DTEMP SET DEDU_49 = ISNULL(DEDU_49, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '050') 
        UPDATE @P_DTEMP SET DEDU_50 = ISNULL(DEDU_50, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '051') 
        UPDATE @P_DTEMP SET DEDU_51 = ISNULL(DEDU_51, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '052') 
        UPDATE @P_DTEMP SET DEDU_52 = ISNULL(DEDU_52, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '053') 
        UPDATE @P_DTEMP SET DEDU_53 = ISNULL(DEDU_53, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '054') 
        UPDATE @P_DTEMP SET DEDU_54 = ISNULL(DEDU_54, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '055') 
        UPDATE @P_DTEMP SET DEDU_55 = ISNULL(DEDU_55, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '056') 
        UPDATE @P_DTEMP SET DEDU_56 = ISNULL(DEDU_56, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '057') 
        UPDATE @P_DTEMP SET DEDU_57 = ISNULL(DEDU_57, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '058') 
        UPDATE @P_DTEMP SET DEDU_58 = ISNULL(DEDU_58, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '059') 
        UPDATE @P_DTEMP SET DEDU_59 = ISNULL(DEDU_59, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'
    ELSE IF(@P_CD_REPORT = '060') 
        UPDATE @P_DTEMP SET DEDU_60 = ISNULL(DEDU_60, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '061') 
        UPDATE @P_DTEMP SET DEDU_61 = ISNULL(DEDU_61, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '062') 
        UPDATE @P_DTEMP SET DEDU_62 = ISNULL(DEDU_62, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '063') 
        UPDATE @P_DTEMP SET DEDU_63 = ISNULL(DEDU_63, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '064') 
        UPDATE @P_DTEMP SET DEDU_64 = ISNULL(DEDU_64, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '065') 
        UPDATE @P_DTEMP SET DEDU_65 = ISNULL(DEDU_65, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '066') 
        UPDATE @P_DTEMP SET DEDU_66 = ISNULL(DEDU_66, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '067') 
        UPDATE @P_DTEMP SET DEDU_67 = ISNULL(DEDU_67, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '068') 
        UPDATE @P_DTEMP SET DEDU_68 = ISNULL(DEDU_68, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '069') 
        UPDATE @P_DTEMP SET DEDU_69 = ISNULL(DEDU_69, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '070') 
        UPDATE @P_DTEMP SET DEDU_70 = ISNULL(DEDU_70, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '071') 
        UPDATE @P_DTEMP SET DEDU_71 = ISNULL(DEDU_71, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '072') 
        UPDATE @P_DTEMP SET DEDU_72 = ISNULL(DEDU_72, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '073') 
        UPDATE @P_DTEMP SET DEDU_73 = ISNULL(DEDU_73, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '074') 
        UPDATE @P_DTEMP SET DEDU_74 = ISNULL(DEDU_74, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '075') 
        UPDATE @P_DTEMP SET DEDU_75 = ISNULL(DEDU_75, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '076') 
        UPDATE @P_DTEMP SET DEDU_76 = ISNULL(DEDU_76, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '077') 
        UPDATE @P_DTEMP SET DEDU_77 = ISNULL(DEDU_77, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '078') 
        UPDATE @P_DTEMP SET DEDU_78 = ISNULL(DEDU_78, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003' 
    ELSE IF(@P_CD_REPORT = '079') 
        UPDATE @P_DTEMP SET DEDU_79 = ISNULL(DEDU_79, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'      
    ELSE IF(@P_CD_REPORT = '080') 
        UPDATE @P_DTEMP SET DEDU_80 = ISNULL(DEDU_80, 0) + ISNULL(AM_RESIDTAX, 0) WHERE 급여구분 = '003'  
END    

-- 국민연금(사용자) 
SET @P_CD_REPORT = NULL   
 
SELECT  @P_CD_REPORT = CD_REPORT 
FROM    HR_PREPFORM  
WHERE   CD_COMPANY    = @P_CD_COMPANY_L 
AND		TP_REPORT    = @P_TP_REPORT 
AND		TP_PDREPORT    = '002' 
AND		CD_PAYDEDUCT    = 'SIN1' 
 
IF(@P_CD_REPORT IS NOT NULL) 
BEGIN 
	UPDATE @P_DTEMP SET AM_SIN = ISNULL(AM_SIN, 0) + ISNULL(AM_NANNU, 0) 
	
    IF(@P_CD_REPORT = '001') 
        UPDATE @P_DTEMP SET DEDU_01 = ISNULL(DEDU_01, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '002') 
        UPDATE @P_DTEMP SET DEDU_02 = ISNULL(DEDU_02, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '003') 
        UPDATE @P_DTEMP SET DEDU_03 = ISNULL(DEDU_03, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '004') 
        UPDATE @P_DTEMP SET DEDU_04 = ISNULL(DEDU_04, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '005') 
        UPDATE @P_DTEMP SET DEDU_05 = ISNULL(DEDU_05, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '006') 
        UPDATE @P_DTEMP SET DEDU_06 = ISNULL(DEDU_06, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '007') 
        UPDATE @P_DTEMP SET DEDU_07 = ISNULL(DEDU_07, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '008') 
        UPDATE @P_DTEMP SET DEDU_08 = ISNULL(DEDU_08, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '009') 
        UPDATE @P_DTEMP SET DEDU_09 = ISNULL(DEDU_09, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '010') 
        UPDATE @P_DTEMP SET DEDU_10 = ISNULL(DEDU_10, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '011') 
        UPDATE @P_DTEMP SET DEDU_11 = ISNULL(DEDU_11, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '012') 
        UPDATE @P_DTEMP SET DEDU_12 = ISNULL(DEDU_12, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '013') 
        UPDATE @P_DTEMP SET DEDU_13 = ISNULL(DEDU_13, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '014') 
        UPDATE @P_DTEMP SET DEDU_14 = ISNULL(DEDU_14, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '015') 
        UPDATE @P_DTEMP SET DEDU_15 = ISNULL(DEDU_15, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '016') 
        UPDATE @P_DTEMP SET DEDU_16 = ISNULL(DEDU_16, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '017') 
        UPDATE @P_DTEMP SET DEDU_17 = ISNULL(DEDU_17, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '018') 
        UPDATE @P_DTEMP SET DEDU_18 = ISNULL(DEDU_18, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '019') 
        UPDATE @P_DTEMP SET DEDU_19 = ISNULL(DEDU_19, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '020') 
        UPDATE @P_DTEMP SET DEDU_20 = ISNULL(DEDU_20, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '021') 
        UPDATE @P_DTEMP SET DEDU_21 = ISNULL(DEDU_21, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '022') 
        UPDATE @P_DTEMP SET DEDU_22 = ISNULL(DEDU_22, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '023') 
        UPDATE @P_DTEMP SET DEDU_23 = ISNULL(DEDU_23, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '024') 
        UPDATE @P_DTEMP SET DEDU_24 = ISNULL(DEDU_24, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '025') 
        UPDATE @P_DTEMP SET DEDU_25 = ISNULL(DEDU_25, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '026') 
        UPDATE @P_DTEMP SET DEDU_26 = ISNULL(DEDU_26, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '027') 
        UPDATE @P_DTEMP SET DEDU_27 = ISNULL(DEDU_27, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '028') 
        UPDATE @P_DTEMP SET DEDU_28 = ISNULL(DEDU_28, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '029') 
        UPDATE @P_DTEMP SET DEDU_29 = ISNULL(DEDU_29, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '030') 
        UPDATE @P_DTEMP SET DEDU_30 = ISNULL(DEDU_30, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '031') 
        UPDATE @P_DTEMP SET DEDU_31 = ISNULL(DEDU_31, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '032') 
        UPDATE @P_DTEMP SET DEDU_32 = ISNULL(DEDU_32, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '033') 
        UPDATE @P_DTEMP SET DEDU_33 = ISNULL(DEDU_33, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '034') 
        UPDATE @P_DTEMP SET DEDU_34 = ISNULL(DEDU_34, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '035') 
        UPDATE @P_DTEMP SET DEDU_35 = ISNULL(DEDU_35, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '036') 
        UPDATE @P_DTEMP SET DEDU_36 = ISNULL(DEDU_36, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '037') 
        UPDATE @P_DTEMP SET DEDU_37 = ISNULL(DEDU_37, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '038') 
        UPDATE @P_DTEMP SET DEDU_38 = ISNULL(DEDU_38, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '039') 
        UPDATE @P_DTEMP SET DEDU_39 = ISNULL(DEDU_39, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '040') 
        UPDATE @P_DTEMP SET DEDU_40 = ISNULL(DEDU_40, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '041') 
        UPDATE @P_DTEMP SET DEDU_41 = ISNULL(DEDU_41, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '042') 
        UPDATE @P_DTEMP SET DEDU_42 = ISNULL(DEDU_42, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '043') 
        UPDATE @P_DTEMP SET DEDU_43 = ISNULL(DEDU_43, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '044') 
        UPDATE @P_DTEMP SET DEDU_44 = ISNULL(DEDU_44, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '045') 
        UPDATE @P_DTEMP SET DEDU_45 = ISNULL(DEDU_45, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '046') 
        UPDATE @P_DTEMP SET DEDU_46 = ISNULL(DEDU_46, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '047') 
        UPDATE @P_DTEMP SET DEDU_47 = ISNULL(DEDU_47, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '048') 
        UPDATE @P_DTEMP SET DEDU_48 = ISNULL(DEDU_48, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '049') 
        UPDATE @P_DTEMP SET DEDU_49 = ISNULL(DEDU_49, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '050') 
        UPDATE @P_DTEMP SET DEDU_50 = ISNULL(DEDU_50, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '051') 
        UPDATE @P_DTEMP SET DEDU_51 = ISNULL(DEDU_51, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '052') 
        UPDATE @P_DTEMP SET DEDU_52 = ISNULL(DEDU_52, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '053') 
        UPDATE @P_DTEMP SET DEDU_53 = ISNULL(DEDU_53, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '054') 
        UPDATE @P_DTEMP SET DEDU_54 = ISNULL(DEDU_54, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '055') 
        UPDATE @P_DTEMP SET DEDU_55 = ISNULL(DEDU_55, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '056') 
        UPDATE @P_DTEMP SET DEDU_56 = ISNULL(DEDU_56, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '057') 
        UPDATE @P_DTEMP SET DEDU_57 = ISNULL(DEDU_57, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '058') 
        UPDATE @P_DTEMP SET DEDU_58 = ISNULL(DEDU_58, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '059') 
        UPDATE @P_DTEMP SET DEDU_59 = ISNULL(DEDU_59, 0) + ISNULL(AM_NANNU, 0)
    ELSE IF(@P_CD_REPORT = '060') 
        UPDATE @P_DTEMP SET DEDU_60 = ISNULL(DEDU_60, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '061') 
        UPDATE @P_DTEMP SET DEDU_61 = ISNULL(DEDU_61, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '062') 
        UPDATE @P_DTEMP SET DEDU_62 = ISNULL(DEDU_62, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '063') 
        UPDATE @P_DTEMP SET DEDU_63 = ISNULL(DEDU_63, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '064') 
        UPDATE @P_DTEMP SET DEDU_64 = ISNULL(DEDU_64, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '065') 
        UPDATE @P_DTEMP SET DEDU_65 = ISNULL(DEDU_65, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '066') 
        UPDATE @P_DTEMP SET DEDU_66 = ISNULL(DEDU_66, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '067') 
        UPDATE @P_DTEMP SET DEDU_67 = ISNULL(DEDU_67, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '068') 
        UPDATE @P_DTEMP SET DEDU_68 = ISNULL(DEDU_68, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '069') 
        UPDATE @P_DTEMP SET DEDU_69 = ISNULL(DEDU_69, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '070') 
        UPDATE @P_DTEMP SET DEDU_70 = ISNULL(DEDU_70, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '071') 
        UPDATE @P_DTEMP SET DEDU_71 = ISNULL(DEDU_71, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '072') 
        UPDATE @P_DTEMP SET DEDU_72 = ISNULL(DEDU_72, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '073') 
        UPDATE @P_DTEMP SET DEDU_73 = ISNULL(DEDU_73, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '074') 
        UPDATE @P_DTEMP SET DEDU_74 = ISNULL(DEDU_74, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '075') 
        UPDATE @P_DTEMP SET DEDU_75 = ISNULL(DEDU_75, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '076') 
        UPDATE @P_DTEMP SET DEDU_76 = ISNULL(DEDU_76, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '077') 
        UPDATE @P_DTEMP SET DEDU_77 = ISNULL(DEDU_77, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '078') 
        UPDATE @P_DTEMP SET DEDU_78 = ISNULL(DEDU_78, 0) + ISNULL(AM_NANNU, 0) 
    ELSE IF(@P_CD_REPORT = '079') 
        UPDATE @P_DTEMP SET DEDU_79 = ISNULL(DEDU_79, 0) + ISNULL(AM_NANNU, 0)      
    ELSE IF(@P_CD_REPORT = '080') 
        UPDATE @P_DTEMP SET DEDU_80 = ISNULL(DEDU_80, 0) + ISNULL(AM_NANNU, 0)        
END 

-- 건강보험(사용자) 
SET @P_CD_REPORT = NULL   
 
SELECT  @P_CD_REPORT = CD_REPORT 
FROM    HR_PREPFORM  
WHERE   CD_COMPANY    = @P_CD_COMPANY_L 
AND		TP_REPORT    = @P_TP_REPORT 
AND		TP_PDREPORT    = '002' 
AND		CD_PAYDEDUCT    = 'SIN2' 
 
IF(@P_CD_REPORT IS NOT NULL) 
BEGIN 
	UPDATE @P_DTEMP SET AM_SIN = ISNULL(AM_SIN, 0) + ISNULL(AM_NINS, 0)  

    IF(@P_CD_REPORT = '001') 
        UPDATE @P_DTEMP SET DEDU_01 = ISNULL(DEDU_01, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '002') 
        UPDATE @P_DTEMP SET DEDU_02 = ISNULL(DEDU_02, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '003') 
        UPDATE @P_DTEMP SET DEDU_03 = ISNULL(DEDU_03, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '004') 
        UPDATE @P_DTEMP SET DEDU_04 = ISNULL(DEDU_04, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '005') 
        UPDATE @P_DTEMP SET DEDU_05 = ISNULL(DEDU_05, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '006') 
        UPDATE @P_DTEMP SET DEDU_06 = ISNULL(DEDU_06, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '007') 
        UPDATE @P_DTEMP SET DEDU_07 = ISNULL(DEDU_07, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '008') 
        UPDATE @P_DTEMP SET DEDU_08 = ISNULL(DEDU_08, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '009') 
        UPDATE @P_DTEMP SET DEDU_09 = ISNULL(DEDU_09, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '010') 
        UPDATE @P_DTEMP SET DEDU_10 = ISNULL(DEDU_10, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '011') 
        UPDATE @P_DTEMP SET DEDU_11 = ISNULL(DEDU_11, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '012') 
        UPDATE @P_DTEMP SET DEDU_12 = ISNULL(DEDU_12, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '013') 
        UPDATE @P_DTEMP SET DEDU_13 = ISNULL(DEDU_13, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '014') 
        UPDATE @P_DTEMP SET DEDU_14 = ISNULL(DEDU_14, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '015') 
        UPDATE @P_DTEMP SET DEDU_15 = ISNULL(DEDU_15, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '016') 
        UPDATE @P_DTEMP SET DEDU_16 = ISNULL(DEDU_16, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '017') 
        UPDATE @P_DTEMP SET DEDU_17 = ISNULL(DEDU_17, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '018') 
        UPDATE @P_DTEMP SET DEDU_18 = ISNULL(DEDU_18, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '019') 
        UPDATE @P_DTEMP SET DEDU_19 = ISNULL(DEDU_19, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '020') 
        UPDATE @P_DTEMP SET DEDU_20 = ISNULL(DEDU_20, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '021') 
        UPDATE @P_DTEMP SET DEDU_21 = ISNULL(DEDU_21, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '022') 
        UPDATE @P_DTEMP SET DEDU_22 = ISNULL(DEDU_22, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '023') 
        UPDATE @P_DTEMP SET DEDU_23 = ISNULL(DEDU_23, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '024') 
        UPDATE @P_DTEMP SET DEDU_24 = ISNULL(DEDU_24, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '025') 
        UPDATE @P_DTEMP SET DEDU_25 = ISNULL(DEDU_25, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '026') 
        UPDATE @P_DTEMP SET DEDU_26 = ISNULL(DEDU_26, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '027') 
        UPDATE @P_DTEMP SET DEDU_27 = ISNULL(DEDU_27, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '028') 
        UPDATE @P_DTEMP SET DEDU_28 = ISNULL(DEDU_28, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '029') 
        UPDATE @P_DTEMP SET DEDU_29 = ISNULL(DEDU_29, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '030') 
        UPDATE @P_DTEMP SET DEDU_30 = ISNULL(DEDU_30, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '031') 
        UPDATE @P_DTEMP SET DEDU_31 = ISNULL(DEDU_31, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '032') 
        UPDATE @P_DTEMP SET DEDU_32 = ISNULL(DEDU_32, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '033') 
        UPDATE @P_DTEMP SET DEDU_33 = ISNULL(DEDU_33, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '034') 
        UPDATE @P_DTEMP SET DEDU_34 = ISNULL(DEDU_34, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '035') 
        UPDATE @P_DTEMP SET DEDU_35 = ISNULL(DEDU_35, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '036') 
        UPDATE @P_DTEMP SET DEDU_36 = ISNULL(DEDU_36, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '037') 
        UPDATE @P_DTEMP SET DEDU_37 = ISNULL(DEDU_37, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '038') 
        UPDATE @P_DTEMP SET DEDU_38 = ISNULL(DEDU_38, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '039') 
        UPDATE @P_DTEMP SET DEDU_39 = ISNULL(DEDU_39, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '040') 
        UPDATE @P_DTEMP SET DEDU_40 = ISNULL(DEDU_40, 0) + ISNULL(AM_NINS, 0)         
    ELSE IF(@P_CD_REPORT = '041') 
        UPDATE @P_DTEMP SET DEDU_41 = ISNULL(DEDU_41, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '042') 
        UPDATE @P_DTEMP SET DEDU_42 = ISNULL(DEDU_42, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '043') 
        UPDATE @P_DTEMP SET DEDU_43 = ISNULL(DEDU_43, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '044') 
        UPDATE @P_DTEMP SET DEDU_44 = ISNULL(DEDU_44, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '045') 
        UPDATE @P_DTEMP SET DEDU_45 = ISNULL(DEDU_45, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '046') 
        UPDATE @P_DTEMP SET DEDU_46 = ISNULL(DEDU_46, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '047') 
        UPDATE @P_DTEMP SET DEDU_47 = ISNULL(DEDU_47, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '048') 
        UPDATE @P_DTEMP SET DEDU_48 = ISNULL(DEDU_48, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '049') 
        UPDATE @P_DTEMP SET DEDU_49 = ISNULL(DEDU_49, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '050') 
        UPDATE @P_DTEMP SET DEDU_50 = ISNULL(DEDU_50, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '051') 
        UPDATE @P_DTEMP SET DEDU_51 = ISNULL(DEDU_51, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '052') 
        UPDATE @P_DTEMP SET DEDU_52 = ISNULL(DEDU_52, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '053') 
        UPDATE @P_DTEMP SET DEDU_53 = ISNULL(DEDU_53, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '054') 
        UPDATE @P_DTEMP SET DEDU_54 = ISNULL(DEDU_54, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '055') 
        UPDATE @P_DTEMP SET DEDU_55 = ISNULL(DEDU_55, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '056') 
        UPDATE @P_DTEMP SET DEDU_56 = ISNULL(DEDU_56, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '057') 
        UPDATE @P_DTEMP SET DEDU_57 = ISNULL(DEDU_57, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '058') 
        UPDATE @P_DTEMP SET DEDU_58 = ISNULL(DEDU_58, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '059') 
        UPDATE @P_DTEMP SET DEDU_59 = ISNULL(DEDU_59, 0) + ISNULL(AM_NINS, 0)
    ELSE IF(@P_CD_REPORT = '060') 
        UPDATE @P_DTEMP SET DEDU_60 = ISNULL(DEDU_60, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '061') 
        UPDATE @P_DTEMP SET DEDU_61 = ISNULL(DEDU_61, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '062') 
        UPDATE @P_DTEMP SET DEDU_62 = ISNULL(DEDU_62, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '063') 
        UPDATE @P_DTEMP SET DEDU_63 = ISNULL(DEDU_63, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '064') 
        UPDATE @P_DTEMP SET DEDU_64 = ISNULL(DEDU_64, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '065') 
        UPDATE @P_DTEMP SET DEDU_65 = ISNULL(DEDU_65, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '066') 
        UPDATE @P_DTEMP SET DEDU_66 = ISNULL(DEDU_66, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '067') 
        UPDATE @P_DTEMP SET DEDU_67 = ISNULL(DEDU_67, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '068') 
        UPDATE @P_DTEMP SET DEDU_68 = ISNULL(DEDU_68, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '069') 
        UPDATE @P_DTEMP SET DEDU_69 = ISNULL(DEDU_69, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '070') 
        UPDATE @P_DTEMP SET DEDU_70 = ISNULL(DEDU_70, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '071') 
        UPDATE @P_DTEMP SET DEDU_71 = ISNULL(DEDU_71, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '072') 
        UPDATE @P_DTEMP SET DEDU_72 = ISNULL(DEDU_72, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '073') 
        UPDATE @P_DTEMP SET DEDU_73 = ISNULL(DEDU_73, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '074') 
        UPDATE @P_DTEMP SET DEDU_74 = ISNULL(DEDU_74, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '075') 
        UPDATE @P_DTEMP SET DEDU_75 = ISNULL(DEDU_75, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '076') 
        UPDATE @P_DTEMP SET DEDU_76 = ISNULL(DEDU_76, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '077') 
        UPDATE @P_DTEMP SET DEDU_77 = ISNULL(DEDU_77, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '078') 
        UPDATE @P_DTEMP SET DEDU_78 = ISNULL(DEDU_78, 0) + ISNULL(AM_NINS, 0) 
    ELSE IF(@P_CD_REPORT = '079') 
        UPDATE @P_DTEMP SET DEDU_79 = ISNULL(DEDU_79, 0) + ISNULL(AM_NINS, 0)      
    ELSE IF(@P_CD_REPORT = '080') 
        UPDATE @P_DTEMP SET DEDU_80 = ISNULL(DEDU_80, 0) + ISNULL(AM_NINS, 0)        
END 

-- 고용보험(사용자) 
SET @P_CD_REPORT = NULL   
 
SELECT  @P_CD_REPORT = CD_REPORT 
FROM    HR_PREPFORM  
WHERE   CD_COMPANY    = @P_CD_COMPANY_L 
AND		TP_REPORT    = @P_TP_REPORT 
AND		TP_PDREPORT    = '002' 
AND		CD_PAYDEDUCT    = 'SIN3' 
 
IF(@P_CD_REPORT IS NOT NULL) 
BEGIN 
	UPDATE @P_DTEMP SET AM_SIN = ISNULL(AM_SIN, 0) + ISNULL(AM_NEMPE, 0)  
	
    IF(@P_CD_REPORT = '001') 
        UPDATE @P_DTEMP SET DEDU_01 = ISNULL(DEDU_01, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '002') 
        UPDATE @P_DTEMP SET DEDU_02 = ISNULL(DEDU_02, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '003') 
        UPDATE @P_DTEMP SET DEDU_03 = ISNULL(DEDU_03, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '004') 
        UPDATE @P_DTEMP SET DEDU_04 = ISNULL(DEDU_04, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '005') 
        UPDATE @P_DTEMP SET DEDU_05 = ISNULL(DEDU_05, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '006') 
        UPDATE @P_DTEMP SET DEDU_06 = ISNULL(DEDU_06, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '007') 
        UPDATE @P_DTEMP SET DEDU_07 = ISNULL(DEDU_07, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '008') 
        UPDATE @P_DTEMP SET DEDU_08 = ISNULL(DEDU_08, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '009') 
        UPDATE @P_DTEMP SET DEDU_09 = ISNULL(DEDU_09, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '010') 
        UPDATE @P_DTEMP SET DEDU_10 = ISNULL(DEDU_10, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '011') 
        UPDATE @P_DTEMP SET DEDU_11 = ISNULL(DEDU_11, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '012') 
        UPDATE @P_DTEMP SET DEDU_12 = ISNULL(DEDU_12, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '013') 
        UPDATE @P_DTEMP SET DEDU_13 = ISNULL(DEDU_13, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '014') 
        UPDATE @P_DTEMP SET DEDU_14 = ISNULL(DEDU_14, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '015') 
        UPDATE @P_DTEMP SET DEDU_15 = ISNULL(DEDU_15, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '016') 
        UPDATE @P_DTEMP SET DEDU_16 = ISNULL(DEDU_16, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '017') 
        UPDATE @P_DTEMP SET DEDU_17 = ISNULL(DEDU_17, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '018') 
        UPDATE @P_DTEMP SET DEDU_18 = ISNULL(DEDU_18, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '019') 
        UPDATE @P_DTEMP SET DEDU_19 = ISNULL(DEDU_19, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '020') 
        UPDATE @P_DTEMP SET DEDU_20 = ISNULL(DEDU_20, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '021') 
        UPDATE @P_DTEMP SET DEDU_21 = ISNULL(DEDU_21, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '022') 
        UPDATE @P_DTEMP SET DEDU_22 = ISNULL(DEDU_22, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '023') 
        UPDATE @P_DTEMP SET DEDU_23 = ISNULL(DEDU_23, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '024') 
        UPDATE @P_DTEMP SET DEDU_24 = ISNULL(DEDU_24, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '025') 
        UPDATE @P_DTEMP SET DEDU_25 = ISNULL(DEDU_25, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '026') 
        UPDATE @P_DTEMP SET DEDU_26 = ISNULL(DEDU_26, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '027') 
        UPDATE @P_DTEMP SET DEDU_27 = ISNULL(DEDU_27, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '028') 
        UPDATE @P_DTEMP SET DEDU_28 = ISNULL(DEDU_28, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '029') 
        UPDATE @P_DTEMP SET DEDU_29 = ISNULL(DEDU_29, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '030') 
        UPDATE @P_DTEMP SET DEDU_30 = ISNULL(DEDU_30, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '031') 
        UPDATE @P_DTEMP SET DEDU_31 = ISNULL(DEDU_31, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '032') 
        UPDATE @P_DTEMP SET DEDU_32 = ISNULL(DEDU_32, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '033') 
        UPDATE @P_DTEMP SET DEDU_33 = ISNULL(DEDU_33, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '034') 
        UPDATE @P_DTEMP SET DEDU_34 = ISNULL(DEDU_34, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '035') 
        UPDATE @P_DTEMP SET DEDU_35 = ISNULL(DEDU_35, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '036') 
        UPDATE @P_DTEMP SET DEDU_36 = ISNULL(DEDU_36, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '037') 
        UPDATE @P_DTEMP SET DEDU_37 = ISNULL(DEDU_37, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '038') 
        UPDATE @P_DTEMP SET DEDU_38 = ISNULL(DEDU_38, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '039') 
        UPDATE @P_DTEMP SET DEDU_39 = ISNULL(DEDU_39, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '040') 
        UPDATE @P_DTEMP SET DEDU_40 = ISNULL(DEDU_40, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '041') 
        UPDATE @P_DTEMP SET DEDU_41 = ISNULL(DEDU_41, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '042') 
        UPDATE @P_DTEMP SET DEDU_42 = ISNULL(DEDU_42, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '043') 
        UPDATE @P_DTEMP SET DEDU_43 = ISNULL(DEDU_43, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '044') 
        UPDATE @P_DTEMP SET DEDU_44 = ISNULL(DEDU_44, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '045') 
        UPDATE @P_DTEMP SET DEDU_45 = ISNULL(DEDU_45, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '046') 
        UPDATE @P_DTEMP SET DEDU_46 = ISNULL(DEDU_46, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '047') 
        UPDATE @P_DTEMP SET DEDU_47 = ISNULL(DEDU_47, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '048') 
        UPDATE @P_DTEMP SET DEDU_48 = ISNULL(DEDU_48, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '049') 
        UPDATE @P_DTEMP SET DEDU_49 = ISNULL(DEDU_49, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '050') 
        UPDATE @P_DTEMP SET DEDU_50 = ISNULL(DEDU_50, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '051') 
        UPDATE @P_DTEMP SET DEDU_51 = ISNULL(DEDU_51, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '052') 
        UPDATE @P_DTEMP SET DEDU_52 = ISNULL(DEDU_52, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '053') 
        UPDATE @P_DTEMP SET DEDU_53 = ISNULL(DEDU_53, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '054') 
        UPDATE @P_DTEMP SET DEDU_54 = ISNULL(DEDU_54, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '055') 
        UPDATE @P_DTEMP SET DEDU_55 = ISNULL(DEDU_55, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '056') 
        UPDATE @P_DTEMP SET DEDU_56 = ISNULL(DEDU_56, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '057') 
        UPDATE @P_DTEMP SET DEDU_57 = ISNULL(DEDU_57, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '058') 
        UPDATE @P_DTEMP SET DEDU_58 = ISNULL(DEDU_58, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '059') 
        UPDATE @P_DTEMP SET DEDU_59 = ISNULL(DEDU_59, 0) + ISNULL(AM_NEMPE, 0)
    ELSE IF(@P_CD_REPORT = '060') 
        UPDATE @P_DTEMP SET DEDU_60 = ISNULL(DEDU_60, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '061') 
        UPDATE @P_DTEMP SET DEDU_61 = ISNULL(DEDU_61, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '062') 
        UPDATE @P_DTEMP SET DEDU_62 = ISNULL(DEDU_62, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '063') 
        UPDATE @P_DTEMP SET DEDU_63 = ISNULL(DEDU_63, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '064') 
        UPDATE @P_DTEMP SET DEDU_64 = ISNULL(DEDU_64, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '065') 
        UPDATE @P_DTEMP SET DEDU_65 = ISNULL(DEDU_65, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '066') 
        UPDATE @P_DTEMP SET DEDU_66 = ISNULL(DEDU_66, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '067') 
        UPDATE @P_DTEMP SET DEDU_67 = ISNULL(DEDU_67, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '068') 
        UPDATE @P_DTEMP SET DEDU_68 = ISNULL(DEDU_68, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '069') 
        UPDATE @P_DTEMP SET DEDU_69 = ISNULL(DEDU_69, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '070') 
        UPDATE @P_DTEMP SET DEDU_70 = ISNULL(DEDU_70, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '071') 
        UPDATE @P_DTEMP SET DEDU_71 = ISNULL(DEDU_71, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '072') 
        UPDATE @P_DTEMP SET DEDU_72 = ISNULL(DEDU_72, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '073') 
        UPDATE @P_DTEMP SET DEDU_73 = ISNULL(DEDU_73, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '074') 
        UPDATE @P_DTEMP SET DEDU_74 = ISNULL(DEDU_74, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '075') 
        UPDATE @P_DTEMP SET DEDU_75 = ISNULL(DEDU_75, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '076') 
        UPDATE @P_DTEMP SET DEDU_76 = ISNULL(DEDU_76, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '077') 
        UPDATE @P_DTEMP SET DEDU_77 = ISNULL(DEDU_77, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '078') 
        UPDATE @P_DTEMP SET DEDU_78 = ISNULL(DEDU_78, 0) + ISNULL(AM_NEMPE, 0) 
    ELSE IF(@P_CD_REPORT = '079') 
        UPDATE @P_DTEMP SET DEDU_79 = ISNULL(DEDU_79, 0) + ISNULL(AM_NEMPE, 0)      
    ELSE IF(@P_CD_REPORT = '080') 
        UPDATE @P_DTEMP SET DEDU_80 = ISNULL(DEDU_80, 0) + ISNULL(AM_NEMPE, 0)        
END 

-- 요양보험(사용자) 
SET @P_CD_REPORT = NULL   
 
SELECT  @P_CD_REPORT = CD_REPORT 
FROM    HR_PREPFORM  
WHERE   CD_COMPANY    = @P_CD_COMPANY_L 
AND		TP_REPORT    = @P_TP_REPORT 
AND		TP_PDREPORT    = '002' 
AND		CD_PAYDEDUCT    = 'SIN4' 
 
IF(@P_CD_REPORT IS NOT NULL) 
BEGIN 
	UPDATE @P_DTEMP SET AM_SIN = ISNULL(AM_SIN, 0) + ISNULL(AM_NOINS, 0)  
	
    IF(@P_CD_REPORT = '001') 
        UPDATE @P_DTEMP SET DEDU_01 = ISNULL(DEDU_01, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '002') 
        UPDATE @P_DTEMP SET DEDU_02 = ISNULL(DEDU_02, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '003') 
        UPDATE @P_DTEMP SET DEDU_03 = ISNULL(DEDU_03, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '004') 
        UPDATE @P_DTEMP SET DEDU_04 = ISNULL(DEDU_04, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '005') 
        UPDATE @P_DTEMP SET DEDU_05 = ISNULL(DEDU_05, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '006') 
        UPDATE @P_DTEMP SET DEDU_06 = ISNULL(DEDU_06, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '007') 
        UPDATE @P_DTEMP SET DEDU_07 = ISNULL(DEDU_07, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '008') 
        UPDATE @P_DTEMP SET DEDU_08 = ISNULL(DEDU_08, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '009') 
        UPDATE @P_DTEMP SET DEDU_09 = ISNULL(DEDU_09, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '010') 
        UPDATE @P_DTEMP SET DEDU_10 = ISNULL(DEDU_10, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '011') 
        UPDATE @P_DTEMP SET DEDU_11 = ISNULL(DEDU_11, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '012') 
        UPDATE @P_DTEMP SET DEDU_12 = ISNULL(DEDU_12, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '013') 
        UPDATE @P_DTEMP SET DEDU_13 = ISNULL(DEDU_13, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '014') 
        UPDATE @P_DTEMP SET DEDU_14 = ISNULL(DEDU_14, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '015') 
        UPDATE @P_DTEMP SET DEDU_15 = ISNULL(DEDU_15, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '016') 
        UPDATE @P_DTEMP SET DEDU_16 = ISNULL(DEDU_16, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '017') 
        UPDATE @P_DTEMP SET DEDU_17 = ISNULL(DEDU_17, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '018') 
        UPDATE @P_DTEMP SET DEDU_18 = ISNULL(DEDU_18, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '019') 
        UPDATE @P_DTEMP SET DEDU_19 = ISNULL(DEDU_19, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '020') 
        UPDATE @P_DTEMP SET DEDU_20 = ISNULL(DEDU_20, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '021') 
        UPDATE @P_DTEMP SET DEDU_21 = ISNULL(DEDU_21, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '022') 
        UPDATE @P_DTEMP SET DEDU_22 = ISNULL(DEDU_22, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '023') 
        UPDATE @P_DTEMP SET DEDU_23 = ISNULL(DEDU_23, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '024') 
        UPDATE @P_DTEMP SET DEDU_24 = ISNULL(DEDU_24, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '025') 
        UPDATE @P_DTEMP SET DEDU_25 = ISNULL(DEDU_25, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '026') 
        UPDATE @P_DTEMP SET DEDU_26 = ISNULL(DEDU_26, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '027') 
        UPDATE @P_DTEMP SET DEDU_27 = ISNULL(DEDU_27, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '028') 
        UPDATE @P_DTEMP SET DEDU_28 = ISNULL(DEDU_28, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '029') 
        UPDATE @P_DTEMP SET DEDU_29 = ISNULL(DEDU_29, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '030') 
        UPDATE @P_DTEMP SET DEDU_30 = ISNULL(DEDU_30, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '031') 
        UPDATE @P_DTEMP SET DEDU_31 = ISNULL(DEDU_31, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '032') 
        UPDATE @P_DTEMP SET DEDU_32 = ISNULL(DEDU_32, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '033') 
        UPDATE @P_DTEMP SET DEDU_33 = ISNULL(DEDU_33, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '034') 
        UPDATE @P_DTEMP SET DEDU_34 = ISNULL(DEDU_34, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '035') 
        UPDATE @P_DTEMP SET DEDU_35 = ISNULL(DEDU_35, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '036') 
        UPDATE @P_DTEMP SET DEDU_36 = ISNULL(DEDU_36, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '037') 
        UPDATE @P_DTEMP SET DEDU_37 = ISNULL(DEDU_37, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '038') 
        UPDATE @P_DTEMP SET DEDU_38 = ISNULL(DEDU_38, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '039') 
        UPDATE @P_DTEMP SET DEDU_39 = ISNULL(DEDU_39, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '040') 
        UPDATE @P_DTEMP SET DEDU_40 = ISNULL(DEDU_40, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '041') 
        UPDATE @P_DTEMP SET DEDU_41 = ISNULL(DEDU_41, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '042') 
        UPDATE @P_DTEMP SET DEDU_42 = ISNULL(DEDU_42, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '043') 
        UPDATE @P_DTEMP SET DEDU_43 = ISNULL(DEDU_43, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '044') 
        UPDATE @P_DTEMP SET DEDU_44 = ISNULL(DEDU_44, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '045') 
        UPDATE @P_DTEMP SET DEDU_45 = ISNULL(DEDU_45, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '046') 
        UPDATE @P_DTEMP SET DEDU_46 = ISNULL(DEDU_46, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '047') 
        UPDATE @P_DTEMP SET DEDU_47 = ISNULL(DEDU_47, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '048') 
        UPDATE @P_DTEMP SET DEDU_48 = ISNULL(DEDU_48, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '049') 
        UPDATE @P_DTEMP SET DEDU_49 = ISNULL(DEDU_49, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '050') 
        UPDATE @P_DTEMP SET DEDU_50 = ISNULL(DEDU_50, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '051') 
        UPDATE @P_DTEMP SET DEDU_51 = ISNULL(DEDU_51, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '052') 
        UPDATE @P_DTEMP SET DEDU_52 = ISNULL(DEDU_52, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '053') 
        UPDATE @P_DTEMP SET DEDU_53 = ISNULL(DEDU_53, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '054') 
        UPDATE @P_DTEMP SET DEDU_54 = ISNULL(DEDU_54, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '055') 
        UPDATE @P_DTEMP SET DEDU_55 = ISNULL(DEDU_55, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '056') 
        UPDATE @P_DTEMP SET DEDU_56 = ISNULL(DEDU_56, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '057') 
        UPDATE @P_DTEMP SET DEDU_57 = ISNULL(DEDU_57, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '058') 
        UPDATE @P_DTEMP SET DEDU_58 = ISNULL(DEDU_58, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '059') 
        UPDATE @P_DTEMP SET DEDU_59 = ISNULL(DEDU_59, 0) + ISNULL(AM_NOINS, 0)
    ELSE IF(@P_CD_REPORT = '060') 
        UPDATE @P_DTEMP SET DEDU_60 = ISNULL(DEDU_60, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '061') 
        UPDATE @P_DTEMP SET DEDU_61 = ISNULL(DEDU_61, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '062') 
        UPDATE @P_DTEMP SET DEDU_62 = ISNULL(DEDU_62, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '063') 
        UPDATE @P_DTEMP SET DEDU_63 = ISNULL(DEDU_63, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '064') 
        UPDATE @P_DTEMP SET DEDU_64 = ISNULL(DEDU_64, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '065') 
        UPDATE @P_DTEMP SET DEDU_65 = ISNULL(DEDU_65, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '066') 
        UPDATE @P_DTEMP SET DEDU_66 = ISNULL(DEDU_66, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '067') 
        UPDATE @P_DTEMP SET DEDU_67 = ISNULL(DEDU_67, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '068') 
        UPDATE @P_DTEMP SET DEDU_68 = ISNULL(DEDU_68, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '069') 
        UPDATE @P_DTEMP SET DEDU_69 = ISNULL(DEDU_69, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '070') 
        UPDATE @P_DTEMP SET DEDU_70 = ISNULL(DEDU_70, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '071') 
        UPDATE @P_DTEMP SET DEDU_71 = ISNULL(DEDU_71, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '072') 
        UPDATE @P_DTEMP SET DEDU_72 = ISNULL(DEDU_72, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '073') 
        UPDATE @P_DTEMP SET DEDU_73 = ISNULL(DEDU_73, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '074') 
        UPDATE @P_DTEMP SET DEDU_74 = ISNULL(DEDU_74, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '075') 
        UPDATE @P_DTEMP SET DEDU_75 = ISNULL(DEDU_75, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '076') 
        UPDATE @P_DTEMP SET DEDU_76 = ISNULL(DEDU_76, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '077') 
        UPDATE @P_DTEMP SET DEDU_77 = ISNULL(DEDU_77, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '078') 
        UPDATE @P_DTEMP SET DEDU_78 = ISNULL(DEDU_78, 0) + ISNULL(AM_NOINS, 0) 
    ELSE IF(@P_CD_REPORT = '079') 
        UPDATE @P_DTEMP SET DEDU_79 = ISNULL(DEDU_79, 0) + ISNULL(AM_NOINS, 0)      
    ELSE IF(@P_CD_REPORT = '080') 
        UPDATE @P_DTEMP SET DEDU_80 = ISNULL(DEDU_80, 0) + ISNULL(AM_NOINS, 0)        
END 

IF(@P_TP_SUM IN ('001', '011', '012', '013', '016')) 
BEGIN
	EXEC UP_HR_PMPRPT_SELECT_CCGRP1_CHK @P_CD_COMPANY_L,'HR', @YN_CHK =  @V_YN_CHK OUTPUT
   
	IF @V_YN_CHK = 'Y'
	BEGIN
		RAISERROR ('C/C값이 중복된 C/C그룹이 존재합니다', 18, 1)
		RETURN
	END
	
	-- C/C그룹 글로벌 임시테이블 문제가 있어 테이블변수로 변경
	-- UP_HR_PMPRPT_SELECT_CCGRP1 프로시저 내용 옮김
	DECLARE @P_TEMP_CCGRP TABLE 
	( 
		CD_CCGRP    NVARCHAR(14), 
		NM_CCGRP	NVARCHAR(100), 
		CD_CCGRP2   NVARCHAR(14), 
		CD_CC	    NVARCHAR(24),
		LEV	        NUMERIC(5)
	)	

	DECLARE
	@V_CD_CCGRP		NVARCHAR(14),
	@V_NM_CCGRP		NVARCHAR(100),
	@V_HD_CCGRP2	NVARCHAR(14),
	@V_CD_CCGRP2	NVARCHAR(14),
	@V_CD_CCGRP3	NVARCHAR(14),
	@V_CD_CC		NVARCHAR(24),
	@V_LEV			NUMERIC(5)

	INSERT INTO @P_TEMP_CCGRP
	SELECT	MC.CD_CCGRP, MC.NM_CCGRP, MC.CD_CCGRP, MG.CD_CC, 0 
	FROM	MA_CCGRP MC 
	INNER JOIN MA_GRPCC MG 
	ON		MG.CD_CCGRP = MC.CD_CCGRP 
	AND		MG.CD_COMPANY = MC.CD_COMPANY
	WHERE	MC.CD_COMPANY = @P_CD_COMPANY_L 
	AND		MC.FG_CCGRP = 'HR' 
	AND		MC.YN_USE = 'Y' 
	AND		HD_CCGRP IS NULL
	  
	DECLARE CUR_HR_PMPRPT_CCGRP1_PA CURSOR FOR
	SELECT	CD_CCGRP, NM_CCGRP, CD_CCGRP2, LEV, CD_CC
	FROM	@P_TEMP_CCGRP
	
		OPEN  CUR_HR_PMPRPT_CCGRP1_PA
		FETCH NEXT FROM CUR_HR_PMPRPT_CCGRP1_PA
		INTO  @V_CD_CCGRP, @V_NM_CCGRP, @V_CD_CCGRP2, @V_LEV, @V_CD_CC
		WHILE (@@FETCH_STATUS = 0 )  
		BEGIN  
			DECLARE CUR_HR_PMPRPT_CCGRP1_CA CURSOR FOR
			SELECT  MC.CD_CCGRP, MC.HD_CCGRP, MG.CD_CC 
			FROM	MA_CCGRP MC 
			INNER JOIN MA_GRPCC MG 
			ON		MG.CD_CCGRP = MC.CD_CCGRP 
			AND		MG.CD_COMPANY = MC.CD_COMPANY
			INNER JOIN @P_TEMP_CCGRP A 
			ON		A.CD_CCGRP2 = MC.HD_CCGRP 
			AND		MG.CD_CC = A.CD_CC
			WHERE	MC.CD_COMPANY = @P_CD_COMPANY_L 
			AND		MC.FG_CCGRP = 'HR' 
			AND		MC.YN_USE = 'Y' 
			AND		A.LEV = @V_LEV	 
			AND		A.CD_CCGRP2 = @V_CD_CCGRP2 
			AND		A.CD_CC = @V_CD_CC
			
			OPEN  CUR_HR_PMPRPT_CCGRP1_CA
			FETCH NEXT FROM CUR_HR_PMPRPT_CCGRP1_CA
			INTO  @V_CD_CCGRP3, @V_HD_CCGRP2, @V_CD_CC
			WHILE ( @@FETCH_STATUS = 0)
			BEGIN
				INSERT INTO @P_TEMP_CCGRP( CD_CCGRP ,NM_CCGRP,CD_CCGRP2, CD_CC, LEV )
				VALUES( @V_CD_CCGRP, @V_NM_CCGRP, @V_CD_CCGRP3, @V_CD_CC, @V_LEV + 1 )
				
				FETCH NEXT FROM CUR_HR_PMPRPT_CCGRP1_CA
				INTO @V_CD_CCGRP3, @V_HD_CCGRP2, @V_CD_CC
			END
			
			CLOSE CUR_HR_PMPRPT_CCGRP1_CA
			DEALLOCATE CUR_HR_PMPRPT_CCGRP1_CA
			
			FETCH NEXT FROM CUR_HR_PMPRPT_CCGRP1_PA
			INTO @V_CD_CCGRP, @V_NM_CCGRP, @V_CD_CCGRP2,  @V_LEV, @V_CD_CC
		END
		
	CLOSE CUR_HR_PMPRPT_CCGRP1_PA
	DEALLOCATE CUR_HR_PMPRPT_CCGRP1_PA

END

-- 집계형태 : 사번, 사번부서제외
IF(@P_TP_SUM IN ('001', '011', '016')) 
BEGIN 
    IF NEOE.FN_SERVERKEY('N', 'SSGFOOD|') = 'Y'
    BEGIN
		SELECT	T.회사코드 CD_COMPANY,
				ISNULL(BI.CD_AREA, '') AS CD_AREA, 
				T.사업장코드     AS CD_BIZAREA,          
				(SELECT NM_SYSDEF FROM MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA, 
				T.부서코드    AS CD_DEPT, 
				T.CC        AS CD_CC, 
				(SELECT    NM_CC FROM MA_CC WHERE CD_COMPANY = T.회사코드 AND CD_CC = T.CC) NM_CC, 
				T.사원구분    AS TP_EMP, 
				(SELECT    NM_SYSDEF FROM MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_P000009' AND CD_SYSDEF = T.사원구분) NM_TP_EMP, 
				T.사번        AS NO_EMP, 
				T.직위코드    AS CD_DUTY_RANK, 
				T.급여구분	  AS TP_PAY,
				CASE WHEN E.CD_PAY_STEP IS NULL OR E.CD_PAY_STEP = '' THEN CONVERT(NVARCHAR(100), ISNULL(CONVERT(NUMERIC(17, 0), E.AM_YPAY), '0'))  ELSE E.CD_PAY_STEP END AM_STEP_YPAY, --남서울대전용 
	 
				E.DT_ENTER, 
				E.DT_RETIRE, 
				E.NO_RES, 
				E.DC_ADDRESS_RES1 + ISNULL(E.DC_ADDRESS_RES2,'') DC_ADDR,        
				E.DT_PROBAT,	--2012.02.28 : 수습만료일 추가
   				(SELECT NM_COMPANY FROM MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00, 
				(SELECT NM_SYSDEF FROM MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직군코드 AND CD_FIELD = 'HR_H000004') NM_DUTY_TYPE,--직군명 
				T.프로젝트코드 CD_PJT,
				(SELECT MAX(NM_PROJECT) FROM SA_PROJECTH WHERE CD_COMPANY = T.회사코드 AND NO_PROJECT = T.프로젝트코드) NM_PJT,
				BI.NM_BIZAREA     AS EMPINFO_01,     
				DE.NM_DEPT     AS EMPINFO_02,         
				T.사번         AS EMPINFO_03,         
				E.NM_KOR     AS EMPINFO_04, E.NM_CHIN, E.NM_ENG,
				(SELECT    NM_SYSDEF FROM MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000002' AND CD_SYSDEF = T.직위코드) AS EMPINFO_05,     
				1         AS NO_CNT, 
				(SELECT    NM_SYSDEF FROM MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000003' AND CD_SYSDEF = T.직급코드) AS EMPINFO_07, 
				T.직책코드,
				(SELECT NM_SYSDEF FROM MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직책코드 AND CD_FIELD = 'HR_H000052') NM_DUTY_RESP,--직책명 
				T.호봉코드    AS EMPINFO_08,  
				E.CD_DUTY_WORK, 
				(SELECT NM_SYSDEF FROM MA_CODEDTL WHERE CD_COMPANY = E.CD_COMPANY AND CD_SYSDEF = E.CD_DUTY_WORK AND CD_FIELD = 'HR_H000039') NM_DUTY_WORK,--직무명 
				E.CD_BANK1, 
				(SELECT NM_SYSDEF FROM MA_CODEDTL WHERE CD_COMPANY = E.CD_COMPANY and  CD_FIELD = 'HR_P000006' and CD_SYSDEF = E.CD_BANK1) NM_BANK1,  
				E.NO_BANK1,
				T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
				T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
				T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
				T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
				
				T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
				T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
				T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
				T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
				 
				(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
				T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
				T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
				T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
				T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
				T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
				T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
				T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
				) AS TOTPAY, 
				
				T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
				T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
				T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
				T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
				
				T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
				T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
				T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
				T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
				
				( 
				T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
				T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
				T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
				T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
				T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
				T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
				T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
				T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
				 - AM_SIN
				) AS TOTDEDUCT, 
				
				(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
				T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
				T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
				T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
				T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
				T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
				T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
				T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
				( 
				T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
				T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
				T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
				T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
				T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
				T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
				T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
				T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
				 - AM_SIN
				) AS GPAY, 
				
				T.AM_TOTTAX, T.AM_TOTNOTAX, T.AM_NOTAX0, T.AM_NOTAX1, T.AM_NOTAX2, T.IN_PAY, T.DT_PAY
		FROM    
		( 
			SELECT  회사코드 ,사업장코드, 
					부서코드, 
					CC, 
					직위코드, 
					사원구분, 
					사번, 
					급여구분,
					직군코드, 
					직급코드,
					직책코드,
					호봉코드, 
					프로젝트코드,
					IN_PAY, DT_PAY,
					SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
					SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
					SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
					SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
					SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
					SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
					SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
					SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 					
					SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
					SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
					SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
					SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
					SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
					SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
					SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
					SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 

					SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
					SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
					SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
					SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
					SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
					SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
					SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
					SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
					SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
					SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
					SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
					SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
					SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
					SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
					SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
					SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
					
					ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, SUM(ISNULL(AM_NOTAX1, 0)) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
					ISNULL(SUM(AM_SIN), 0) AM_SIN
			FROM    @P_DTEMP 
			GROUP BY 회사코드, 사업장코드, 부서코드, CC, 직위코드, 사원구분, 사번, 직군코드, 직급코드, 직책코드, 호봉코드, 프로젝트코드, 급여구분, IN_PAY, DT_PAY
		) AS T 
		LEFT OUTER JOIN MA_EMP AS E 
		ON  T.회사코드 = E.CD_COMPANY AND  T.사번    = E.NO_EMP 
		LEFT OUTER JOIN MA_BIZAREA AS BI 
		ON  T.회사코드 = BI.CD_COMPANY AND  T.사업장코드    = BI.CD_BIZAREA 
		LEFT OUTER JOIN MA_DEPT AS DE 
		ON    T.부서코드    = DE.CD_DEPT 
		AND    T.회사코드 = DE.CD_COMPANY  
		LEFT OUTER JOIN @P_TEMP_CCGRP B 
		ON T.CC = B.CD_CC    
		ORDER BY T.회사코드 ASC, T.사업장코드 ASC,  T.부서코드 ASC, T.사번 ASC, T.직위코드 ASC 
		
    END
    ELSE IF NEOE.FN_SERVERKEY('N', 'TMFK|TMFK2|TMFK3|') = 'Y'
    BEGIN
		SELECT	T.회사코드 CD_COMPANY,
				ISNULL(BI.CD_AREA, '') AS CD_AREA, 
				T.사업장코드     AS CD_BIZAREA,          
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA, 
				T.부서코드    AS CD_DEPT, 
				T.CC        AS CD_CC, 
				(SELECT    NM_CC FROM DZSN_MA_CC WHERE CD_COMPANY = T.회사코드 AND CD_CC = T.CC) NM_CC, 
				T.사원구분    AS TP_EMP, 
				(SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_P000009' AND CD_SYSDEF = T.사원구분) NM_TP_EMP, 
				T.사번        AS NO_EMP, 
				T.직위코드    AS CD_DUTY_RANK, 
				CASE WHEN E.CD_PAY_STEP IS NULL OR E.CD_PAY_STEP = '' THEN CONVERT(NVARCHAR(100), ISNULL(CONVERT(NUMERIC(17, 0), E.AM_YPAY), '0'))  ELSE E.CD_PAY_STEP END AM_STEP_YPAY, --남서울대전용 
	 
				E.DT_ENTER, 
				E.DT_GENTER,
				E.DT_RETIRE, 
				E.NO_RES, 
				E.DC_ADDRESS_RES1 + ISNULL(E.DC_ADDRESS_RES2,'') DC_ADDR,        
				E.DT_PROBAT,	--2012.02.28 : 수습만료일 추가
   				(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00, 
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직군코드 AND CD_FIELD = 'HR_H000004') NM_DUTY_TYPE,--직군명 
				T.프로젝트코드 CD_PJT,
				(SELECT MAX(NM_PROJECT) FROM DZSN_SA_PROJECTH WHERE CD_COMPANY = T.회사코드 AND NO_PROJECT = T.프로젝트코드) NM_PJT,
				BI.NM_BIZAREA     AS EMPINFO_01,     
				DE.NM_DEPT     AS EMPINFO_02,         
				T.사번         AS EMPINFO_03,         
				E.NM_KOR     AS EMPINFO_04, E.NM_CHIN, E.NM_ENG,
				(SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000002' AND CD_SYSDEF = T.직위코드) AS EMPINFO_05,     
				1         AS NO_CNT, 
				(SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000003' AND CD_SYSDEF = T.직급코드) AS EMPINFO_07, 
				T.직책코드,
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직책코드 AND CD_FIELD = 'HR_H000052') NM_DUTY_RESP,--직책명 
				T.호봉코드    AS EMPINFO_08,  
				E.CD_DUTY_WORK, 
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = E.CD_COMPANY AND CD_SYSDEF = E.CD_DUTY_WORK AND CD_FIELD = 'HR_H000039') NM_DUTY_WORK,--직무명 
				E.CD_BANK1, 
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = E.CD_COMPANY and  CD_FIELD = 'HR_P000006' and CD_SYSDEF = E.CD_BANK1) NM_BANK1,  
				E.NO_BANK1,
				E.CD_PART,
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = E.CD_COMPANY and  CD_FIELD = 'HR_G000001' and CD_SYSDEF = E.CD_PART) NM_CD_PART,
				T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
				T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
				T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
				T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
				
				T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
				T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
				T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
				T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
				 
				(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
				T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
				T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
				T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
				T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
				T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
				T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
				T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
				) AS TOTPAY, 
				
				T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
				T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
				T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
				T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
				
				T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
				T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
				T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
				T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
				
				( 
				T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
				T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
				T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
				T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
				T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
				T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
				T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
				T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
				 - AM_SIN
				) AS TOTDEDUCT, 
				
				(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
				T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
				T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
				T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
				T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
				T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
				T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
				T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
				( 
				T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
				T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
				T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
				T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
				T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
				T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
				T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
				T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
				 - AM_SIN
				) AS GPAY, 
				T.AM_TOTTAX, T.AM_TOTNOTAX, T.AM_NOTAX0, T.AM_NOTAX1, T.AM_NOTAX2,
				ISNULL(B.CD_CCGRP,'') CD_CCGRP,  ISNULL(B.NM_CCGRP,'') EMPINFO_09,      -- 추가 C/C그룹
				( SELECT NM_CC FROM DZSN_MA_CC WHERE CD_CC = T.CC AND CD_COMPANY = @P_CD_COMPANY_L ) EMPINFO_10,  -- 추가 코스트센터
				ISNULL((SELECT CONVERT(NUMERIC, CASE WHEN NO_ORDER = '' THEN 999999 ELSE NO_ORDER END) FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000002' AND CD_SYSDEF = T.직위코드), 999999) DUTY_RANK_ORDER,
				T.CD_JOB_SERIES,
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.CD_JOB_SERIES AND CD_FIELD = 'HR_H000053') NM_JOB_SERIES,
				T.CD_LTAX_AREA,
				T.AM_ANNU, T.AM_INS, T.AM_INS1, T.AM_OINS, T.AM_OINS1,
				T.AM_EMPE, T.AM_EMPE1, T.AM_FIRE, T.AM_FIRE1,				
				(T.AM_ANNU + T.AM_INS + T.AM_INS1 + T.AM_OINS + T.AM_OINS1 + T.AM_EMPE + T.AM_EMPE1 + T.AM_FIRE + T.AM_FIRE1) AM_INSU_SUM,
				
				T.AM_PAY01_ER, T.AM_PAY02_ER, T.AM_PAY03_ER, T.AM_PAY04_ER, T.AM_PAY05_ER, T.AM_PAY06_ER, T.AM_PAY07_ER, T.AM_PAY08_ER, T.AM_PAY09_ER, T.AM_PAY10_ER,
				T.AM_PAY11_ER, T.AM_PAY12_ER, T.AM_PAY13_ER, T.AM_PAY14_ER, T.AM_PAY15_ER, T.AM_PAY16_ER, T.AM_PAY17_ER, T.AM_PAY18_ER, T.AM_PAY19_ER, T.AM_PAY20_ER,
				T.AM_PAY21_ER, T.AM_PAY22_ER, T.AM_PAY23_ER, T.AM_PAY24_ER, T.AM_PAY25_ER, T.AM_PAY26_ER, T.AM_PAY27_ER, T.AM_PAY28_ER, T.AM_PAY29_ER, T.AM_PAY30_ER				
		FROM    
		( 
			SELECT  회사코드 ,사업장코드, 
					부서코드, 
					CC, 
					직위코드, 
					사원구분, 
					사번, 
					직군코드, 
					직급코드,
					직책코드,
					호봉코드,
					프로젝트코드,
					SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
					SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
					SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
					SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
					SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
					SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
					SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
					SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
					SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
					SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
					SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
					SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
					SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
					SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
					SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
					SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40,   
            
					SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
					SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
					SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
					SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
					SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
					SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
					SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
					SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
					SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
					SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
					SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
					SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
					SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
					SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
					SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
					SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,

					ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, SUM(ISNULL(AM_NOTAX1, 0)) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
					ISNULL(SUM(AM_SIN), 0) AM_SIN, 
					CD_JOB_SERIES, CD_LTAX_AREA,
					
					SUM(ISNULL(AM_ANNU, 0)) AM_ANNU,
					SUM(ISNULL(AM_INS, 0)) AM_INS,
					SUM(ISNULL(AM_INS1, 0)) AM_INS1,
					SUM(ISNULL(AM_OINS, 0)) AM_OINS,
					SUM(ISNULL(AM_OINS1, 0)) AM_OINS1,
					
					SUM(ISNULL(AM_EMPE, 0)) AM_EMPE,
					SUM(ISNULL(AM_EMPE1, 0)) AM_EMPE1,
					SUM(ISNULL(AM_FIRE, 0)) AM_FIRE,
					SUM(ISNULL(AM_FIRE1, 0)) AM_FIRE1,
					
					SUM(ISNULL(AM_PAY01_ER, 0)) AM_PAY01_ER, 
					SUM(ISNULL(AM_PAY02_ER, 0)) AM_PAY02_ER, 
					SUM(ISNULL(AM_PAY03_ER, 0)) AM_PAY03_ER, 
					SUM(ISNULL(AM_PAY04_ER, 0)) AM_PAY04_ER, 
					SUM(ISNULL(AM_PAY05_ER, 0)) AM_PAY05_ER, 
					SUM(ISNULL(AM_PAY06_ER, 0)) AM_PAY06_ER, 
					SUM(ISNULL(AM_PAY07_ER, 0)) AM_PAY07_ER, 
					SUM(ISNULL(AM_PAY08_ER, 0)) AM_PAY08_ER, 
					SUM(ISNULL(AM_PAY09_ER, 0)) AM_PAY09_ER, 
					SUM(ISNULL(AM_PAY10_ER, 0)) AM_PAY10_ER,
					SUM(ISNULL(AM_PAY11_ER, 0)) AM_PAY11_ER, 
					SUM(ISNULL(AM_PAY12_ER, 0)) AM_PAY12_ER, 
					SUM(ISNULL(AM_PAY13_ER, 0)) AM_PAY13_ER, 
					SUM(ISNULL(AM_PAY14_ER, 0)) AM_PAY14_ER, 
					SUM(ISNULL(AM_PAY15_ER, 0)) AM_PAY15_ER, 
					SUM(ISNULL(AM_PAY16_ER, 0)) AM_PAY16_ER, 
					SUM(ISNULL(AM_PAY17_ER, 0)) AM_PAY17_ER, 
					SUM(ISNULL(AM_PAY18_ER, 0)) AM_PAY18_ER, 
					SUM(ISNULL(AM_PAY19_ER, 0)) AM_PAY19_ER, 
					SUM(ISNULL(AM_PAY20_ER, 0)) AM_PAY20_ER,
					SUM(ISNULL(AM_PAY21_ER, 0)) AM_PAY21_ER, 
					SUM(ISNULL(AM_PAY22_ER, 0)) AM_PAY22_ER, 
					SUM(ISNULL(AM_PAY23_ER, 0)) AM_PAY23_ER, 
					SUM(ISNULL(AM_PAY24_ER, 0)) AM_PAY24_ER, 
					SUM(ISNULL(AM_PAY25_ER, 0)) AM_PAY25_ER, 
					SUM(ISNULL(AM_PAY26_ER, 0)) AM_PAY26_ER, 
					SUM(ISNULL(AM_PAY27_ER, 0)) AM_PAY27_ER, 
					SUM(ISNULL(AM_PAY28_ER, 0)) AM_PAY28_ER, 
					SUM(ISNULL(AM_PAY29_ER, 0)) AM_PAY29_ER, 
					SUM(ISNULL(AM_PAY30_ER, 0)) AM_PAY30_ER
					
			FROM    @P_DTEMP 
			GROUP BY 회사코드, 사업장코드, 부서코드, CC, 직위코드, 사원구분, 사번, 직군코드, 직급코드, 직책코드, 호봉코드, 프로젝트코드, CD_JOB_SERIES, CD_LTAX_AREA
		) AS T 
		LEFT OUTER JOIN DZSN_MA_EMP AS E 
		ON  T.회사코드 = E.CD_COMPANY AND  T.사번    = E.NO_EMP 
		LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
		ON  T.회사코드 = BI.CD_COMPANY AND  T.사업장코드    = BI.CD_BIZAREA 
		LEFT OUTER JOIN DZSN_MA_DEPT AS DE 
		ON    T.부서코드    = DE.CD_DEPT 
		AND    T.회사코드 = DE.CD_COMPANY  
		LEFT OUTER JOIN @P_TEMP_CCGRP B ON T.CC = B.CD_CC
		ORDER BY T.회사코드 ASC, T.사업장코드 ASC,  T.부서코드 ASC, T.사번 ASC, T.직위코드 ASC      
    END
    ELSE IF NEOE.FN_SERVERKEY('N', 'DSCON|') = 'Y'
    BEGIN
		SELECT	T.회사코드 CD_COMPANY,
				ISNULL(BI.CD_AREA, '') AS CD_AREA, 
				T.사업장코드     AS CD_BIZAREA,          
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA, 
				T.부서코드    AS CD_DEPT, 
				T.CC        AS CD_CC, 
				(SELECT    NM_CC FROM DZSN_MA_CC WHERE CD_COMPANY = T.회사코드 AND CD_CC = T.CC) NM_CC, 
				T.사원구분    AS TP_EMP, 
				(SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_P000009' AND CD_SYSDEF = T.사원구분) NM_TP_EMP, 
				T.사번        AS NO_EMP, 
				T.직위코드    AS CD_DUTY_RANK, 
				CASE WHEN E.CD_PAY_STEP IS NULL OR E.CD_PAY_STEP = '' THEN CONVERT(NVARCHAR(100), ISNULL(CONVERT(NUMERIC(17, 0), E.AM_YPAY), '0'))  ELSE E.CD_PAY_STEP END AM_STEP_YPAY, --남서울대전용 
	 
				E.DT_ENTER, 
				E.DT_GENTER,
				E.DT_RETIRE, 
				E.NO_RES, 
				E.DC_ADDRESS_RES1 + ISNULL(E.DC_ADDRESS_RES2,'') DC_ADDR,        
				E.DT_PROBAT,	--2012.02.28 : 수습만료일 추가
   				(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00, 
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직군코드 AND CD_FIELD = 'HR_H000004') NM_DUTY_TYPE,--직군명 
				T.프로젝트코드 CD_PJT,
				(SELECT MAX(NM_PROJECT) FROM DZSN_SA_PROJECTH WHERE CD_COMPANY = T.회사코드 AND NO_PROJECT = T.프로젝트코드) NM_PJT,
				BI.NM_BIZAREA     AS EMPINFO_01,     
				DE.NM_DEPT     AS EMPINFO_02,         
				T.사번         AS EMPINFO_03,         
				E.NM_KOR     AS EMPINFO_04, E.NM_CHIN, E.NM_ENG,
				(SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000002' AND CD_SYSDEF = T.직위코드) AS EMPINFO_05,     
				1         AS NO_CNT, 
				(SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000003' AND CD_SYSDEF = T.직급코드) AS EMPINFO_07, 
				T.직책코드,
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직책코드 AND CD_FIELD = 'HR_H000052') NM_DUTY_RESP,--직책명 
				T.호봉코드    AS EMPINFO_08,  
				E.CD_DUTY_WORK, 
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = E.CD_COMPANY AND CD_SYSDEF = E.CD_DUTY_WORK AND CD_FIELD = 'HR_H000039') NM_DUTY_WORK,--직무명 
				E.CD_BANK1, 
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = E.CD_COMPANY and  CD_FIELD = 'HR_P000006' and CD_SYSDEF = E.CD_BANK1) NM_BANK1,  
				E.NO_BANK1,
				E.CD_PART,
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = E.CD_COMPANY and  CD_FIELD = 'HR_G000001' and CD_SYSDEF = E.CD_PART) NM_CD_PART,
				T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
				T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
				T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
				T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
				
				T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
				T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
				T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
				T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
				 
				(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
				T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
				T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
				T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
				T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
				T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
				T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
				T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
				) AS TOTPAY, 
				
				T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
				T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
				T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
				T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
				
				T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
				T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
				T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
				T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
				
				( 
				T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
				T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
				T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
				T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
				T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
				T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
				T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
				T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
				 - AM_SIN
				) AS TOTDEDUCT, 
				
				(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
				T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
				T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
				T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
				T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
				T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
				T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
				T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
				( 
				T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
				T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
				T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
				T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
				T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
				T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
				T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
				T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
				 - AM_SIN
				) AS GPAY, 
				T.AM_TOTTAX, T.AM_TOTNOTAX, T.AM_NOTAX0, T.AM_NOTAX1, T.AM_NOTAX2,
				ISNULL(B.CD_CCGRP,'') CD_CCGRP,  ISNULL(B.NM_CCGRP,'') EMPINFO_09,      -- 추가 C/C그룹
				( SELECT NM_CC FROM DZSN_MA_CC WHERE CD_CC = T.CC AND CD_COMPANY = @P_CD_COMPANY_L ) EMPINFO_10,  -- 추가 코스트센터
				ISNULL((SELECT CONVERT(NUMERIC, CASE WHEN NO_ORDER = '' THEN 999999 ELSE NO_ORDER END) FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000002' AND CD_SYSDEF = T.직위코드), 999999) DUTY_RANK_ORDER,
				T.CD_JOB_SERIES,
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.CD_JOB_SERIES AND CD_FIELD = 'HR_H000053') NM_JOB_SERIES,
				T.CD_LTAX_AREA,
				E.DT_BIRTH,
				CONVERT(NVARCHAR, NEOE.FN_HR_AGE(E.NO_RES, @P_YM+'01')) AGE,
				NEOE.FN_HR_GETSTARTENDGIGAN(E.DT_GENTER, SUBSTRING(NEOE.SF_SYSDATE(GETDATE()), 1, 8)) GUNSOKGIGAN,
				E.DT_LASTRAN,
				NEOE.FN_HR_GETSTARTENDGIGAN(E.DT_LASTRAN, SUBSTRING(NEOE.SF_SYSDATE(GETDATE()), 1, 8)) GIGAN,
				(
					SELECT TOP 1 T.DC_ITEM 
					FROM (	
						SELECT CD_COMPANY, NO_EMP, CD_PRIZE CD_HUP, DT_PRIZE DT_HUP, NO_SEQ, DC_ITEM FROM HR_HUPRIZE WHERE CD_COMPANY = E.CD_COMPANY AND NO_EMP = E.NO_EMP
						UNION ALL
						SELECT CD_COMPANY, NO_EMP, CD_DISCIP CD_HUP, DT_DISCIP DT_HUP, NO_SEQ, DC_ITEM FROM HR_HUDISCIP WHERE CD_COMPANY = E.CD_COMPANY AND NO_EMP = E.NO_EMP
					) T 
					ORDER BY T.DT_HUP DESC, T.NO_SEQ DESC, T.CD_HUP DESC
				) DC_ITEM,
				(
					SELECT	NM_SYSDEF 
					FROM	DZSN_MA_CODEDTL 
					WHERE	CD_COMPANY = E.CD_COMPANY 
					AND		CD_FIELD = 'HR_H000005' 
					AND		CD_SYSDEF = (SELECT TOP 1 CD_CAREER FROM HR_SCHOCARE WHERE CD_COMPANY = E.CD_COMPANY AND NO_EMP = E.NO_EMP AND TP_LASTSCH = '001' ORDER BY NO_SEQ DESC)
				) NM_SCH_CAREER,
				(SELECT TOP 1 NM_SCH FROM HR_SCHOCARE WHERE CD_COMPANY = E.CD_COMPANY AND NO_EMP = E.NO_EMP AND TP_LASTSCH = '001' ORDER BY NO_SEQ DESC) NM_SCH
		FROM    
		( 
			SELECT  회사코드 ,사업장코드, 
					부서코드, 
					CC, 
					직위코드, 
					사원구분, 
					사번, 
					직군코드, 
					직급코드,
					직책코드,
					호봉코드,
					프로젝트코드,
					SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
					SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
					SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
					SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
					SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
					SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
					SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
					SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
					SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
					SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
					SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
					SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
					SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
					SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
					SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
					SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40,   
            
					SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
					SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
					SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
					SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
					SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
					SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
					SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
					SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
					SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
					SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
					SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
					SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
					SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
					SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
					SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
					SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,

					ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, SUM(ISNULL(AM_NOTAX1, 0)) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
					ISNULL(SUM(AM_SIN), 0) AM_SIN, 
					CD_JOB_SERIES, CD_LTAX_AREA
			FROM    @P_DTEMP 
			GROUP BY 회사코드, 사업장코드, 부서코드, CC, 직위코드, 사원구분, 사번, 직군코드, 직급코드, 직책코드, 호봉코드, 프로젝트코드, CD_JOB_SERIES, CD_LTAX_AREA
		) AS T 
		LEFT OUTER JOIN DZSN_MA_EMP AS E 
		ON  T.회사코드 = E.CD_COMPANY AND  T.사번    = E.NO_EMP 
		LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
		ON  T.회사코드 = BI.CD_COMPANY AND  T.사업장코드    = BI.CD_BIZAREA 
		LEFT OUTER JOIN DZSN_MA_DEPT AS DE 
		ON    T.부서코드    = DE.CD_DEPT 
		AND    T.회사코드 = DE.CD_COMPANY  
		LEFT OUTER JOIN @P_TEMP_CCGRP B 
		ON T.CC = B.CD_CC    
		ORDER BY T.회사코드 ASC, T.사업장코드 ASC,  T.부서코드 ASC, T.사번 ASC, T.직위코드 ASC  
    END
    ELSE
    BEGIN
		SELECT	T.회사코드 CD_COMPANY,
				ISNULL(BI.CD_AREA, '') AS CD_AREA, 
				T.사업장코드     AS CD_BIZAREA,          
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA, 								
				DP.NM_DEPT H_NM_DEPT,
				T.부서코드    AS CD_DEPT, 
				T.CC        AS CD_CC, 
				(SELECT    NM_CC FROM DZSN_MA_CC WHERE CD_COMPANY = T.회사코드 AND CD_CC = T.CC) NM_CC, 
				T.사원구분    AS TP_EMP, 
				(SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_P000009' AND CD_SYSDEF = T.사원구분) NM_TP_EMP, 
				T.사번        AS NO_EMP, 
				T.직위코드    AS CD_DUTY_RANK, 
				CASE WHEN E.CD_PAY_STEP IS NULL OR E.CD_PAY_STEP = '' THEN CONVERT(NVARCHAR(100), ISNULL(CONVERT(NUMERIC(17, 0), E.AM_YPAY), '0'))  ELSE E.CD_PAY_STEP END AM_STEP_YPAY, --남서울대전용 
	 
				E.DT_ENTER, 
				E.DT_GENTER,
				E.DT_RETIRE, 
				E.NO_RES, 
				E.DC_ADDRESS_RES1 + ISNULL(E.DC_ADDRESS_RES2,'') DC_ADDR,        
				E.DT_PROBAT,	--2012.02.28 : 수습만료일 추가
   				(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00, 
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직군코드 AND CD_FIELD = 'HR_H000004') NM_DUTY_TYPE,--직군명 
				T.프로젝트코드 CD_PJT,
				(SELECT MAX(NM_PROJECT) FROM DZSN_SA_PROJECTH WHERE CD_COMPANY = T.회사코드 AND NO_PROJECT = T.프로젝트코드) NM_PJT,
				BI.NM_BIZAREA     AS EMPINFO_01,     
				DE.NM_DEPT     AS EMPINFO_02,         
				T.사번         AS EMPINFO_03,         
				E.NM_KOR     AS EMPINFO_04, E.NM_CHIN, E.NM_ENG,
				(SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000002' AND CD_SYSDEF = T.직위코드) AS EMPINFO_05,     
				1         AS NO_CNT, 
				(SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000003' AND CD_SYSDEF = T.직급코드) AS EMPINFO_07, 
				T.직책코드,
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직책코드 AND CD_FIELD = 'HR_H000052') NM_DUTY_RESP,--직책명 
				T.호봉코드    AS EMPINFO_08,  
				E.CD_DUTY_WORK, 
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = E.CD_COMPANY AND CD_SYSDEF = E.CD_DUTY_WORK AND CD_FIELD = 'HR_H000039') NM_DUTY_WORK,--직무명 
				E.CD_BANK1, 
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = E.CD_COMPANY and  CD_FIELD = 'HR_P000006' and CD_SYSDEF = E.CD_BANK1) NM_BANK1,  
				E.NO_BANK1,
				E.CD_PART,
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = E.CD_COMPANY and  CD_FIELD = 'HR_G000001' and CD_SYSDEF = E.CD_PART) NM_CD_PART,
				T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
				T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
				T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
				T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
				
				T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
				T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
				T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
				T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
				 
				(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
				T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
				T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
				T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
				T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
				T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
				T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
				T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
				) AS TOTPAY, 
				
				T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
				T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
				T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
				T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
				
				T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
				T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
				T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
				T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
				
				( 
				T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
				T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
				T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
				T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
				T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
				T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
				T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
				T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
				 - AM_SIN
				) AS TOTDEDUCT, 
				
				(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
				T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
				T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
				T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
				T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
				T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
				T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
				T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
				( 
				T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
				T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
				T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
				T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
				T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
				T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
				T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
				T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
				 - AM_SIN
				) AS GPAY, 
				T.AM_TOTTAX, T.AM_TOTNOTAX, T.AM_NOTAX0, T.AM_NOTAX1, T.AM_NOTAX2,
				ISNULL(B.CD_CCGRP,'') CD_CCGRP,  ISNULL(B.NM_CCGRP,'') EMPINFO_09,      -- 추가 C/C그룹
				( SELECT NM_CC FROM DZSN_MA_CC WHERE CD_CC = T.CC AND CD_COMPANY = @P_CD_COMPANY_L ) EMPINFO_10,  -- 추가 코스트센터
				ISNULL((SELECT CONVERT(NUMERIC, CASE WHEN NO_ORDER = '' THEN 999999 ELSE NO_ORDER END) FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000002' AND CD_SYSDEF = T.직위코드), 999999) DUTY_RANK_ORDER,
				T.CD_JOB_SERIES,
				(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.CD_JOB_SERIES AND CD_FIELD = 'HR_H000053') NM_JOB_SERIES,
				T.CD_LTAX_AREA, T.AM_NEMPA, T.AM_FIRE
		FROM    
		( 
			SELECT  회사코드 ,사업장코드, 
					부서코드, 
					CC, 
					직위코드, 
					사원구분, 
					사번, 
					직군코드, 
					직급코드,
					직책코드,
					호봉코드,
					프로젝트코드,
					SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
					SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
					SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
					SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
					SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
					SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
					SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
					SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
					SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
					SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
					SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
					SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
					SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
					SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
					SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
					SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40,   
            
					SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
					SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
					SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
					SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
					SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
					SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
					SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
					SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
					SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
					SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
					SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
					SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
					SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
					SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
					SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
					SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,

					ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, SUM(ISNULL(AM_NOTAX1, 0)) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
					ISNULL(SUM(AM_SIN), 0) AM_SIN, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE,
					CD_JOB_SERIES, CD_LTAX_AREA
			FROM    @P_DTEMP 
			GROUP BY 회사코드, 사업장코드, 부서코드, CC, 직위코드, 사원구분, 사번, 직군코드, 직급코드, 직책코드, 호봉코드, 프로젝트코드, CD_JOB_SERIES, CD_LTAX_AREA
		) AS T 
		LEFT OUTER JOIN DZSN_MA_EMP AS E 
		ON  T.회사코드 = E.CD_COMPANY AND  T.사번    = E.NO_EMP 
		LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
		ON  T.회사코드 = BI.CD_COMPANY AND  T.사업장코드    = BI.CD_BIZAREA 
		LEFT OUTER JOIN DZSN_MA_DEPT AS DE 
		ON    T.부서코드    = DE.CD_DEPT 
		AND    T.회사코드 = DE.CD_COMPANY 
		LEFT OUTER JOIN DZSN_MA_DEPT DP
		ON		DE.CD_COMPANY = DP.CD_COMPANY
		AND		DE.CD_BIZAREA = DP.CD_BIZAREA
		AND		DE.H_DEPT = DP.CD_DEPT	 
		LEFT OUTER JOIN @P_TEMP_CCGRP B 
		ON T.CC = B.CD_CC    
		ORDER BY T.회사코드 ASC, T.사업장코드 ASC,  T.부서코드 ASC, T.사번 ASC, T.직위코드 ASC  
    
    END
		
END 
-- 집계형태 : 부서 
ELSE IF(@P_TP_SUM = '002') 
BEGIN 
    SELECT    T.회사코드 CD_COMPANY,
		(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,  
		 ISNULL(BI.CD_AREA, '') CD_AREA, 
        T.사업장코드     AS CD_BIZAREA,          
        (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA, 
		DP.NM_DEPT H_NM_DEPT,
        T.부서코드    AS CD_DEPT, 
        BI.NM_BIZAREA     AS EMPINFO_01,     
        DE.NM_DEPT     AS EMPINFO_02,         
        ISNULL((SELECT COUNT(DISTINCT 사번) FROM @P_DTEMP WHERE 사업장코드 = T.사업장코드 AND 부서코드 = T.부서코드), 0)  
                AS NO_CNT, 
        T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
		T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
		T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
		T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
		
		T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
		T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
		T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
		T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
		 
		(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
		T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
		T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
		T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
		T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
		) AS TOTPAY, 
		
		T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
		T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
		T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
		T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
		
		T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
		T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
		T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
		T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
		
		( 
		T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
		T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
		T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
		T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
		T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
		 - AM_SIN
		) AS TOTDEDUCT, 
		
		(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
		T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
		T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
		T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
		T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
		( 
		T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
		T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
		T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
		T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
		T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
		 - AM_SIN
		) AS GPAY, 
        AM_TOTTAX, AM_TOTNOTAX, AM_NOTAX0, AM_NOTAX1, AM_NOTAX2, AM_NEMPA, AM_FIRE 
     
    FROM    ( 
        SELECT   회사코드, 사업장코드, 부서코드, 
            SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
            SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
            SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
            SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
            SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
            SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
            SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
            SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
            SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
            SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
            SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
            SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
            SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
            SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
            SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
            SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40,             
            
            SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
			SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
			SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
			SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
			SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
			SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
			SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
			SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
			SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
			SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
			SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
			SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
			SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
			SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
			SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
			SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
            
            ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
            ISNULL(SUM(AM_SIN), 0) AM_SIN, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE
        FROM    @P_DTEMP 
        GROUP BY 회사코드,  사업장코드, 부서코드 
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
    ON   T.회사코드 = BI.CD_COMPANY AND T.사업장코드    = BI.CD_BIZAREA 
    LEFT OUTER JOIN DZSN_MA_DEPT AS DE 
    ON  T.회사코드 = DE.CD_COMPANY AND  T.부서코드    = DE.CD_DEPT  
	LEFT OUTER JOIN DZSN_MA_DEPT DP
		ON		DE.CD_COMPANY = DP.CD_COMPANY
		AND		DE.CD_BIZAREA = DP.CD_BIZAREA
		AND		DE.H_DEPT = DP.CD_DEPT
    ORDER BY T.회사코드 ASC, T.사업장코드 ASC, T.부서코드 ASC 
END 
-- 집계형태 : 사업장 
ELSE IF(@P_TP_SUM = '003') 
BEGIN 
    SELECT    T.회사코드 CD_COMPANY,
		(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,   
		 ISNULL(BI.CD_AREA, '') CD_AREA, 
        T.사업장코드     AS CD_BIZAREA,          
        (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA, 
        --T.부서코드    AS CD_DEPT, 
        BI.NM_BIZAREA     AS EMPINFO_01,     
        ISNULL((SELECT COUNT(DISTINCT 사번) FROM @P_DTEMP WHERE 사업장코드 = T.사업장코드), 0)  
                AS NO_CNT, 
        T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
		T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
		T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
		T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
		
		T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
		T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
		T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
		T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
		 
		(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
		T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
		T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
		T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
		T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
		) AS TOTPAY, 
		
		T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
		T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
		T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
		T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
		
		T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
		T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
		T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
		T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
		
		( 
		T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
		T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
		T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
		T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
		T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
		 - AM_SIN
		) AS TOTDEDUCT, 
		
		(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
		T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
		T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
		T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
		T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
		( 
		T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
		T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
		T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
		T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
		T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
		 - AM_SIN
		) AS GPAY, 
        AM_TOTTAX, AM_TOTNOTAX, AM_NOTAX0, AM_NOTAX1, AM_NOTAX2, AM_NEMPA, AM_FIRE 
     
    FROM    ( 
        SELECT  회사코드,  사업장코드, --부서코드,
            SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
            SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
            SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
            SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
            SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
            SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
            SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
            SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
            SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
            SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
            SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
            SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
            SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
            SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
            SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
            SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 
            
    		SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
			SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
			SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
			SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
			SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
			SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
			SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
			SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
			SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
			SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
			SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
			SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
			SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
			SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
			SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
			SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
            
            ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
            ISNULL(SUM(AM_SIN), 0) AM_SIN, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드--, 부서코드 
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
    ON  BI.CD_COMPANY    = T.회사코드  AND  T.사업장코드    = BI.CD_BIZAREA  
    ORDER BY T.회사코드 ASC, T.사업장코드 ASC 
END 
-- 집계형태 : 직군 
IF(@P_TP_SUM = '004') 
BEGIN 
    SELECT     T.회사코드 CD_COMPANY,
		(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,   
		 ISNULL(BI.CD_AREA, '') CD_AREA, 
        T.사업장코드     AS CD_BIZAREA,          
        ISNULL((SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA), '') AS NM_AREA, 
		DP.NM_DEPT H_NM_DEPT,
        T.부서코드    AS CD_DEPT, 
        T.사번        AS NO_EMP, 
        E.NM_KOR, 
        T.직군코드    AS CD_DUTY_TYPE, 
        (SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직군코드 AND CD_FIELD = 'HR_H000004') NM_DUTY_TYPE,--직군명 
        T.직급코드    AS CD_DUTY_STEP, 
        T.사원구분    AS TP_EMP, 
        (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_P000009' AND CD_SYSDEF = T.사원구분) NM_TP_EMP, 
        BI.NM_BIZAREA     AS EMPINFO_01,     
        DE.NM_DEPT     AS EMPINFO_02,         
        T.사번         AS EMPINFO_03,         
        E.NM_KOR     AS EMPINFO_04,    E.NM_CHIN,      E.NM_ENG,
        E.DT_ENTER    AS EMPINFO_05,     
        CASE WHEN E.DT_RETIRE IS NULL OR E.DT_RETIRE = '' OR E.DT_RETIRE = '99999999' OR E.DT_RETIRE = '00000000' THEN '' ELSE E.DT_RETIRE END  
 
                AS EMPINFO_06, 
        (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000003' AND CD_SYSDEF = T.직급코드) 
                AS EMPINFO_07, 
        T.호봉코드    AS EMPINFO_08, 
        ISNULL((SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000004' AND CD_SYSDEF = T.직군코드), '')  
                AS EMPINFO_09,     
        1 AS NO_CNT,
		E.DT_GENTER,
        T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
		T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
		T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
		T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
		
		T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
		T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
		T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
		T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
		 
		(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
		T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
		T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
		T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
		T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
		) AS TOTPAY, 
		
		T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
		T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
		T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
		T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
		
		T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
		T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
		T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
		T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
		
		( 
		T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
		T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
		T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
		T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
		T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
		 - AM_SIN
		) AS TOTDEDUCT, 
		
		(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
		T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
		T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
		T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
		T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
		( 
		T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
		T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
		T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
		T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
		T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
		 - AM_SIN
		) AS GPAY,
        AM_TOTTAX, AM_TOTNOTAX, AM_NOTAX0, AM_NOTAX1, AM_NOTAX2, AM_NEMPA, AM_FIRE,
		T.CD_LTAX_AREA
    FROM    ( 
        SELECT   회사코드, 사업장코드, 
            부서코드, 
            직위코드, 
            직군코드, 
            직급코드, 
            호봉코드, 
            사원구분, 
            사번, 
            SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
            SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
            SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
            SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
            SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
            SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
            SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
            SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
            SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
            SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
            SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
            SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
            SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
            SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
            SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
            SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 
            
            SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
			SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
			SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
			SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
			SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
			SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
			SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
			SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
			SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
			SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
			SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
			SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
			SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
			SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
			SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
			SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
            
            ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX,ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
            ISNULL(SUM(AM_SIN), 0) AM_SIN, CD_LTAX_AREA,
            ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE  
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드, 부서코드, 직위코드, 직군코드, 직급코드, 호봉코드, 사원구분, 사번, CD_LTAX_AREA
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_EMP AS E 
    ON  T.회사코드 = E.CD_COMPANY AND  T.사번    = E.NO_EMP 
    LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
    ON  T.회사코드 = BI.CD_COMPANY AND  T.사업장코드    = BI.CD_BIZAREA 
    LEFT OUTER JOIN DZSN_MA_DEPT AS DE 
    ON  T.회사코드 = DE.CD_COMPANY AND  T.부서코드    = DE.CD_DEPT  
	LEFT OUTER JOIN DZSN_MA_DEPT DP
		ON		DE.CD_COMPANY = DP.CD_COMPANY
		AND		DE.CD_BIZAREA = DP.CD_BIZAREA
		AND		DE.H_DEPT = DP.CD_DEPT
	   
    ORDER BY T.회사코드 ASC, T.직군코드 ASC, T.사업장코드 ASC, T.부서코드 ASC, T.사번 ASC
END 
-- 집계형태 : CC(사원) 
ELSE IF(@P_TP_SUM = '005') 
BEGIN 
    SELECT   T.회사코드 CD_COMPANY,
		(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,     
		 ISNULL(BI.CD_AREA, '') AS CD_AREA, 
        T.사업장코드     AS CD_BIZAREA,          
        (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA, 
		DP.NM_DEPT H_NM_DEPT,
        T.부서코드    AS CD_DEPT, 
        T.CC        AS CD_CC, 
        T.사원구분    AS TP_EMP, 
        (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_P000009' AND CD_SYSDEF = T.사원구분) NM_TP_EMP, 
        T.사번        AS NO_EMP, 
        T.직위코드    AS CD_DUTY_RANK, 
        T.직급코드    CD_DUTY_STEP, 
        BI.NM_BIZAREA     AS EMPINFO_01,     
        (SELECT    NM_CC FROM DZSN_MA_CC WHERE CD_COMPANY = T.회사코드 AND CD_CC = T.CC)     AS EMPINFO_02,         
        T.사번         AS EMPINFO_03,         
        E.NM_KOR     AS EMPINFO_04, E.NM_CHIN,  E.NM_ENG,
        (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000002' AND CD_SYSDEF = T.직위코드)  
                AS EMPINFO_05,     
        1         AS NO_CNT, 
		(SELECT  NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000003' AND CD_SYSDEF = T.직급코드) AS EMPINFO_07, 
		(SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직군코드 AND CD_FIELD = 'HR_H000004') NM_DUTY_TYPE,--직군명     
        T.호봉코드    AS EMPINFO_08, 
        DE.NM_DEPT AS EMPINFO_09,
        E.DT_ENTER, 
        E.DT_GENTER,
        E.DT_RETIRE, 
        E.NO_RES,
		E.DC_ADDRESS_RES1 + ISNULL(E.DC_ADDRESS_RES2,'') DC_ADDR,        
        T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
		T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
		T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
		T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
		
		T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
		T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
		T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
		T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
		 
		(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
		T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
		T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
		T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
		T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
		) AS TOTPAY, 
		
		T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
		T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
		T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
		T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
		
		T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
		T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
		T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
		T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
		
		( 
		T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
		T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
		T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
		T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
		T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
		 - AM_SIN
		) AS TOTDEDUCT, 
		
		(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
		T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
		T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
		T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
		T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
		( 
		T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
		T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
		T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
		T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
		T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
		 - AM_SIN
		) AS GPAY, 
        T.AM_TOTTAX, T.AM_TOTNOTAX, T.AM_NOTAX0, T.AM_NOTAX1, T.AM_NOTAX2, T.AM_NOTAX3, T.AM_NOTAX4,
        ISNULL((SELECT CONVERT(NUMERIC, CASE WHEN NO_ORDER = '' THEN 999999 ELSE NO_ORDER END) FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000002' AND CD_SYSDEF = T.직위코드), 999999) DUTY_RANK_ORDER,
        T.CD_LTAX_AREA, T.AM_NEMPA, T.AM_FIRE 
    FROM    ( 
        SELECT   회사코드, 사업장코드, 부서코드,
            CC, 
            직위코드, 직군코드, 직급코드,  
            사원구분, 
            사번,             
            호봉코드,            
            SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
            SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
            SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
            SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
            SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
            SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
            SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
            SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
            SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
            SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
            SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
            SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
            SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
            SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
            SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
            SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 

			SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
			SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
			SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
			SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
			SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
			SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
			SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
			SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
			SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
			SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
			SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
			SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
			SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
			SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
			SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
			SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,            
            
            ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2, 
            ISNULL(SUM(AM_NOTAX3), 0) AM_NOTAX3, ISNULL(SUM(AM_NOTAX4), 0) AM_NOTAX4,
            ISNULL(SUM(AM_SIN), 0) AM_SIN, CD_LTAX_AREA, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드, 부서코드 , CC, 직위코드, 직군코드, 직급코드, 사원구분, 사번, 호봉코드, CD_LTAX_AREA
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_EMP AS E 
    ON  T.회사코드 = E.CD_COMPANY AND  T.사번    = E.NO_EMP 
    LEFT OUTER JOIN (SELECT CD_COMPANY, CD_BIZAREA, NM_BIZAREA, ISNULL(CD_AREA, '') CD_AREA FROM DZSN_MA_BIZAREA) AS BI 
    ON    T.사업장코드    = BI.CD_BIZAREA 
    AND  T.회사코드  =  BI.CD_COMPANY     
    LEFT OUTER JOIN DZSN_MA_DEPT AS DE
    ON	T.회사코드 = DE.CD_COMPANY
    AND	T.사업장코드 = DE.CD_BIZAREA
    AND	T.부서코드 = DE.CD_DEPT	
	LEFT OUTER JOIN DZSN_MA_DEPT DP
	ON		DE.CD_COMPANY = DP.CD_COMPANY
	AND		DE.CD_BIZAREA = DP.CD_BIZAREA
	AND		DE.H_DEPT = DP.CD_DEPT
    ORDER BY T.회사코드 ASC, T.사업장코드 ASC, T.CC ASC, DE.CD_DEPT ASC, T.사번 ASC 
END 
-- 집계형태 : CC 
ELSE IF(@P_TP_SUM = '006') 
BEGIN 
    SELECT    T.회사코드 CD_COMPANY,
		(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,     
		ISNULL(BI.CD_AREA, '') CD_AREA, 
        T.사업장코드     AS CD_BIZAREA,          
        (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA, 
        --T.부서코드    AS CD_DEPT, 
        BI.NM_BIZAREA     AS EMPINFO_01,     
        T.CC         CD_CC, 
        CC.NM_CC     AS EMPINFO_02,         
        ISNULL((SELECT COUNT(DISTINCT 사번) FROM @P_DTEMP WHERE 사업장코드 = T.사업장코드 AND CC = T.CC), 0)  
                AS NO_CNT, 
        T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
		T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
		T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
		T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
		
		T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
		T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
		T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
		T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
		 
		(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
		T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
		T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
		T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
		T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
		) AS TOTPAY, 
		
		T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
		T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
		T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
		T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
		
		T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
		T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
		T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
		T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
		
		( 
		T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
		T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
		T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
		T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
		T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
		 - AM_SIN
		) AS TOTDEDUCT, 
		
		(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
		T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
		T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
		T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
		T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
		( 
		T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
		T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
		T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
		T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
		T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
		 - AM_SIN
		) AS GPAY, 
        T.AM_TOTTAX, T.AM_TOTNOTAX, T.AM_NOTAX0, T.AM_NOTAX1, T.AM_NOTAX2, T.AM_NOTAX3, T.AM_NOTAX4,
		T.AM_NEMPA, T.AM_FIRE 
    FROM    ( 
        SELECT   회사코드, 사업장코드, CC, 
            SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
            SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
            SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
            SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
            SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
            SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
            SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
            SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
            SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
            SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
            SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
            SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
            SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
            SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
            SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
            SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 
            
            SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
			SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
			SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
			SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
			SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
			SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
			SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
			SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
			SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
			SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
			SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
			SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
			SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
			SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
			SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
			SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
			
            ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
            ISNULL(SUM(AM_NOTAX3), 0) AM_NOTAX3, ISNULL(SUM(AM_NOTAX4), 0) AM_NOTAX4,
			ISNULL(SUM(AM_SIN), 0) AM_SIN,
			ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드, CC 
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
    ON  T.회사코드 = BI.CD_COMPANY AND  T.사업장코드    = BI.CD_BIZAREA 
    LEFT OUTER JOIN DZSN_MA_CC AS CC 
    ON    T.CC        = CC.CD_CC 
    AND  T.회사코드 = CC.CD_COMPANY   
    ORDER BY T.회사코드, T.사업장코드 ASC, T.CC ASC 
END 
-- 집계형태 : 직위(사원) 
ELSE IF(@P_TP_SUM = '007') 
BEGIN 
    SELECT  T.회사코드 CD_COMPANY,
			(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,      
			 ISNULL(BI.CD_AREA, '') AS CD_AREA, 
            T.사업장코드     AS CD_BIZAREA,          
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA, 
            T.부서코드    AS CD_DEPT, 
            T.직위코드 CD_DUTY_RANK, 
            T.사원구분    AS TP_EMP, 
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_P000009' AND CD_SYSDEF = T.사원구분) NM_TP_EMP, 
            T.사번        NO_EMP, 
            T.직급코드    CD_DUTY_STEP,  
            BI.NM_BIZAREA     AS EMPINFO_01,     
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000002' AND CD_SYSDEF = T.직위코드) EMPINFO_02, 
            T.사번         AS EMPINFO_03,         
            E.NM_KOR     AS EMPINFO_04, E.NM_CHIN,  E.NM_ENG,
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000003' AND CD_SYSDEF = T.직급코드) EMPINFO_05,
            1         AS NO_CNT, 
            (SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직군코드 AND CD_FIELD = 'HR_H000004') NM_DUTY_TYPE,--직군명 
            T.호봉코드    AS EMPINFO_08,
            E.DT_ENTER, 
            E.DT_GENTER,
            E.DT_RETIRE, 
            E.NO_RES, 
	 		E.DC_ADDRESS_RES1 + ISNULL(E.DC_ADDRESS_RES2,'') DC_ADDR,        
         
            T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
			T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
			T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
			T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
			
			T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
			T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
			T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
			T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
			 
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
			) AS TOTPAY, 
			
			T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
			T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
			T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
			T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
			
			T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
			T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
			T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
			T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
			
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS TOTDEDUCT, 
			
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS GPAY, 
            T.AM_TOTTAX, T.AM_TOTNOTAX, T.AM_NOTAX0, T.AM_NOTAX1, T.AM_NOTAX2,
            ISNULL((SELECT CONVERT(NUMERIC, CASE WHEN NO_ORDER = '' THEN 999999 ELSE NO_ORDER END) FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000002' AND CD_SYSDEF = T.직위코드), 999999) DUTY_RANK_ORDER,
            T.CD_LTAX_AREA, T.AM_NEMPA, T.AM_FIRE 
    FROM    ( 
        SELECT   회사코드, 사업장코드, 부서코드, 직위코드, 사원구분, 사번, 직급코드, 호봉코드, 직군코드,
                SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
                SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
                SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
                SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
                SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
                SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
                SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
                SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
                SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
                SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
                SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
                SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
                SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
                SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
                SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
                SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 
                
                SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
				SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
				SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
				SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
				SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
				SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
				SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
				SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
				SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
				SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
				SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
				SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
				SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
				SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
				SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
				SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
                
                ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
                ISNULL(SUM(AM_SIN), 0) AM_SIN, CD_LTAX_AREA, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드, 부서코드 , 직위코드, 사원구분, 사번, 직급코드, 호봉코드, 직군코드, CD_LTAX_AREA
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_EMP AS E 
    ON  T.회사코드 = E.CD_COMPANY AND  T.사번    = E.NO_EMP 
    LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
    ON    T.사업장코드    = BI.CD_BIZAREA 
    AND  T.회사코드 =  BI.CD_COMPANY      
    ORDER BY T.회사코드,T.사업장코드 ASC,  T.직위코드 ASC, T.사번 ASC 
END 
-- 집계형태 : 직위 
ELSE IF(@P_TP_SUM = '008') 
BEGIN 
    SELECT   T.회사코드 CD_COMPANY,
		(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,     
			 ISNULL(BI.CD_AREA, '') CD_AREA, 
            T.사업장코드     CD_BIZAREA,          
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) NM_AREA, 
            T.부서코드    AS CD_DEPT, 
            T.직위코드    CD_DUTY_RANK,                         
 
            BI.NM_BIZAREA     AS EMPINFO_01,     
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000002' AND CD_SYSDEF = T.직위코드) EMPINFO_02,             
            ISNULL((SELECT COUNT(DISTINCT 사번) FROM @P_DTEMP WHERE 사업장코드 = T.사업장코드 AND 부서코드 = T.부서코드 AND 직위코드 = T.직위코드), 0) NO_CNT, 
            T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
			T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
			T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
			T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
			
			T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
			T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
			T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
			T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
			 
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
			) AS TOTPAY, 
			
			T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
			T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
			T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
			T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
			
			T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
			T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
			T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
			T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
			
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS TOTDEDUCT, 
			
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS GPAY, 
            AM_TOTTAX, AM_TOTNOTAX, AM_NOTAX0, AM_NOTAX1, AM_NOTAX2,
            ISNULL((SELECT CONVERT(NUMERIC, CASE WHEN NO_ORDER = '' THEN 999999 ELSE NO_ORDER END) FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000002' AND CD_SYSDEF = T.직위코드), 999999) DUTY_RANK_ORDER,
			T.AM_NEMPA, T.AM_FIRE      
    FROM    ( 
        SELECT   회사코드, 사업장코드, 부서코드, 직위코드, 
                SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
                SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
                SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
                SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
                SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
                SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
                SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
                SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
                SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
                SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
                SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
                SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
                SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
                SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
                SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
                SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 
                
                SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
				SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
				SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
				SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
				SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
				SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
				SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
				SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
				SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
				SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
				SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
				SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
				SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
				SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
				SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
				SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
                
                ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
                ISNULL(SUM(AM_SIN), 0) AM_SIN, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드, 부서코드 , 직위코드 
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_BIZAREA BI 
    ON  T.회사코드 = BI.CD_COMPANY AND  T.사업장코드 = BI.CD_BIZAREA     
    --ORDER BY BI.CD_AREA ASC, T.CD_BIZAREA ASC, T.CD_DUTY_RANK ASC 
END 
-- 집계형태 : C/C그룹 
ELSE IF(@P_TP_SUM = '012') 
BEGIN 
   SELECT    ISNULL(B.CD_CCGRP,'') CD_CCGRP,  ISNULL(B.NM_CCGRP,'') EMPINFO_01,    
		ISNULL((SELECT COUNT(DISTINCT 사번) FROM @P_DTEMP WHERE CC = ISNULL(T.CC, '')), 0)  AS NO_CNT, 
        --SUM(NO_CNT) NO_CNT,
        SUM(T.PAY_01) PAY_01, SUM(T.PAY_02) PAY_02, SUM(T.PAY_03) PAY_03, SUM(T.PAY_04) PAY_04, SUM(T.PAY_05) PAY_05, 
        SUM(T.PAY_06) PAY_06, SUM(T.PAY_07) PAY_07, SUM(T.PAY_08) PAY_08, SUM(T.PAY_09) PAY_09, SUM(T.PAY_10) PAY_10, 
        SUM(T.PAY_11) PAY_11, SUM(T.PAY_12) PAY_12, SUM(T.PAY_13) PAY_13, SUM(T.PAY_14) PAY_14, SUM(T.PAY_15) PAY_15, 
        SUM(T.PAY_16) PAY_16, SUM(T.PAY_17) PAY_17, SUM(T.PAY_18) PAY_18, SUM(T.PAY_19) PAY_19, SUM(T.PAY_20) PAY_20, 
        SUM(T.PAY_21) PAY_21, SUM(T.PAY_22) PAY_22, SUM(T.PAY_23) PAY_23, SUM(T.PAY_24) PAY_24, SUM(T.PAY_25) PAY_25, 
        SUM(T.PAY_26) PAY_26, SUM(T.PAY_27) PAY_27, SUM(T.PAY_28) PAY_28, SUM(T.PAY_29) PAY_29, SUM(T.PAY_30) PAY_30, 
        SUM(T.PAY_31) PAY_31, SUM(T.PAY_32) PAY_32, SUM(T.PAY_33) PAY_33, SUM(T.PAY_34) PAY_34, SUM(T.PAY_35) PAY_35, 
		SUM(T.PAY_36) PAY_36, SUM(T.PAY_37) PAY_37, SUM(T.PAY_38) PAY_38, SUM(T.PAY_39) PAY_39, SUM(T.PAY_40) PAY_40, 
				
		SUM(T.PAY_41) PAY_41, SUM(T.PAY_42) PAY_42, SUM(T.PAY_43) PAY_43, SUM(T.PAY_44) PAY_44, SUM(T.PAY_45) PAY_45, 
        SUM(T.PAY_46) PAY_46, SUM(T.PAY_47) PAY_47, SUM(T.PAY_48) PAY_48, SUM(T.PAY_49) PAY_49, SUM(T.PAY_54) PAY_50, 
        SUM(T.PAY_51) PAY_51, SUM(T.PAY_52) PAY_52, SUM(T.PAY_53) PAY_53, SUM(T.PAY_54) PAY_54, SUM(T.PAY_55) PAY_55, 
        SUM(T.PAY_56) PAY_56, SUM(T.PAY_57) PAY_57, SUM(T.PAY_58) PAY_58, SUM(T.PAY_59) PAY_59, SUM(T.PAY_60) PAY_60, 
        SUM(T.PAY_61) PAY_61, SUM(T.PAY_62) PAY_62, SUM(T.PAY_63) PAY_63, SUM(T.PAY_64) PAY_64, SUM(T.PAY_65) PAY_65, 
        SUM(T.PAY_66) PAY_66, SUM(T.PAY_67) PAY_67, SUM(T.PAY_68) PAY_68, SUM(T.PAY_69) PAY_69, SUM(T.PAY_70) PAY_70, 
        SUM(T.PAY_71) PAY_71, SUM(T.PAY_72) PAY_72, SUM(T.PAY_73) PAY_73, SUM(T.PAY_74) PAY_74, SUM(T.PAY_75) PAY_75, 
		SUM(T.PAY_76) PAY_76, SUM(T.PAY_77) PAY_77, SUM(T.PAY_78) PAY_78, SUM(T.PAY_79) PAY_79, SUM(T.PAY_80) PAY_80, 		
		
        SUM(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
        T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
        T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
        T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
        T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80 ) AS TOTPAY, 
        
        SUM(T.DEDU_01) DEDU_01, SUM(T.DEDU_02) DEDU_02, SUM(T.DEDU_03) DEDU_03, SUM(T.DEDU_04) DEDU_04, SUM(T.DEDU_05) DEDU_05,  
        SUM(T.DEDU_11) DEDU_11, SUM(T.DEDU_12) DEDU_12, SUM(T.DEDU_13) DEDU_13, SUM(T.DEDU_14) DEDU_14, SUM(T.DEDU_15) DEDU_15,  
        SUM(T.DEDU_21) DEDU_21, SUM(T.DEDU_22) DEDU_22, SUM(T.DEDU_23) DEDU_23, SUM(T.DEDU_24) DEDU_24, SUM(T.DEDU_25) DEDU_25,  
        SUM(T.DEDU_31) DEDU_31, SUM(T.DEDU_32) DEDU_32, SUM(T.DEDU_33) DEDU_33, SUM(T.DEDU_34) DEDU_34, SUM(T.DEDU_35) DEDU_35, 
		SUM(T.DEDU_06) DEDU_06, SUM(T.DEDU_07) DEDU_07, SUM(T.DEDU_08) DEDU_08, SUM(T.DEDU_09) DEDU_09, SUM(T.DEDU_10) DEDU_10,
		SUM(T.DEDU_16) DEDU_16, SUM(T.DEDU_17) DEDU_17, SUM(T.DEDU_18) DEDU_18, SUM(T.DEDU_19) DEDU_19, SUM(T.DEDU_20) DEDU_20,
		SUM(T.DEDU_26) DEDU_26, SUM(T.DEDU_27) DEDU_27, SUM(T.DEDU_28) DEDU_28, SUM(T.DEDU_29) DEDU_29, SUM(T.DEDU_30) DEDU_30,
		SUM(T.DEDU_36) DEDU_36, SUM(T.DEDU_37) DEDU_37, SUM(T.DEDU_38) DEDU_38, SUM(T.DEDU_39) DEDU_39, SUM(T.DEDU_40) DEDU_40,         
		
		SUM(T.DEDU_41) DEDU_41, SUM(T.DEDU_42) DEDU_42, SUM(T.DEDU_43) DEDU_43, SUM(T.DEDU_44) DEDU_44, SUM(T.DEDU_45) DEDU_45, 
        SUM(T.DEDU_46) DEDU_46, SUM(T.DEDU_47) DEDU_47, SUM(T.DEDU_48) DEDU_48, SUM(T.DEDU_49) DEDU_49, SUM(T.DEDU_54) DEDU_50, 
        SUM(T.DEDU_51) DEDU_51, SUM(T.DEDU_52) DEDU_52, SUM(T.DEDU_53) DEDU_53, SUM(T.DEDU_54) DEDU_54, SUM(T.DEDU_55) DEDU_55, 
        SUM(T.DEDU_56) DEDU_56, SUM(T.DEDU_57) DEDU_57, SUM(T.DEDU_58) DEDU_58, SUM(T.DEDU_59) DEDU_59, SUM(T.DEDU_60) DEDU_60, 
        SUM(T.DEDU_61) DEDU_61, SUM(T.DEDU_62) DEDU_62, SUM(T.DEDU_63) DEDU_63, SUM(T.DEDU_64) DEDU_64, SUM(T.DEDU_65) DEDU_65, 
        SUM(T.DEDU_66) DEDU_66, SUM(T.DEDU_67) DEDU_67, SUM(T.DEDU_68) DEDU_68, SUM(T.DEDU_69) DEDU_69, SUM(T.DEDU_70) DEDU_70, 
        SUM(T.DEDU_71) DEDU_71, SUM(T.DEDU_72) DEDU_72, SUM(T.DEDU_73) DEDU_73, SUM(T.DEDU_74) DEDU_74, SUM(T.DEDU_75) DEDU_75, 
		SUM(T.DEDU_76) DEDU_76, SUM(T.DEDU_77) DEDU_77, SUM(T.DEDU_78) DEDU_78, SUM(T.DEDU_79) DEDU_79, SUM(T.DEDU_80) DEDU_80, 		
		
        SUM( 
        T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
        T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
        T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
        T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
        T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80 - AM_SIN
        ) AS TOTDEDUCT, 
        SUM(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
        T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
        T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
        T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
        T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
        SUM( 
        T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
        T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
        T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
        T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
        T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80 - AM_SIN
        ) AS GPAY, 
        SUM(AM_TOTTAX) AM_TOTTAX, SUM(AM_TOTNOTAX) AM_TOTNOTAX, SUM(AM_NOTAX0) AM_NOTAX0, SUM(AM_NOTAX1) AM_NOTAX1, SUM(AM_NOTAX2) AM_NOTAX2,
        SUM(AM_NEMPA) AM_NEMPA, SUM(AM_FIRE) AM_FIRE      
    FROM    ( 
        SELECT    ISNULL(A.CC, '') CC,
            --ISNULL((SELECT COUNT(DISTINCT C.사번) FROM @P_DTEMP C WHERE C.CC = ISNULL(A.CC, '')), 0)  AS NO_CNT, 
            SUM(ISNULL(A.PAY_01, 0)) PAY_01, SUM(ISNULL(A.PAY_02, 0)) PAY_02, SUM(ISNULL(A.PAY_03, 0)) PAY_03, SUM(ISNULL(A.PAY_04, 0)) PAY_04, SUM(ISNULL(A.PAY_05, 0)) PAY_05, 
            SUM(ISNULL(A.PAY_06, 0)) PAY_06, SUM(ISNULL(A.PAY_07, 0)) PAY_07, SUM(ISNULL(A.PAY_08, 0)) PAY_08, SUM(ISNULL(A.PAY_09, 0)) PAY_09, SUM(ISNULL(A.PAY_10, 0)) PAY_10, 
            SUM(ISNULL(A.PAY_11, 0)) PAY_11, SUM(ISNULL(A.PAY_12, 0)) PAY_12, SUM(ISNULL(A.PAY_13, 0)) PAY_13, SUM(ISNULL(A.PAY_14, 0)) PAY_14, SUM(ISNULL(A.PAY_15, 0)) PAY_15, 
            SUM(ISNULL(A.PAY_16, 0)) PAY_16, SUM(ISNULL(A.PAY_17, 0)) PAY_17, SUM(ISNULL(A.PAY_18, 0)) PAY_18, SUM(ISNULL(A.PAY_19, 0)) PAY_19, SUM(ISNULL(A.PAY_20, 0)) PAY_20, 
            SUM(ISNULL(A.PAY_21, 0)) PAY_21, SUM(ISNULL(A.PAY_22, 0)) PAY_22, SUM(ISNULL(A.PAY_23, 0)) PAY_23, SUM(ISNULL(A.PAY_24, 0)) PAY_24, SUM(ISNULL(A.PAY_25, 0)) PAY_25, 
            SUM(ISNULL(A.PAY_26, 0)) PAY_26, SUM(ISNULL(A.PAY_27, 0)) PAY_27, SUM(ISNULL(A.PAY_28, 0)) PAY_28, SUM(ISNULL(A.PAY_29, 0)) PAY_29, SUM(ISNULL(A.PAY_30, 0)) PAY_30, 
            SUM(ISNULL(A.PAY_31, 0)) PAY_31, SUM(ISNULL(A.PAY_32, 0)) PAY_32, SUM(ISNULL(A.PAY_33, 0)) PAY_33, SUM(ISNULL(A.PAY_34, 0)) PAY_34, SUM(ISNULL(A.PAY_35, 0)) PAY_35, 
            SUM(ISNULL(A.PAY_36, 0)) PAY_36, SUM(ISNULL(A.PAY_37, 0)) PAY_37, SUM(ISNULL(A.PAY_38, 0)) PAY_38, SUM(ISNULL(A.PAY_39, 0)) PAY_39, SUM(ISNULL(A.PAY_40, 0)) PAY_40, 
            SUM(ISNULL(A.DEDU_01, 0)) DEDU_01, SUM(ISNULL(A.DEDU_02, 0)) DEDU_02, SUM(ISNULL(A.DEDU_03, 0)) DEDU_03, SUM(ISNULL(A.DEDU_04, 0)) DEDU_04, SUM(ISNULL(A.DEDU_05, 0)) DEDU_05, 
            SUM(ISNULL(A.DEDU_06, 0)) DEDU_06, SUM(ISNULL(A.DEDU_07, 0)) DEDU_07, SUM(ISNULL(A.DEDU_08, 0)) DEDU_08, SUM(ISNULL(A.DEDU_09, 0)) DEDU_09, SUM(ISNULL(A.DEDU_10, 0)) DEDU_10, 
            SUM(ISNULL(A.DEDU_11, 0)) DEDU_11, SUM(ISNULL(A.DEDU_12, 0)) DEDU_12, SUM(ISNULL(A.DEDU_13, 0)) DEDU_13, SUM(ISNULL(A.DEDU_14, 0)) DEDU_14, SUM(ISNULL(A.DEDU_15, 0)) DEDU_15, 
            SUM(ISNULL(A.DEDU_16, 0)) DEDU_16, SUM(ISNULL(A.DEDU_17, 0)) DEDU_17, SUM(ISNULL(A.DEDU_18, 0)) DEDU_18, SUM(ISNULL(A.DEDU_19, 0)) DEDU_19, SUM(ISNULL(A.DEDU_20, 0)) DEDU_20, 
            SUM(ISNULL(A.DEDU_21, 0)) DEDU_21, SUM(ISNULL(A.DEDU_22, 0)) DEDU_22, SUM(ISNULL(A.DEDU_23, 0)) DEDU_23, SUM(ISNULL(A.DEDU_24, 0)) DEDU_24, SUM(ISNULL(A.DEDU_25, 0)) DEDU_25, 
            SUM(ISNULL(A.DEDU_26, 0)) DEDU_26, SUM(ISNULL(A.DEDU_27, 0)) DEDU_27, SUM(ISNULL(A.DEDU_28, 0)) DEDU_28, SUM(ISNULL(A.DEDU_29, 0)) DEDU_29, SUM(ISNULL(A.DEDU_30, 0)) DEDU_30, 
            SUM(ISNULL(A.DEDU_31, 0)) DEDU_31, SUM(ISNULL(A.DEDU_32, 0)) DEDU_32, SUM(ISNULL(A.DEDU_33, 0)) DEDU_33, SUM(ISNULL(A.DEDU_34, 0)) DEDU_34, SUM(ISNULL(A.DEDU_35, 0)) DEDU_35, 
            SUM(ISNULL(A.DEDU_36, 0)) DEDU_36, SUM(ISNULL(A.DEDU_37, 0)) DEDU_37, SUM(ISNULL(A.DEDU_38, 0)) DEDU_38, SUM(ISNULL(A.DEDU_39, 0)) DEDU_39, SUM(ISNULL(A.DEDU_40, 0)) DEDU_40, 
            
            SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
			SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
			SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
			SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
			SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
			SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
			SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
			SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
			SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
			SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
			SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
			SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
			SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
			SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
			SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
			SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
            
            ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
            ISNULL(SUM(AM_SIN), 0) AM_SIN, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP  A
        GROUP BY ISNULL(A.CC, '') 
        ) AS T LEFT OUTER JOIN @P_TEMP_CCGRP B ON T.CC = B.CD_CC
   GROUP BY T.CC, ISNULL(B.CD_CCGRP,''),  ISNULL(B.NM_CCGRP,'')

END
-- 집계형태 : C/C그룹사원
ELSE IF(@P_TP_SUM = '013') 
BEGIN 
      SELECT    ISNULL(B.CD_CCGRP,'') CD_CCGRP,  ISNULL(B.NM_CCGRP,'') EMPINFO_01, 
            T.직위코드 CD_DUTY_RANK, 
            T.사원구분    AS TP_EMP, 
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = @P_CD_COMPANY_L AND CD_FIELD = 'HR_P000009' AND CD_SYSDEF = T.사원구분) NM_TP_EMP, 
            T.사번        NO_EMP, 
            T.부서코드    AS CD_DEPT, 
            T.직급코드    CD_DUTY_STEP,      
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = @P_CD_COMPANY_L AND CD_FIELD = 'HR_H000002' AND CD_SYSDEF = T.직위코드) EMPINFO_05, 
            T.사번         AS EMPINFO_03,         
            E.NM_KOR     AS EMPINFO_04, E.NM_CHIN,  E.NM_ENG,
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = @P_CD_COMPANY_L AND CD_FIELD = 'HR_H000003' AND CD_SYSDEF = T.직급코드) EMPINFO_07,                 
            1         AS NO_CNT, 
            (SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직군코드 AND CD_FIELD = 'HR_H000004') NM_DUTY_TYPE,--직군명 
            T.호봉코드    AS EMPINFO_08,
            E.DT_ENTER, 
            E.DT_GENTER,
            E.DT_RETIRE, 
            E.NO_RES, 
			E.DC_ADDRESS_RES1 + ISNULL(E.DC_ADDRESS_RES2,'') DC_ADDR,        
            T.CC CD_CC,
            ( SELECT NM_CC FROM DZSN_MA_CC WHERE CD_CC = T.CC AND CD_COMPANY    = @P_CD_COMPANY_L ) EMPINFO_02,
            T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
			T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
			T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
			T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
			
			T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
			T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
			T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
			T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
			 
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
			) AS TOTPAY, 
			
			T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
			T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
			T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
			T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
			
			T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
			T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
			T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
			T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
			
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS TOTDEDUCT, 
			
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS GPAY,
            T.AM_TOTTAX, T.AM_TOTNOTAX, T.AM_NOTAX0, T.AM_NOTAX1, T.AM_NOTAX2,
            T.사업장코드,
            (SELECT NM_BIZAREA FROM DZSN_MA_BIZAREA WHERE CD_COMPANY = @P_CD_COMPANY_L AND CD_BIZAREA = T.사업장코드 ) EMPINFO_09,  -- 추가 사업장
            T.부서코드,
            (SELECT NM_DEPT FROM DZSN_MA_DEPT WHERE CD_COMPANY = @P_CD_COMPANY_L AND CD_DEPT = T.부서코드 ) EMPINFO_10,  -- 추가 부서
            T.CD_LTAX_AREA, T.AM_NEMPA, T.AM_FIRE 
    FROM    ( 
        SELECT  회사코드, 사업장코드, 부서코드, 직위코드, 사원구분, 사번, 직급코드, 호봉코드, CC, 직군코드,
                SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
                SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
                SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
                SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
                SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
                SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
                SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
                SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
                SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
                SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
                SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
                SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
                SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
                SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
                SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
                SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 

				SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
				SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
				SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
				SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
				SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
				SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
				SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
				SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
				SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
				SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
				SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
				SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
				SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
				SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
				SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
				SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,                
                
                ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
                ISNULL(SUM(AM_SIN), 0) AM_SIN, CD_LTAX_AREA, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드, 부서코드 , 직위코드, 사원구분, 사번, 직급코드, 호봉코드, CC, 직군코드, CD_LTAX_AREA
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_EMP AS E 
    ON    T.사번    = E.NO_EMP AND E.CD_COMPANY    = @P_CD_COMPANY_L 
    LEFT OUTER JOIN @P_TEMP_CCGRP B ON T.CC = B.CD_CC    
   
END
-- 집계형태 : 직급 
ELSE IF(@P_TP_SUM = '014') 
BEGIN 
    SELECT     T.회사코드 CD_COMPANY,
		(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,   
		 ISNULL(BI.CD_AREA, '') CD_AREA, 
        T.사업장코드     AS CD_BIZAREA,          
        ISNULL((SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA), '') AS NM_AREA, 
		DP.NM_DEPT H_NM_DEPT, 
        T.부서코드    AS CD_DEPT, 
        T.사번        AS NO_EMP, 
        E.NM_KOR,         
        T.직급코드    AS CD_DUTY_STEP, 
        (SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직군코드 AND CD_FIELD = 'HR_H000003') NM_DUTY_STEP,--직급명 
        T.사원구분    AS TP_EMP, 
        (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_P000009' AND CD_SYSDEF = T.사원구분) NM_TP_EMP, 
        BI.NM_BIZAREA     AS EMPINFO_01,     
        DE.NM_DEPT     AS EMPINFO_02,         
        T.사번         AS EMPINFO_03,         
        E.NM_KOR     AS EMPINFO_04,    E.NM_CHIN,  E.NM_ENG,
        E.DT_ENTER    AS EMPINFO_05,     
        CASE WHEN E.DT_RETIRE IS NULL OR E.DT_RETIRE = '' OR E.DT_RETIRE = '99999999' OR E.DT_RETIRE = '00000000' THEN '' ELSE E.DT_RETIRE END  
 
                AS EMPINFO_06, 
        (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000003' AND CD_SYSDEF = T.직급코드) 
                AS EMPINFO_07, 
        T.호봉코드    AS EMPINFO_08, 
        ISNULL((SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000004' AND CD_SYSDEF = T.직군코드), '')  
                AS EMPINFO_09,     
        1         AS NO_CNT, 
		E.DT_GENTER,
        T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
		T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
		T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
		T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
		
		T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
		T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
		T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
		T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
		 
		(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
		T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
		T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
		T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
		T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
		) AS TOTPAY, 
		
		T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
		T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
		T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
		T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
		
		T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
		T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
		T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
		T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
		
		( 
		T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
		T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
		T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
		T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
		T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
		 - AM_SIN
		) AS TOTDEDUCT, 
		
		(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
		T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
		T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
		T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
		T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
		( 
		T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
		T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
		T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
		T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
		T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
		 - AM_SIN
		) AS GPAY,
        AM_TOTTAX, AM_TOTNOTAX, AM_NOTAX0, AM_NOTAX1, AM_NOTAX2 , T.CD_LTAX_AREA,
		T.AM_NEMPA, T.AM_FIRE 
    FROM    ( 
        SELECT   회사코드, 사업장코드, 
            부서코드, 
            직위코드, 
            직군코드, 
            직급코드, 
            호봉코드, 
            사원구분, 
            사번, 
            SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
            SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
            SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
            SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
            SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
            SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
            SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
            SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
            SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
            SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
            SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
            SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
            SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
            SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
            SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
            SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 
            
            SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
			SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
			SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
			SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
			SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
			SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
			SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
			SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
			SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
			SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
			SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
			SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
			SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
			SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
			SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
			SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
            
            ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX,ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
            ISNULL(SUM(AM_SIN), 0) AM_SIN, CD_LTAX_AREA,
			ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드, 부서코드, 직위코드, 직군코드, 직급코드, 호봉코드, 사원구분, 사번 , CD_LTAX_AREA
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_EMP AS E 
    ON  T.회사코드 = E.CD_COMPANY AND  T.사번    = E.NO_EMP 
    LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
    ON  T.회사코드 = BI.CD_COMPANY AND  T.사업장코드    = BI.CD_BIZAREA 
    LEFT OUTER JOIN DZSN_MA_DEPT AS DE 
    ON  T.회사코드 = DE.CD_COMPANY AND  T.부서코드    = DE.CD_DEPT     		
	LEFT OUTER JOIN DZSN_MA_DEPT DP
	ON		DE.CD_COMPANY = DP.CD_COMPANY
	AND		DE.CD_BIZAREA = DP.CD_BIZAREA
	AND		DE.H_DEPT = DP.CD_DEPT
    ORDER BY T.회사코드 ASC, T.직급코드 ASC, T.사업장코드 ASC, T.부서코드 ASC, T.사번 ASC 
END
-- 집계형태 : 프로젝트별 
ELSE IF(@P_TP_SUM = '015') 
BEGIN 
    SELECT    T.회사코드 CD_COMPANY,
		(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,  
		 ISNULL(BI.CD_AREA, '') CD_AREA, 
        T.사업장코드     AS CD_BIZAREA,          
        (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA, 
        T.프로젝트코드    AS CD_PJT, 
        BI.NM_BIZAREA     AS EMPINFO_01,     
        SA.NM_PROJECT     AS EMPINFO_02,         
        ISNULL((SELECT COUNT(DISTINCT 사번) FROM @P_DTEMP WHERE 사업장코드 = T.사업장코드 AND 프로젝트코드 = T.프로젝트코드), 0)  
                AS NO_CNT, 
        T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
		T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
		T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
		T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
		
		T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
		T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
		T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
		T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
		 
		(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
		T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
		T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
		T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
		T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
		) AS TOTPAY, 
		
		T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
		T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
		T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
		T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
		
		T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
		T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
		T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
		T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
		
		( 
		T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
		T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
		T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
		T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
		T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
		 - AM_SIN
		) AS TOTDEDUCT, 
		
		(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
		T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
		T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
		T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
		T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
		T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
		T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
		T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
		( 
		T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
		T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
		T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
		T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
		T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
		T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
		T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
		T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
		 - AM_SIN
		) AS GPAY,
        AM_TOTTAX, AM_TOTNOTAX, AM_NOTAX0, AM_NOTAX1, AM_NOTAX2, 
		T.AM_NEMPA, T.AM_FIRE 
    FROM    ( 
        SELECT   회사코드, 사업장코드, 프로젝트코드, 
            SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
            SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
            SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
            SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
            SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
            SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
            SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
            SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
            SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
            SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
            SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
            SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
            SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
            SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
            SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
            SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40,             
            
            SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
			SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
			SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
			SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
			SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
			SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
			SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
			SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
			SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
			SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
			SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
			SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
			SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
			SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
			SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
			SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
            
            ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
            ISNULL(SUM(AM_SIN), 0) AM_SIN, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP 
        GROUP BY 회사코드,  사업장코드, 프로젝트코드 
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
    ON   T.회사코드 = BI.CD_COMPANY AND T.사업장코드    = BI.CD_BIZAREA 
    LEFT OUTER JOIN DZSN_SA_PROJECTH AS SA 
    ON  T.회사코드 = SA.CD_COMPANY AND  T.프로젝트코드    = SA.NO_PROJECT  
    ORDER BY T.회사코드 ASC, T.사업장코드 ASC, T.프로젝트코드 ASC 
END 
-- 집계형태 : 부서레벨별 
ELSE IF(@P_TP_SUM = '017') 
BEGIN

--○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○ 
--○	DATE : 2011.12.01
--○	PAGE : 월별급여지급현황
--○	DESC : 조선호텔베이커리 전용 집계 작업으로 부서레벨 하위 부서 집계입니다.
--○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○

    
	--해당 레벨 부서 목록 가져오기(DISTINCT)
	SET @V_HDEPT_CUR = CURSOR FOR
	SELECT DISTINCT CD_DEPT 
	FROM MA_DEPT
	WHERE CD_COMPANY = @P_CD_COMPANY_L
	AND LB_DEPT = @P_LB_DEPT
	
	--임시테이블 입력
	INSERT INTO @P_DEPT_TEMP
	(회사코드, 사업장코드, 부서코드, 하위부서)
	SELECT DISTINCT CD_COMPANY, CD_BIZAREA, CD_DEPT, CD_DEPT + '|' 
	FROM MA_DEPT
	WHERE CD_COMPANY = @P_CD_COMPANY_L
	AND LB_DEPT = @P_LB_DEPT	

	OPEN @V_HDEPT_CUR
	FETCH NEXT FROM @V_HDEPT_CUR INTO @V_HDEPT_CODE
	WHILE (@@FETCH_STATUS = 0)
	BEGIN
	
		SET @V_COUNT = 1
		
		WHILE(1=1)
		BEGIN
			--해당 레벨 부서 목록 가져오기(DISTINCT)
			IF @V_COUNT = 1
			BEGIN
				SET @V_DEPT_CUR = CURSOR FOR
				SELECT DISTINCT CD_DEPT 
				FROM MA_DEPT
				WHERE CD_COMPANY = @P_CD_COMPANY_L
				AND H_DEPT = @V_HDEPT_CODE		
				AND H_DEPT <> CD_DEPT			
				
				OPEN @V_DEPT_CUR
				FETCH NEXT FROM @V_DEPT_CUR INTO @V_DEPT_CODE
				WHILE (@@FETCH_STATUS = 0)
				BEGIN
				
					UPDATE @P_DEPT_TEMP
					SET 하위부서 = 하위부서 + @V_DEPT_CODE + '|' 
					WHERE 부서코드 = @V_HDEPT_CODE
				
					SET @V_DEPT_CHG = @V_DEPT_CHG + @V_DEPT_CODE + '|' 
				
					
				FETCH NEXT FROM @V_DEPT_CUR INTO @V_DEPT_CODE
				END
				
				CLOSE @V_DEPT_CUR
				DEALLOCATE @V_DEPT_CUR
			END	
			ELSE
			BEGIN		
				SET @V_DEPT_CUR = CURSOR FOR
				SELECT DISTINCT CD_DEPT 
				FROM MA_DEPT
				WHERE CD_COMPANY = @P_CD_COMPANY_L
				AND H_DEPT IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@V_DEPT_CHG))	
				AND H_DEPT <> CD_DEPT
				
				SET @V_DEPT_CHG = ''
				
				OPEN @V_DEPT_CUR
				FETCH NEXT FROM @V_DEPT_CUR INTO @V_DEPT_CODE
				WHILE (@@FETCH_STATUS = 0)
				BEGIN
				
					UPDATE @P_DEPT_TEMP
					SET 하위부서 = 하위부서 + @V_DEPT_CODE + '|' 
					WHERE 부서코드 = @V_HDEPT_CODE
				
					SET @V_DEPT_CHG = @V_DEPT_CHG + @V_DEPT_CODE + '|' 
				
					
				FETCH NEXT FROM @V_DEPT_CUR INTO @V_DEPT_CODE
				END
				
				CLOSE @V_DEPT_CUR
				DEALLOCATE @V_DEPT_CUR
			END					
			
			
			SET @V_COUNT = @V_COUNT + 1	
			
			IF(LEN(REPLACE(@V_DEPT_CHG,'|','')) = 0)
			BEGIN				
				BREAK;
			END

		END		

		IF @@ERROR <> 0
			RETURN			

	FETCH NEXT FROM @V_HDEPT_CUR INTO @V_HDEPT_CODE
	END

	CLOSE @V_HDEPT_CUR
	DEALLOCATE @V_HDEPT_CUR
	   
    
--○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○○    
    
	INSERT INTO @P_DTEMP_CHOSUNHOTEL
	(회사코드, 사업장코드, 부서코드, 하위부서)    
	SELECT 회사코드, 사업장코드, 부서코드, 하위부서
	FROM @P_DEPT_TEMP
	
	SET @V_UPDATE_CUR = CURSOR FOR
	SELECT 회사코드, 사업장코드, 부서코드, 하위부서
	FROM @P_DEPT_TEMP
	
	OPEN @V_UPDATE_CUR
	FETCH NEXT FROM @V_UPDATE_CUR INTO @V_CD_COMPANY_U, @V_CD_BZIAREA_U, @V_CD_DEPT_U, @V_H_DEPT_U
	WHILE (@@FETCH_STATUS = 0)
	BEGIN	
	
		UPDATE @P_DTEMP_CHOSUNHOTEL
		SET		NO_CNT = ISNULL((SELECT COUNT(DISTINCT 사번) FROM @P_DTEMP 
								 WHERE 사업장코드 = @V_CD_BZIAREA_U 
								AND 부서코드 IN(SELECT CD_STR FROM GETTABLEFROMSPLIT(@V_H_DEPT_U))), 0),
				PAY_01 = Y.PAY_01,				PAY_02 = Y.PAY_02,
				PAY_03 = Y.PAY_03,				PAY_04 = Y.PAY_04,
				PAY_05 = Y.PAY_05,				PAY_06 = Y.PAY_06,
				PAY_07 = Y.PAY_07,				PAY_08 = Y.PAY_08,
				PAY_09 = Y.PAY_09,				PAY_10 = Y.PAY_10,
				PAY_11 = Y.PAY_11,				PAY_12 = Y.PAY_12,
				PAY_13 = Y.PAY_13,				PAY_14 = Y.PAY_14,
				PAY_15 = Y.PAY_15,				PAY_16 = Y.PAY_16,
				PAY_17 = Y.PAY_17,				PAY_18 = Y.PAY_18,
				PAY_19 = Y.PAY_19,				PAY_20 = Y.PAY_20,
				PAY_21 = Y.PAY_21,				PAY_22 = Y.PAY_22,
				PAY_23 = Y.PAY_23,				PAY_24 = Y.PAY_24,
				PAY_25 = Y.PAY_25,				PAY_26 = Y.PAY_26,
				PAY_27 = Y.PAY_27,				PAY_28 = Y.PAY_28,
				PAY_29 = Y.PAY_29,				PAY_30 = Y.PAY_30,
				PAY_31 = Y.PAY_31,				PAY_32 = Y.PAY_32,
				PAY_33 = Y.PAY_33,				PAY_34 = Y.PAY_34,
				PAY_35 = Y.PAY_35,				PAY_36 = Y.PAY_36,
				PAY_37 = Y.PAY_37,				PAY_38 = Y.PAY_38,
				PAY_39 = Y.PAY_39,				PAY_40 = Y.PAY_40,
		
				DEDU_01 = Y.DEDU_01,			DEDU_02 = Y.DEDU_02,
				DEDU_03 = Y.DEDU_03,			DEDU_04 = Y.DEDU_04,
				DEDU_05 = Y.DEDU_05,			DEDU_06 = Y.DEDU_06,
				DEDU_07 = Y.DEDU_07,			DEDU_08 = Y.DEDU_08,
				DEDU_09 = Y.DEDU_09,			DEDU_10 = Y.DEDU_10,
				DEDU_11 = Y.DEDU_11,			DEDU_12 = Y.DEDU_12,
				DEDU_13 = Y.DEDU_13,			DEDU_14 = Y.DEDU_14,
				DEDU_15 = Y.DEDU_15,			DEDU_16 = Y.DEDU_16,
				DEDU_17 = Y.DEDU_17,			DEDU_18 = Y.DEDU_18,
				DEDU_19 = Y.DEDU_19,			DEDU_20 = Y.DEDU_20,
				DEDU_21 = Y.DEDU_21,			DEDU_22 = Y.DEDU_22,
				DEDU_23 = Y.DEDU_23,			DEDU_24 = Y.DEDU_24,
				DEDU_25 = Y.DEDU_25,			DEDU_26 = Y.DEDU_26,
				DEDU_27 = Y.DEDU_27,			DEDU_28 = Y.DEDU_28,
				DEDU_29 = Y.DEDU_29,			DEDU_30 = Y.DEDU_30,
				DEDU_31 = Y.DEDU_31,			DEDU_32 = Y.DEDU_32,
				DEDU_33 = Y.DEDU_33,			DEDU_34 = Y.DEDU_34,
				DEDU_35 = Y.DEDU_35,			DEDU_36 = Y.DEDU_36,
				DEDU_37 = Y.DEDU_37,			DEDU_38 = Y.DEDU_38,
				DEDU_39 = Y.DEDU_39,			DEDU_40 = Y.DEDU_40,
		        
				AM_TOTTAX   = Y.AM_TOTTAX, 		AM_TOTNOTAX	= Y.AM_TOTNOTAX,
				AM_NOTAX0	= Y.AM_NOTAX0,		AM_NOTAX1	= Y.AM_NOTAX1,
				AM_NOTAX2	= Y.AM_NOTAX2
		
		FROM   @P_DTEMP_CHOSUNHOTEL X
		LEFT OUTER JOIN (
							SELECT   회사코드, 사업장코드, @V_CD_DEPT_U 부서코드, 
									SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
									SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
									SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
									SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
									SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
									SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
									SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
									SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
									SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
									SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
									SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
									SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
									SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
									SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
									SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
									SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40,             
									ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2 
							FROM    @P_DTEMP 
							WHERE   회사코드 = @V_CD_COMPANY_U
							AND		사업장코드 = @V_CD_BZIAREA_U
							AND		부서코드 IN (SELECT CD_STR FROM GETTABLEFROMSPLIT(@V_H_DEPT_U)) 
							GROUP BY 회사코드,  사업장코드
		
						) Y ON Y.회사코드 = X.회사코드
								AND Y.사업장코드 = X.사업장코드
								AND Y.부서코드 = X.부서코드
										
		WHERE  X.회사코드 = @V_CD_COMPANY_U
		AND	   X.사업장코드 = @V_CD_BZIAREA_U
		AND	   X.부서코드 = @V_CD_DEPT_U
		

		IF @@ERROR <> 0
			RETURN		

	FETCH NEXT FROM @V_UPDATE_CUR INTO @V_CD_COMPANY_U, @V_CD_BZIAREA_U, @V_CD_DEPT_U, @V_H_DEPT_U
	END

	CLOSE @V_UPDATE_CUR
	DEALLOCATE @V_UPDATE_CUR	
	
    SELECT    T.회사코드 CD_COMPANY,
		(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,  
		 ISNULL(BI.CD_AREA, '') CD_AREA, 
        T.사업장코드     AS CD_BIZAREA,          
        (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA, 
        T.부서코드    AS CD_DEPT, 
        BI.NM_BIZAREA     AS EMPINFO_01,     
        DE.NM_DEPT     AS EMPINFO_02,         
        ISNULL((SELECT COUNT(DISTINCT 사번) FROM @P_DTEMP WHERE 사업장코드 = T.사업장코드 AND 부서코드 = T.부서코드), 0)  
                AS NO_CNT, 
        T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
        T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
        T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
        T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40, 
        (T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
        T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
        T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
        T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40) AS TOTPAY, 
        T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
        T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
        T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
        T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
        ( 
        T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
        T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
        T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
        T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40
        ) AS TOTDEDUCT, 
        (T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
        T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
        T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
        T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40) - 
        ( 
        T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
        T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
        T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
        T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40
        ) AS GPAY, 
        AM_TOTTAX, AM_TOTNOTAX, AM_NOTAX0, AM_NOTAX1, AM_NOTAX2 
     
    FROM  @P_DTEMP_CHOSUNHOTEL AS T 
    LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
    ON   T.회사코드 = BI.CD_COMPANY AND T.사업장코드    = BI.CD_BIZAREA 
    LEFT OUTER JOIN DZSN_MA_DEPT AS DE 
    ON  T.회사코드 = DE.CD_COMPANY AND  T.부서코드    = DE.CD_DEPT  
	ORDER BY T.회사코드 ASC, T.사업장코드 ASC, T.부서코드 ASC 
	
END
-- 집계형태 : 프로젝트(사원) 
ELSE IF(@P_TP_SUM = '018') 
BEGIN 
    SELECT  T.회사코드 CD_COMPANY,
			(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,      
			 ISNULL(BI.CD_AREA, '') AS CD_AREA, 
            T.사업장코드     AS CD_BIZAREA,          
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA, 
            T.부서코드    AS CD_DEPT, 
            T.직위코드 CD_DUTY_RANK, 
            T.사원구분    AS TP_EMP, 
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_P000009' AND CD_SYSDEF = T.사원구분) NM_TP_EMP, 
            T.사번        NO_EMP, 
            T.직급코드    CD_DUTY_STEP, 
            T.프로젝트코드 CD_PJT, 
            BI.NM_BIZAREA     AS EMPINFO_01,      
			SA.NM_PROJECT     AS EMPINFO_02,     
            T.사번         AS EMPINFO_03,         
            E.NM_KOR     AS EMPINFO_04, E.NM_CHIN,  E.NM_ENG,
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000003' AND CD_SYSDEF = T.직급코드) EMPINFO_05,                 
            1         AS NO_CNT, 
            (SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직군코드 AND CD_FIELD = 'HR_H000004') NM_DUTY_TYPE,--직군명 
            T.호봉코드    AS EMPINFO_08,
            E.DT_ENTER, 
            E.DT_GENTER,
            E.DT_RETIRE, 
            E.NO_RES, 
	 		E.DC_ADDRESS_RES1 + ISNULL(E.DC_ADDRESS_RES2,'') DC_ADDR,        
         
            T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
			T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
			T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
			T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
			
			T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
			T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
			T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
			T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
			 
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
			) AS TOTPAY, 
			
			T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
			T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
			T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
			T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
			
			T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
			T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
			T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
			T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
			
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS TOTDEDUCT, 
			
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS GPAY,
            T.AM_TOTTAX, T.AM_TOTNOTAX, T.AM_NOTAX0, T.AM_NOTAX1, T.AM_NOTAX2, T.CD_LTAX_AREA, T.AM_NEMPA, T.AM_FIRE 
    FROM    ( 
        SELECT   회사코드, 사업장코드, 부서코드, 직위코드, 사원구분, 사번, 직급코드, 호봉코드, 프로젝트코드, 직군코드,
                SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
                SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
                SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
                SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
                SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
                SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
                SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
                SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
                SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
                SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
                SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
                SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
                SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
                SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
                SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
                SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 
                
                SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
				SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
				SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
				SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
				SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
				SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
				SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
				SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
				SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
				SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
				SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
				SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
				SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
				SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
				SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
				SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
                
                ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
                ISNULL(SUM(AM_SIN), 0) AM_SIN, CD_LTAX_AREA, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드, 부서코드 , 직위코드, 사원구분, 사번, 직급코드, 호봉코드, 프로젝트코드, 직군코드, CD_LTAX_AREA
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_EMP AS E 
    ON  T.회사코드 = E.CD_COMPANY AND  T.사번    = E.NO_EMP 
    LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
    ON    T.사업장코드    = BI.CD_BIZAREA 
    AND  T.회사코드 =  BI.CD_COMPANY   
    LEFT OUTER JOIN DZSN_SA_PROJECTH AS SA 
    ON  T.회사코드 = SA.CD_COMPANY AND  T.프로젝트코드    = SA.NO_PROJECT    
    ORDER BY T.회사코드,T.사업장코드 ASC,  T.프로젝트코드 ASC, T.사번 ASC 
END
-- 집계형태 : 직무(사원) 
ELSE IF(@P_TP_SUM = '019') 
BEGIN 
    SELECT  T.회사코드 CD_COMPANY,
			(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,      
			 ISNULL(BI.CD_AREA, '') AS CD_AREA, 
            T.사업장코드     AS CD_BIZAREA,          
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA,
			DP.NM_DEPT H_NM_DEPT, 
            T.부서코드    AS CD_DEPT, 
            DE.NM_DEPT	AS EMPINFO_02,
            T.직위코드 CD_DUTY_RANK, 
            T.사원구분    AS TP_EMP, 
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_P000009' AND CD_SYSDEF = T.사원구분) NM_TP_EMP, 
            T.사번        NO_EMP, 
            T.직급코드    CD_DUTY_STEP, 
            T.프로젝트코드 CD_PJT, 
            E.CD_DUTY_WORK, 	        
            BI.NM_BIZAREA     AS EMPINFO_01,      
            (SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = E.CD_COMPANY AND CD_SYSDEF = E.CD_DUTY_WORK AND CD_FIELD = 'HR_H000039') EMPINFO_03,--직무명 			    
            T.사번         AS EMPINFO_04,         
            E.NM_KOR     AS EMPINFO_05, E.NM_CHIN,  E.NM_ENG,
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000003' AND CD_SYSDEF = T.직급코드) EMPINFO_06,                 
            1         AS NO_CNT, 
            (SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직군코드 AND CD_FIELD = 'HR_H000004') NM_DUTY_TYPE,--직군명 
            T.호봉코드    AS EMPINFO_08,
            E.DT_ENTER, 
            E.DT_GENTER,
            E.DT_RETIRE, 
            E.NO_RES,          
			E.DC_ADDRESS_RES1 + ISNULL(E.DC_ADDRESS_RES2,'') DC_ADDR,        
            T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
			T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
			T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
			T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
			
			T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
			T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
			T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
			T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
			 
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
			) AS TOTPAY, 
			
			T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
			T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
			T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
			T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
			
			T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
			T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
			T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
			T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
			
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS TOTDEDUCT, 
			
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS GPAY, 
            T.AM_TOTTAX, T.AM_TOTNOTAX, T.AM_NOTAX0, T.AM_NOTAX1, T.AM_NOTAX2, T.CD_LTAX_AREA, T.AM_NEMPA, T.AM_FIRE 
    FROM    ( 
        SELECT   회사코드, 사업장코드, 부서코드, 직위코드, 사원구분, 사번, 직급코드, 호봉코드, 프로젝트코드, 직군코드,
                SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
                SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
                SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
                SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
                SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
                SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
                SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
                SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
                SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
                SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
                SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
                SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
                SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
                SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
                SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
                SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 
                
                SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
				SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
				SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
				SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
				SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
				SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
				SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
				SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
				SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
				SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
				SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
				SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
				SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
				SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
				SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
				SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
                
                ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
                ISNULL(SUM(AM_SIN), 0) AM_SIN, CD_LTAX_AREA, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드, 부서코드 , 직위코드, 사원구분, 사번, 직급코드, 호봉코드, 프로젝트코드, 직군코드, CD_LTAX_AREA
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_EMP AS E 
    ON  T.회사코드 = E.CD_COMPANY AND  T.사번    = E.NO_EMP 
    LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
    ON    T.사업장코드    = BI.CD_BIZAREA 
    AND  T.회사코드 =  BI.CD_COMPANY   
    LEFT OUTER JOIN DZSN_MA_DEPT AS DE 
    ON  T.회사코드 = DE.CD_COMPANY AND  T.부서코드    = DE.CD_DEPT 		
	LEFT OUTER JOIN DZSN_MA_DEPT DP
	ON		DE.CD_COMPANY = DP.CD_COMPANY
	AND		DE.CD_BIZAREA = DP.CD_BIZAREA
	AND		DE.H_DEPT = DP.CD_DEPT        
    ORDER BY T.회사코드,T.사업장코드 ASC,  E.CD_DUTY_WORK ASC, T.사번 ASC 
END
-- 집계형태 : 사용자정의1 
ELSE IF(@P_TP_SUM = '020') 
BEGIN 
        SELECT   T.회사코드 CD_COMPANY,
		(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,     
			 ISNULL(BI.CD_AREA, '') CD_AREA, 
            T.사업장코드     CD_BIZAREA,          
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) NM_AREA, 
            --T.부서코드    AS CD_DEPT, 
            T.사용자정의1 CD_USER1,                         
 
            BI.NM_BIZAREA     AS EMPINFO_01,     
            (SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000087' AND CD_SYSDEF = T.사용자정의1) EMPINFO_02,             
            ISNULL((SELECT COUNT(DISTINCT 사번) FROM @P_DTEMP WHERE 사업장코드 = T.사업장코드 AND 사용자정의1 = T.사용자정의1), 0) NO_CNT, 
            T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
			T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
			T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
			T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
			
			T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
			T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
			T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
			T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
			 
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
			) AS TOTPAY, 
			
			T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
			T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
			T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
			T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
			
			T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
			T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
			T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
			T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
			
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS TOTDEDUCT, 
			
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS GPAY, 
            AM_TOTTAX, AM_TOTNOTAX, AM_NOTAX0, AM_NOTAX1, AM_NOTAX2, AM_NEMPA, AM_FIRE  
     
    FROM    ( 
        SELECT   회사코드, 사업장코드, 사용자정의1, 
                SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
                SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
                SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
                SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
                SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
                SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
                SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
                SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
                SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
                SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
                SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
                SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
                SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
                SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
                SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
                SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 
                
                SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
				SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
				SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
				SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
				SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
				SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
				SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
				SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
				SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
				SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
				SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
				SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
				SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
				SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
				SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
				SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
                
                ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
                ISNULL(SUM(AM_SIN), 0) AM_SIN, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드 , 사용자정의1 
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_BIZAREA BI 
    ON  T.회사코드 = BI.CD_COMPANY AND  T.사업장코드 = BI.CD_BIZAREA     
END
-- 집계형태 : 사용자정의2
ELSE IF(@P_TP_SUM = '021') 
BEGIN 
        SELECT   T.회사코드 CD_COMPANY,
		(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,     
			 ISNULL(BI.CD_AREA, '') CD_AREA, 
            T.사업장코드     CD_BIZAREA,          
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) NM_AREA, 
            --T.부서코드    AS CD_DEPT, 
            T.사용자정의2 CD_USER2,                         
 
            BI.NM_BIZAREA     AS EMPINFO_01,     
            (SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000088' AND CD_SYSDEF = T.사용자정의2) EMPINFO_02,             
            ISNULL((SELECT COUNT(DISTINCT 사번) FROM @P_DTEMP WHERE 사업장코드 = T.사업장코드 AND 사용자정의2 = T.사용자정의2), 0) NO_CNT, 
            T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
			T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
			T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
			T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
			
			T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
			T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
			T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
			T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
			 
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
			) AS TOTPAY, 
			
			T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
			T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
			T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
			T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
			
			T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
			T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
			T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
			T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
			
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS TOTDEDUCT, 
			
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS GPAY, 
            AM_TOTTAX, AM_TOTNOTAX, AM_NOTAX0, AM_NOTAX1, AM_NOTAX2, AM_NEMPA, AM_FIRE 
     
    FROM    ( 
        SELECT   회사코드, 사업장코드, 사용자정의2, 
                SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
                SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
                SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
                SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
                SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
                SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
                SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
                SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
                SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
                SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
                SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
                SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
                SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
                SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
                SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
                SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 
                
                SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
				SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
				SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
				SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
				SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
				SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
				SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
				SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
				SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
				SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
				SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
				SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
				SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
				SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
				SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
				SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
                
                ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
                ISNULL(SUM(AM_SIN), 0) AM_SIN, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드 , 사용자정의2 
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_BIZAREA BI 
    ON  T.회사코드 = BI.CD_COMPANY AND  T.사업장코드 = BI.CD_BIZAREA     
END
-- 집계형태 : 사용자정의3
ELSE IF(@P_TP_SUM = '022') 
BEGIN 
        SELECT   T.회사코드 CD_COMPANY,
		(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,     
			 ISNULL(BI.CD_AREA, '') CD_AREA, 
            T.사업장코드     CD_BIZAREA,          
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) NM_AREA, 
            --T.부서코드    AS CD_DEPT, 
            T.사용자정의3 CD_USER3,                         
 
            BI.NM_BIZAREA     AS EMPINFO_01,     
            (SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000089' AND CD_SYSDEF = T.사용자정의3) EMPINFO_02,             
            ISNULL((SELECT COUNT(DISTINCT 사번) FROM @P_DTEMP WHERE 사업장코드 = T.사업장코드 AND 사용자정의3 = T.사용자정의3), 0) NO_CNT, 
            T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
			T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
			T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
			T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
			
			T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
			T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
			T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
			T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
			 
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
			) AS TOTPAY, 
			
			T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
			T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
			T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
			T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
			
			T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
			T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
			T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
			T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
			
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS TOTDEDUCT, 
			
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS GPAY, 
            AM_TOTTAX, AM_TOTNOTAX, AM_NOTAX0, AM_NOTAX1, AM_NOTAX2, AM_NEMPA, AM_FIRE 
     
    FROM    ( 
        SELECT   회사코드, 사업장코드, 사용자정의3, 
                SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
                SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
                SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
                SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
                SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
                SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
                SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
                SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
                SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
                SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
                SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
                SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
                SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
                SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
                SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
                SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 
                
                SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
				SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
				SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
				SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
				SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
				SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
				SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
				SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
				SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
				SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
				SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
				SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
				SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
				SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
				SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
				SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
                
                ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
                ISNULL(SUM(AM_SIN), 0) AM_SIN, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드 , 사용자정의3 
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_BIZAREA BI 
    ON  T.회사코드 = BI.CD_COMPANY AND  T.사업장코드 = BI.CD_BIZAREA     
END
-- 집계형태 : 프로젝트일별(일용직) 
ELSE IF(@P_TP_SUM = '024') 
BEGIN 
    SELECT  T.회사코드 CD_COMPANY,
			(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,      
			 ISNULL(BI.CD_AREA, '') AS CD_AREA, 
            T.사업장코드     AS CD_BIZAREA,          
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA, 
            T.부서코드    AS CD_DEPT, 
            T.직위코드 CD_DUTY_RANK, 
            T.사원구분    AS TP_EMP, 
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_P000009' AND CD_SYSDEF = T.사원구분) NM_TP_EMP, 
            T.사번        NO_EMP, 
            T.직급코드    CD_DUTY_STEP, 
            T.프로젝트코드 CD_PJT, 
            BI.NM_BIZAREA     AS EMPINFO_01,      
			SA.NM_PROJECT     AS EMPINFO_02,     
            T.사번         AS EMPINFO_03,         
            E.NM_KOR     AS EMPINFO_04, E.NM_CHIN,  E.NM_ENG,
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000003' AND CD_SYSDEF = T.직급코드) EMPINFO_05,                 
            1         AS NO_CNT, 
            T.호봉코드    AS EMPINFO_08,
            E.DT_ENTER, 
            E.DT_GENTER,
            E.DT_RETIRE, 
            E.NO_RES, 
	 		E.DC_ADDRESS_RES1 + ISNULL(E.DC_ADDRESS_RES2,'') DC_ADDR,        
         
            T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
			T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
			T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
			T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
			
			T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
			T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
			T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
			T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
			 
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
			) AS TOTPAY, 
			
			T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
			T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
			T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
			T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
			
			T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
			T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
			T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
			T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
			
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS TOTDEDUCT, 
			
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS GPAY, 
            T.AM_TOTTAX, T.AM_TOTNOTAX, T.AM_NOTAX0, T.AM_NOTAX1, T.AM_NOTAX2, AM_NEMPA, AM_FIRE 
    FROM    ( 
        SELECT   회사코드, 사업장코드, 부서코드, 직위코드, 사원구분, 사번, 직급코드, 호봉코드, 프로젝트코드,
                SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
                SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
                SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
                SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
                SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
                SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
                SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
                SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
                SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
                SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
                SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
                SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
                SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
                SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
                SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
                SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 
                
                SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
				SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
				SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
				SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
				SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
				SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
				SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
				SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
				SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
				SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
				SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
				SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
				SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
				SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
				SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
				SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
                
                ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
                ISNULL(SUM(AM_SIN), 0) AM_SIN, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드, 부서코드 , 직위코드, 사원구분, 사번, 직급코드, 호봉코드, 프로젝트코드
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_EMP AS E 
    ON  T.회사코드 = E.CD_COMPANY AND  T.사번    = E.NO_EMP 
    LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
    ON    T.사업장코드    = BI.CD_BIZAREA 
    AND  T.회사코드 =  BI.CD_COMPANY   
    LEFT OUTER JOIN DZSN_SA_PROJECTH AS SA 
    ON  T.회사코드 = SA.CD_COMPANY AND  T.프로젝트코드    = SA.NO_PROJECT    
    WHERE   (T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
            T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
            T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
            T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
            T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
            ) <> 0
    OR      (T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
            T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
            T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
            T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
            T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80 - AM_SIN) <> 0
            
    ORDER BY T.회사코드,T.사업장코드 ASC,  T.프로젝트코드 ASC, T.사번 ASC 
END
-- 집계형태 : 직책(사원) 
ELSE IF(@P_TP_SUM = '026') 
BEGIN 
    SELECT  T.회사코드 CD_COMPANY,
			(SELECT NM_COMPANY FROM DZSN_MA_COMPANY WHERE CD_COMPANY = T.회사코드) EMPINFO_00,      
			 ISNULL(BI.CD_AREA, '') AS CD_AREA, 
            T.사업장코드     AS CD_BIZAREA,          
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'MA_B000062' AND CD_SYSDEF = BI.CD_AREA) AS NM_AREA, 
            T.부서코드    AS CD_DEPT, 
            T.직책코드 CD_DUTY_RESP, 
            T.사원구분    AS TP_EMP, 
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_P000009' AND CD_SYSDEF = T.사원구분) NM_TP_EMP, 
            T.사번        NO_EMP, 
            T.직급코드    CD_DUTY_STEP,  
            BI.NM_BIZAREA     AS EMPINFO_01,     
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000052' AND CD_SYSDEF = T.직책코드) EMPINFO_02, 
            T.사번         AS EMPINFO_03,         
            E.NM_KOR     AS EMPINFO_04, E.NM_CHIN,  E.NM_ENG,
            (SELECT    NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_FIELD = 'HR_H000003' AND CD_SYSDEF = T.직급코드) EMPINFO_05,                 
            1         AS NO_CNT, 
            (SELECT NM_SYSDEF FROM DZSN_MA_CODEDTL WHERE CD_COMPANY = T.회사코드 AND CD_SYSDEF = T.직군코드 AND CD_FIELD = 'HR_H000004') NM_DUTY_TYPE,--직군명 
            T.호봉코드    AS EMPINFO_08,
            E.DT_ENTER, 
            E.DT_GENTER,
            E.DT_RETIRE, 
            E.NO_RES, 
	 		E.DC_ADDRESS_RES1 + ISNULL(E.DC_ADDRESS_RES2,'') DC_ADDR,        
         
            T.PAY_01, T.PAY_02, T.PAY_03, T.PAY_04, T.PAY_05, T.PAY_06, T.PAY_07, T.PAY_08, T.PAY_09, T.PAY_10, 
			T.PAY_11, T.PAY_12, T.PAY_13, T.PAY_14, T.PAY_15, T.PAY_16, T.PAY_17, T.PAY_18, T.PAY_19, T.PAY_20, 
			T.PAY_21, T.PAY_22, T.PAY_23, T.PAY_24, T.PAY_25, T.PAY_26, T.PAY_27, T.PAY_28, T.PAY_29, T.PAY_30, 
			T.PAY_31, T.PAY_32, T.PAY_33, T.PAY_34, T.PAY_35, T.PAY_36, T.PAY_37, T.PAY_38, T.PAY_39, T.PAY_40,
			
			T.PAY_41, T.PAY_42, T.PAY_43, T.PAY_44, T.PAY_45, T.PAY_46, T.PAY_47, T.PAY_48, T.PAY_49, T.PAY_50,
			T.PAY_51, T.PAY_52, T.PAY_53, T.PAY_54, T.PAY_55, T.PAY_56, T.PAY_57, T.PAY_58, T.PAY_59, T.PAY_60,
			T.PAY_61, T.PAY_62, T.PAY_63, T.PAY_64, T.PAY_65, T.PAY_66, T.PAY_67, T.PAY_68, T.PAY_69, T.PAY_70,
			T.PAY_71, T.PAY_72, T.PAY_73, T.PAY_74, T.PAY_75, T.PAY_76, T.PAY_77, T.PAY_78, T.PAY_79, T.PAY_80,
			 
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80
			) AS TOTPAY, 
			
			T.DEDU_01, T.DEDU_02, T.DEDU_03, T.DEDU_04, T.DEDU_05, T.DEDU_06, T.DEDU_07, T.DEDU_08, T.DEDU_09, T.DEDU_10, 
			T.DEDU_11, T.DEDU_12, T.DEDU_13, T.DEDU_14, T.DEDU_15, T.DEDU_16, T.DEDU_17, T.DEDU_18, T.DEDU_19, T.DEDU_20, 
			T.DEDU_21, T.DEDU_22, T.DEDU_23, T.DEDU_24, T.DEDU_25, T.DEDU_26, T.DEDU_27, T.DEDU_28, T.DEDU_29, T.DEDU_30, 
			T.DEDU_31, T.DEDU_32, T.DEDU_33, T.DEDU_34, T.DEDU_35, T.DEDU_36, T.DEDU_37, T.DEDU_38, T.DEDU_39, T.DEDU_40, 
			
			T.DEDU_41, T.DEDU_42, T.DEDU_43, T.DEDU_44, T.DEDU_45, T.DEDU_46, T.DEDU_47, T.DEDU_48, T.DEDU_49, T.DEDU_50,
			T.DEDU_51, T.DEDU_52, T.DEDU_53, T.DEDU_54, T.DEDU_55, T.DEDU_56, T.DEDU_57, T.DEDU_58, T.DEDU_59, T.DEDU_60,
			T.DEDU_61, T.DEDU_62, T.DEDU_63, T.DEDU_64, T.DEDU_65, T.DEDU_66, T.DEDU_67, T.DEDU_68, T.DEDU_69, T.DEDU_70,
			T.DEDU_71, T.DEDU_72, T.DEDU_73, T.DEDU_74, T.DEDU_75, T.DEDU_76, T.DEDU_77, T.DEDU_78, T.DEDU_79, T.DEDU_80,
			
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS TOTDEDUCT, 
			
			(T.PAY_01+ T.PAY_02+ T.PAY_03+ T.PAY_04+ T.PAY_05+ T.PAY_06+ T.PAY_07+ T.PAY_08+ T.PAY_09+ T.PAY_10+ 
			T.PAY_11+ T.PAY_12+ T.PAY_13+ T.PAY_14+ T.PAY_15+ T.PAY_16+ T.PAY_17+ T.PAY_18+ T.PAY_19+ T.PAY_20+ 
			T.PAY_21+ T.PAY_22+ T.PAY_23+ T.PAY_24+ T.PAY_25+ T.PAY_26+ T.PAY_27+ T.PAY_28+ T.PAY_29+ T.PAY_30+ 
			T.PAY_31+ T.PAY_32+ T.PAY_33+ T.PAY_34+ T.PAY_35+ T.PAY_36+ T.PAY_37+ T.PAY_38+ T.PAY_39+ T.PAY_40+
			T.PAY_41+ T.PAY_42+ T.PAY_43+ T.PAY_44+ T.PAY_45+ T.PAY_46+ T.PAY_47+ T.PAY_48+ T.PAY_49+ T.PAY_50+
			T.PAY_51+ T.PAY_52+ T.PAY_53+ T.PAY_54+ T.PAY_55+ T.PAY_56+ T.PAY_57+ T.PAY_58+ T.PAY_59+ T.PAY_60+
			T.PAY_61+ T.PAY_62+ T.PAY_63+ T.PAY_64+ T.PAY_65+ T.PAY_66+ T.PAY_67+ T.PAY_68+ T.PAY_69+ T.PAY_70+
			T.PAY_71+ T.PAY_72+ T.PAY_73+ T.PAY_74+ T.PAY_75+ T.PAY_76+ T.PAY_77+ T.PAY_78+ T.PAY_79+ T.PAY_80) - 
			( 
			T.DEDU_01+ T.DEDU_02+ T.DEDU_03+ T.DEDU_04+ T.DEDU_05+ T.DEDU_06+ T.DEDU_07+ T.DEDU_08+ T.DEDU_09+ T.DEDU_10+ 
			T.DEDU_11+ T.DEDU_12+ T.DEDU_13+ T.DEDU_14+ T.DEDU_15+ T.DEDU_16+ T.DEDU_17+ T.DEDU_18+ T.DEDU_19+ T.DEDU_20+ 
			T.DEDU_21+ T.DEDU_22+ T.DEDU_23+ T.DEDU_24+ T.DEDU_25+ T.DEDU_26+ T.DEDU_27+ T.DEDU_28+ T.DEDU_29+ T.DEDU_30+ 
			T.DEDU_31+ T.DEDU_32+ T.DEDU_33+ T.DEDU_34+ T.DEDU_35+ T.DEDU_36+ T.DEDU_37+ T.DEDU_38+ T.DEDU_39+ T.DEDU_40+
			T.DEDU_41+ T.DEDU_42+ T.DEDU_43+ T.DEDU_44+ T.DEDU_45+ T.DEDU_46+ T.DEDU_47+ T.DEDU_48+ T.DEDU_49+ T.DEDU_50+
			T.DEDU_51+ T.DEDU_52+ T.DEDU_53+ T.DEDU_54+ T.DEDU_55+ T.DEDU_56+ T.DEDU_57+ T.DEDU_58+ T.DEDU_59+ T.DEDU_60+
			T.DEDU_61+ T.DEDU_62+ T.DEDU_63+ T.DEDU_64+ T.DEDU_65+ T.DEDU_66+ T.DEDU_67+ T.DEDU_68+ T.DEDU_69+ T.DEDU_70+
			T.DEDU_71+ T.DEDU_72+ T.DEDU_73+ T.DEDU_74+ T.DEDU_75+ T.DEDU_76+ T.DEDU_77+ T.DEDU_78+ T.DEDU_79+ T.DEDU_80
			 - AM_SIN
			) AS GPAY, 
            T.AM_TOTTAX, T.AM_TOTNOTAX, T.AM_NOTAX0, T.AM_NOTAX1, T.AM_NOTAX2, T.CD_LTAX_AREA, T.AM_NEMPA, T.AM_FIRE
    FROM    ( 
        SELECT   회사코드, 사업장코드, 부서코드, 직책코드, 사원구분, 사번, 직급코드, 호봉코드, 직군코드,
                SUM(ISNULL(PAY_01, 0)) PAY_01, SUM(ISNULL(PAY_02, 0)) PAY_02, SUM(ISNULL(PAY_03, 0)) PAY_03, SUM(ISNULL(PAY_04, 0)) PAY_04, SUM(ISNULL(PAY_05, 0)) PAY_05, 
                SUM(ISNULL(PAY_06, 0)) PAY_06, SUM(ISNULL(PAY_07, 0)) PAY_07, SUM(ISNULL(PAY_08, 0)) PAY_08, SUM(ISNULL(PAY_09, 0)) PAY_09, SUM(ISNULL(PAY_10, 0)) PAY_10, 
                SUM(ISNULL(PAY_11, 0)) PAY_11, SUM(ISNULL(PAY_12, 0)) PAY_12, SUM(ISNULL(PAY_13, 0)) PAY_13, SUM(ISNULL(PAY_14, 0)) PAY_14, SUM(ISNULL(PAY_15, 0)) PAY_15, 
                SUM(ISNULL(PAY_16, 0)) PAY_16, SUM(ISNULL(PAY_17, 0)) PAY_17, SUM(ISNULL(PAY_18, 0)) PAY_18, SUM(ISNULL(PAY_19, 0)) PAY_19, SUM(ISNULL(PAY_20, 0)) PAY_20, 
                SUM(ISNULL(PAY_21, 0)) PAY_21, SUM(ISNULL(PAY_22, 0)) PAY_22, SUM(ISNULL(PAY_23, 0)) PAY_23, SUM(ISNULL(PAY_24, 0)) PAY_24, SUM(ISNULL(PAY_25, 0)) PAY_25, 
                SUM(ISNULL(PAY_26, 0)) PAY_26, SUM(ISNULL(PAY_27, 0)) PAY_27, SUM(ISNULL(PAY_28, 0)) PAY_28, SUM(ISNULL(PAY_29, 0)) PAY_29, SUM(ISNULL(PAY_30, 0)) PAY_30, 
                SUM(ISNULL(PAY_31, 0)) PAY_31, SUM(ISNULL(PAY_32, 0)) PAY_32, SUM(ISNULL(PAY_33, 0)) PAY_33, SUM(ISNULL(PAY_34, 0)) PAY_34, SUM(ISNULL(PAY_35, 0)) PAY_35, 
                SUM(ISNULL(PAY_36, 0)) PAY_36, SUM(ISNULL(PAY_37, 0)) PAY_37, SUM(ISNULL(PAY_38, 0)) PAY_38, SUM(ISNULL(PAY_39, 0)) PAY_39, SUM(ISNULL(PAY_40, 0)) PAY_40, 
                SUM(ISNULL(DEDU_01, 0)) DEDU_01, SUM(ISNULL(DEDU_02, 0)) DEDU_02, SUM(ISNULL(DEDU_03, 0)) DEDU_03, SUM(ISNULL(DEDU_04, 0)) DEDU_04, SUM(ISNULL(DEDU_05, 0)) DEDU_05, 
                SUM(ISNULL(DEDU_06, 0)) DEDU_06, SUM(ISNULL(DEDU_07, 0)) DEDU_07, SUM(ISNULL(DEDU_08, 0)) DEDU_08, SUM(ISNULL(DEDU_09, 0)) DEDU_09, SUM(ISNULL(DEDU_10, 0)) DEDU_10, 
                SUM(ISNULL(DEDU_11, 0)) DEDU_11, SUM(ISNULL(DEDU_12, 0)) DEDU_12, SUM(ISNULL(DEDU_13, 0)) DEDU_13, SUM(ISNULL(DEDU_14, 0)) DEDU_14, SUM(ISNULL(DEDU_15, 0)) DEDU_15, 
                SUM(ISNULL(DEDU_16, 0)) DEDU_16, SUM(ISNULL(DEDU_17, 0)) DEDU_17, SUM(ISNULL(DEDU_18, 0)) DEDU_18, SUM(ISNULL(DEDU_19, 0)) DEDU_19, SUM(ISNULL(DEDU_20, 0)) DEDU_20, 
                SUM(ISNULL(DEDU_21, 0)) DEDU_21, SUM(ISNULL(DEDU_22, 0)) DEDU_22, SUM(ISNULL(DEDU_23, 0)) DEDU_23, SUM(ISNULL(DEDU_24, 0)) DEDU_24, SUM(ISNULL(DEDU_25, 0)) DEDU_25, 
                SUM(ISNULL(DEDU_26, 0)) DEDU_26, SUM(ISNULL(DEDU_27, 0)) DEDU_27, SUM(ISNULL(DEDU_28, 0)) DEDU_28, SUM(ISNULL(DEDU_29, 0)) DEDU_29, SUM(ISNULL(DEDU_30, 0)) DEDU_30, 
                SUM(ISNULL(DEDU_31, 0)) DEDU_31, SUM(ISNULL(DEDU_32, 0)) DEDU_32, SUM(ISNULL(DEDU_33, 0)) DEDU_33, SUM(ISNULL(DEDU_34, 0)) DEDU_34, SUM(ISNULL(DEDU_35, 0)) DEDU_35, 
                SUM(ISNULL(DEDU_36, 0)) DEDU_36, SUM(ISNULL(DEDU_37, 0)) DEDU_37, SUM(ISNULL(DEDU_38, 0)) DEDU_38, SUM(ISNULL(DEDU_39, 0)) DEDU_39, SUM(ISNULL(DEDU_40, 0)) DEDU_40, 
                
                SUM(ISNULL(PAY_41, 0)) PAY_41, SUM(ISNULL(PAY_42, 0)) PAY_42, SUM(ISNULL(PAY_43, 0)) PAY_43, SUM(ISNULL(PAY_44, 0)) PAY_44, SUM(ISNULL(PAY_45, 0)) PAY_45, 
				SUM(ISNULL(PAY_46, 0)) PAY_46, SUM(ISNULL(PAY_47, 0)) PAY_47, SUM(ISNULL(PAY_48, 0)) PAY_48, SUM(ISNULL(PAY_49, 0)) PAY_49, SUM(ISNULL(PAY_50, 0)) PAY_50, 					
				SUM(ISNULL(PAY_51, 0)) PAY_51, SUM(ISNULL(PAY_52, 0)) PAY_52, SUM(ISNULL(PAY_53, 0)) PAY_53, SUM(ISNULL(PAY_54, 0)) PAY_54, SUM(ISNULL(PAY_55, 0)) PAY_55, 
				SUM(ISNULL(PAY_56, 0)) PAY_56, SUM(ISNULL(PAY_57, 0)) PAY_57, SUM(ISNULL(PAY_58, 0)) PAY_58, SUM(ISNULL(PAY_59, 0)) PAY_59, SUM(ISNULL(PAY_60, 0)) PAY_60, 					
				SUM(ISNULL(PAY_61, 0)) PAY_61, SUM(ISNULL(PAY_62, 0)) PAY_62, SUM(ISNULL(PAY_63, 0)) PAY_63, SUM(ISNULL(PAY_64, 0)) PAY_64, SUM(ISNULL(PAY_65, 0)) PAY_65, 
				SUM(ISNULL(PAY_66, 0)) PAY_66, SUM(ISNULL(PAY_67, 0)) PAY_67, SUM(ISNULL(PAY_68, 0)) PAY_68, SUM(ISNULL(PAY_69, 0)) PAY_69, SUM(ISNULL(PAY_70, 0)) PAY_70, 					
				SUM(ISNULL(PAY_71, 0)) PAY_71, SUM(ISNULL(PAY_72, 0)) PAY_72, SUM(ISNULL(PAY_73, 0)) PAY_73, SUM(ISNULL(PAY_74, 0)) PAY_74, SUM(ISNULL(PAY_75, 0)) PAY_75, 
				SUM(ISNULL(PAY_76, 0)) PAY_76, SUM(ISNULL(PAY_77, 0)) PAY_77, SUM(ISNULL(PAY_78, 0)) PAY_78, SUM(ISNULL(PAY_79, 0)) PAY_79, SUM(ISNULL(PAY_80, 0)) PAY_80,
				SUM(ISNULL(DEDU_41, 0)) DEDU_41, SUM(ISNULL(DEDU_42, 0)) DEDU_42, SUM(ISNULL(DEDU_43, 0)) DEDU_43, SUM(ISNULL(DEDU_44, 0)) DEDU_44, SUM(ISNULL(DEDU_45, 0)) DEDU_45, 
				SUM(ISNULL(DEDU_46, 0)) DEDU_46, SUM(ISNULL(DEDU_47, 0)) DEDU_47, SUM(ISNULL(DEDU_48, 0)) DEDU_48, SUM(ISNULL(DEDU_49, 0)) DEDU_49, SUM(ISNULL(DEDU_50, 0)) DEDU_50, 					
				SUM(ISNULL(DEDU_51, 0)) DEDU_51, SUM(ISNULL(DEDU_52, 0)) DEDU_52, SUM(ISNULL(DEDU_53, 0)) DEDU_53, SUM(ISNULL(DEDU_54, 0)) DEDU_54, SUM(ISNULL(DEDU_55, 0)) DEDU_55, 
				SUM(ISNULL(DEDU_56, 0)) DEDU_56, SUM(ISNULL(DEDU_57, 0)) DEDU_57, SUM(ISNULL(DEDU_58, 0)) DEDU_58, SUM(ISNULL(DEDU_59, 0)) DEDU_59, SUM(ISNULL(DEDU_60, 0)) DEDU_60, 					
				SUM(ISNULL(DEDU_61, 0)) DEDU_61, SUM(ISNULL(DEDU_62, 0)) DEDU_62, SUM(ISNULL(DEDU_63, 0)) DEDU_63, SUM(ISNULL(DEDU_64, 0)) DEDU_64, SUM(ISNULL(DEDU_65, 0)) DEDU_65, 
				SUM(ISNULL(DEDU_66, 0)) DEDU_66, SUM(ISNULL(DEDU_67, 0)) DEDU_67, SUM(ISNULL(DEDU_68, 0)) DEDU_68, SUM(ISNULL(DEDU_69, 0)) DEDU_69, SUM(ISNULL(DEDU_70, 0)) DEDU_70, 					
				SUM(ISNULL(DEDU_71, 0)) DEDU_71, SUM(ISNULL(DEDU_72, 0)) DEDU_72, SUM(ISNULL(DEDU_73, 0)) DEDU_73, SUM(ISNULL(DEDU_74, 0)) DEDU_74, SUM(ISNULL(DEDU_75, 0)) DEDU_75, 
				SUM(ISNULL(DEDU_76, 0)) DEDU_76, SUM(ISNULL(DEDU_77, 0)) DEDU_77, SUM(ISNULL(DEDU_78, 0)) DEDU_78, SUM(ISNULL(DEDU_79, 0)) DEDU_79, SUM(ISNULL(DEDU_80, 0)) DEDU_80,
                
                ISNULL(SUM(AM_TOTTAX), 0) AM_TOTTAX, ISNULL(SUM(AM_TOTNOTAX), 0) AM_TOTNOTAX, ISNULL(SUM(AM_NOTAX0), 0) AM_NOTAX0, ISNULL(SUM(AM_NOTAX1), 0) AM_NOTAX1, ISNULL(SUM(AM_NOTAX2), 0) AM_NOTAX2,
                ISNULL(SUM(AM_SIN), 0) AM_SIN, CD_LTAX_AREA, ISNULL(SUM(AM_NEMPA), 0) AM_NEMPA, ISNULL(SUM(AM_FIRE), 0) AM_FIRE 
        FROM    @P_DTEMP 
        GROUP BY 회사코드, 사업장코드, 부서코드 , 직책코드, 사원구분, 사번, 직급코드, 호봉코드, 직군코드, CD_LTAX_AREA
        ) AS T 
    LEFT OUTER JOIN DZSN_MA_EMP AS E 
    ON  T.회사코드 = E.CD_COMPANY AND  T.사번    = E.NO_EMP 
    LEFT OUTER JOIN DZSN_MA_BIZAREA AS BI 
    ON    T.사업장코드    = BI.CD_BIZAREA 
    AND  T.회사코드 =  BI.CD_COMPANY      
    ORDER BY T.회사코드,T.사업장코드 ASC, T.직책코드 ASC, T.사번 ASC 
END 

IF(@P_TP_SUM IN ('002' ,'003','006' ,'008','012','013', '015', '017', '018', '019', '020', '021', '022', '024', '026')) 
BEGIN 
    -- 급여양식 
    SELECT    DISTINCT 
        FM.TP_PDREPORT, 
        FM.CD_REPORT, 
        FM.NM_REPORT, 
        CONVERT(INT, FM.CD_RSEQ) CD_RSEQ 
    FROM    DZSN_HR_PREPFORM AS FM     
    WHERE    FM.CD_COMPANY        = @P_CD_COMPANY_L 
    AND    FM.TP_REPORT        = @P_TP_REPORT 
    AND    (FM.TP_PDREPORT = '001' OR FM.TP_PDREPORT = '002') 
    ORDER BY FM.TP_PDREPORT ASC, CONVERT(INT, FM.CD_RSEQ) ASC, FM.CD_REPORT ASC 
 
END